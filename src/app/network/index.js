!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=138)}([function(t,e){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=n,n.equal=function(t,e,n){if(t!=e)throw new Error(n||"Assertion failed: "+t+" != "+e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(48),o=n(72),s=n(71),a=((r={})["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$name}",r["duplicate-app"]="Firebase App named '{$name}' already exists",r["app-deleted"]="Firebase App named '{$name}' already deleted",r["duplicate-service"]="Firebase service named '{$name}' already registered",r["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",r),u=new o.ErrorFactory("app","Firebase",a),c="[DEFAULT]",h=[],l=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){h.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){h=h.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,s=Object.keys(t.services_[i]);o<s.length;o++){var a=s[o];e.push(t.services_[i][a])}return Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=c),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==c?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;o.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(h.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),h=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{name:this.name_})},t}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var f="6.0.4";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d(t,e){return Object.prototype.hasOwnProperty.call(t,e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var p=new s.Logger("@firebase/app");if(o.isBrowser()&&"firebase"in self){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var y=
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function t(){var e=function(t){var e={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){if(void 0===r&&(r={}),"object"!=typeof r||null===r){var o=r;r={name:o}}var s=r;void 0===s.name&&(s.name=c);var a=s.name;if("string"!=typeof a||!a)throw u.create("bad-app-name",{name:String(a)});if(d(e,a))throw u.create("duplicate-app",{name:a});var l=new t(n,s,i);return e[a]=l,h(l,"create"),l},app:s,apps:null,SDK_VERSION:f,INTERNAL:{registerService:function(e,c,h,l,f){if(void 0===f&&(f=!1),n[e])throw u.create("duplicate-service",{name:e});function d(t){if(void 0===t&&(t=s()),"function"!=typeof t[e])throw u.create("invalid-app-argument",{name:e});return t[e]()}return n[e]=c,l&&(r[e]=l,a().forEach(function(t){l("create",t)})),void 0!==h&&o.deepExtend(d,h),i[e]=d,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getService.bind(this,e).apply(this,f?t:[])},d},removeApp:function(t){h(e[t],"delete"),delete e[t]},factories:n,useAsService:l}};function s(t){if(!d(e,t=t||c))throw u.create("no-app",{name:t});return e[t]}function a(){return Object.keys(e).map(function(t){return e[t]})}function h(t,e){for(var i=0,o=Object.keys(n);i<o.length;i++){var s=l(0,o[i]);if(null===s)return;r[s]&&r[s](e,t)}}function l(t,e){return"serverAuth"===e?null:e}return o.patchProperty(i,"default",i),Object.defineProperty(i,"apps",{get:a}),o.patchProperty(s,"App",t),i}(l);return e.INTERNAL=i.__assign({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}(),g=y.initializeApp;y.initializeApp=function(){return o.isNode()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\n      to false and "main" to true:\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),g.apply(void 0,arguments)};var v=y;e.default=v,e.firebase=v},function(t,e,n){(function(t){(function(){var n,r=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",s="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",u=500,c="__lodash_placeholder__",h=1,l=2,f=4,d=1,p=2,m=1,y=2,g=4,v=8,b=16,w=32,_=64,S=128,E=256,I=512,T=30,A="...",N=800,C=16,O=1,D=2,k=1/0,M=9007199254740991,x=1.7976931348623157e308,P=NaN,R=4294967295,L=R-1,B=R>>>1,U=[["ary",S],["bind",m],["bindKey",y],["curry",v],["curryRight",b],["flip",I],["partial",w],["partialRight",_],["rearg",E]],F="[object Arguments]",j="[object Array]",q="[object AsyncFunction]",V="[object Boolean]",K="[object Date]",z="[object DOMException]",W="[object Error]",G="[object Function]",H="[object GeneratorFunction]",Q="[object Map]",J="[object Number]",$="[object Null]",Y="[object Object]",X="[object Proxy]",Z="[object RegExp]",tt="[object Set]",et="[object String]",nt="[object Symbol]",rt="[object Undefined]",it="[object WeakMap]",ot="[object WeakSet]",st="[object ArrayBuffer]",at="[object DataView]",ut="[object Float32Array]",ct="[object Float64Array]",ht="[object Int8Array]",lt="[object Int16Array]",ft="[object Int32Array]",dt="[object Uint8Array]",pt="[object Uint8ClampedArray]",mt="[object Uint16Array]",yt="[object Uint32Array]",gt=/\b__p \+= '';/g,vt=/\b(__p \+=) '' \+/g,bt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wt=/&(?:amp|lt|gt|quot|#39);/g,_t=/[&<>"']/g,St=RegExp(wt.source),Et=RegExp(_t.source),It=/<%-([\s\S]+?)%>/g,Tt=/<%([\s\S]+?)%>/g,At=/<%=([\s\S]+?)%>/g,Nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dt=/[\\^$.*+?()[\]{}|]/g,kt=RegExp(Dt.source),Mt=/^\s+/,xt=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Rt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Bt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ut=/[()=,{}\[\]\/\s]/,Ft=/\\(\\)?/g,jt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qt=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,zt=/^\[object .+?Constructor\]$/,Wt=/^0o[0-7]+$/i,Gt=/^(?:0|[1-9]\d*)$/,Ht=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qt=/($^)/,Jt=/['\n\r\u2028\u2029\\]/g,$t="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Yt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xt="[\\ud800-\\udfff]",Zt="["+Yt+"]",te="["+$t+"]",ee="\\d+",ne="[\\u2700-\\u27bf]",re="[a-z\\xdf-\\xf6\\xf8-\\xff]",ie="[^\\ud800-\\udfff"+Yt+ee+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",oe="\\ud83c[\\udffb-\\udfff]",se="[^\\ud800-\\udfff]",ae="(?:\\ud83c[\\udde6-\\uddff]){2}",ue="[\\ud800-\\udbff][\\udc00-\\udfff]",ce="[A-Z\\xc0-\\xd6\\xd8-\\xde]",he="(?:"+re+"|"+ie+")",le="(?:"+ce+"|"+ie+")",fe="(?:"+te+"|"+oe+")"+"?",de="[\\ufe0e\\ufe0f]?"+fe+("(?:\\u200d(?:"+[se,ae,ue].join("|")+")[\\ufe0e\\ufe0f]?"+fe+")*"),pe="(?:"+[ne,ae,ue].join("|")+")"+de,me="(?:"+[se+te+"?",te,ae,ue,Xt].join("|")+")",ye=RegExp("['’]","g"),ge=RegExp(te,"g"),ve=RegExp(oe+"(?="+oe+")|"+me+de,"g"),be=RegExp([ce+"?"+re+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Zt,ce,"$"].join("|")+")",le+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Zt,ce+he,"$"].join("|")+")",ce+"?"+he+"+(?:['’](?:d|ll|m|re|s|t|ve))?",ce+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ee,pe].join("|"),"g"),we=RegExp("[\\u200d\\ud800-\\udfff"+$t+"\\ufe0e\\ufe0f]"),_e=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Se=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ee=-1,Ie={};Ie[ut]=Ie[ct]=Ie[ht]=Ie[lt]=Ie[ft]=Ie[dt]=Ie[pt]=Ie[mt]=Ie[yt]=!0,Ie[F]=Ie[j]=Ie[st]=Ie[V]=Ie[at]=Ie[K]=Ie[W]=Ie[G]=Ie[Q]=Ie[J]=Ie[Y]=Ie[Z]=Ie[tt]=Ie[et]=Ie[it]=!1;var Te={};Te[F]=Te[j]=Te[st]=Te[at]=Te[V]=Te[K]=Te[ut]=Te[ct]=Te[ht]=Te[lt]=Te[ft]=Te[Q]=Te[J]=Te[Y]=Te[Z]=Te[tt]=Te[et]=Te[nt]=Te[dt]=Te[pt]=Te[mt]=Te[yt]=!0,Te[W]=Te[G]=Te[it]=!1;var Ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ne=parseFloat,Ce=parseInt,Oe=self&&self.Object===Object&&self||Function("return this")(),De="object"==typeof e&&e&&!e.nodeType&&e,ke=De&&"object"==typeof t&&t&&!t.nodeType&&t,Me=ke&&ke.exports===De,xe=Me&&(!1).process,Pe=function(){try{var t=ke&&ke.require&&ke.require("util").types;return t||xe&&xe.binding&&xe.binding("util")}catch(t){}}(),Re=Pe&&Pe.isArrayBuffer,Le=Pe&&Pe.isDate,Be=Pe&&Pe.isMap,Ue=Pe&&Pe.isRegExp,Fe=Pe&&Pe.isSet,je=Pe&&Pe.isTypedArray;function qe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ve(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function Ke(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function ze(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function We(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ge(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function He(t,e){return!!(null==t?0:t.length)&&rn(t,e,0)>-1}function Qe(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Je(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function $e(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ye(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Xe(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Ze(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var tn=un("length");function en(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function nn(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function rn(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):nn(t,sn,n)}function on(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function sn(t){return t!=t}function an(t,e){var n=null==t?0:t.length;return n?ln(t,e)/n:P}function un(t){return function(e){return null==e?n:e[t]}}function cn(t){return function(e){return null==t?n:t[e]}}function hn(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function ln(t,e){for(var r,i=-1,o=t.length;++i<o;){var s=e(t[i]);s!==n&&(r=r===n?s:r+s)}return r}function fn(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function dn(t){return t?t.slice(0,Dn(t)+1).replace(Mt,""):t}function pn(t){return function(e){return t(e)}}function mn(t,e){return Je(e,function(e){return t[e]})}function yn(t,e){return t.has(e)}function gn(t,e){for(var n=-1,r=t.length;++n<r&&rn(e,t[n],0)>-1;);return n}function vn(t,e){for(var n=t.length;n--&&rn(e,t[n],0)>-1;);return n}var bn=cn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),wn=cn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function _n(t){return"\\"+Ae[t]}function Sn(t){return we.test(t)}function En(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function In(t,e){return function(n){return t(e(n))}}function Tn(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==c||(t[n]=c,o[i++]=n)}return o}function An(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function Nn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Cn(t){return Sn(t)?function(t){var e=ve.lastIndex=0;for(;ve.test(t);)++e;return e}(t):tn(t)}function On(t){return Sn(t)?function(t){return t.match(ve)||[]}(t):function(t){return t.split("")}(t)}function Dn(t){for(var e=t.length;e--&&xt.test(t.charAt(e)););return e}var kn=cn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Mn=function t(e){var xt,$t=(e=null==e?Oe:Mn.defaults(Oe.Object(),e,Mn.pick(Oe,Se))).Array,Yt=e.Date,Xt=e.Error,Zt=e.Function,te=e.Math,ee=e.Object,ne=e.RegExp,re=e.String,ie=e.TypeError,oe=$t.prototype,se=Zt.prototype,ae=ee.prototype,ue=e["__core-js_shared__"],ce=se.toString,he=ae.hasOwnProperty,le=0,fe=(xt=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+xt:"",de=ae.toString,pe=ce.call(ee),me=Oe._,ve=ne("^"+ce.call(he).replace(Dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Buffer=Me?e.Buffer:n,we=e.Symbol,Ae=e.Uint8Array,De=Buffer?Buffer.allocUnsafe:n,ke=In(ee.getPrototypeOf,ee),xe=ee.create,Pe=ae.propertyIsEnumerable,tn=oe.splice,cn=we?we.isConcatSpreadable:n,xn=we?we.iterator:n,Pn=we?we.toStringTag:n,Rn=function(){try{var t=jo(ee,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ln=e.clearTimeout!==Oe.clearTimeout&&e.clearTimeout,Bn=Yt&&Yt.now!==Oe.Date.now&&Yt.now,Un=e.setTimeout!==Oe.setTimeout&&e.setTimeout,Fn=te.ceil,jn=te.floor,qn=ee.getOwnPropertySymbols,Vn=Buffer?Buffer.isBuffer:n,Kn=e.isFinite,zn=oe.join,Wn=In(ee.keys,ee),Gn=te.max,Hn=te.min,Qn=Yt.now,Jn=e.parseInt,$n=te.random,Yn=oe.reverse,Xn=jo(e,"DataView"),Zn=jo(e,"Map"),tr=jo(e,"Promise"),er=jo(e,"Set"),nr=jo(e,"WeakMap"),rr=jo(ee,"create"),ir=nr&&new nr,or={},sr=fs(Xn),ar=fs(Zn),ur=fs(tr),cr=fs(er),hr=fs(nr),lr=we?we.prototype:n,fr=lr?lr.valueOf:n,dr=lr?lr.toString:n;function pr(t){if(Oa(t)&&!va(t)&&!(t instanceof vr)){if(t instanceof gr)return t;if(he.call(t,"__wrapped__"))return ds(t)}return new gr(t)}var mr=function(){function t(){}return function(e){if(!Ca(e))return{};if(xe)return xe(e);t.prototype=e;var r=new t;return t.prototype=n,r}}();function yr(){}function gr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=n}function vr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=R,this.__views__=[]}function br(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function wr(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function _r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Sr(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new _r;++e<n;)this.add(t[e])}function Er(t){var e=this.__data__=new wr(t);this.size=e.size}function Ir(t,e){var n=va(t),r=!n&&ga(t),i=!n&&!r&&Sa(t),o=!n&&!r&&!i&&Ba(t),s=n||r||i||o,a=s?fn(t.length,re):[],u=a.length;for(var c in t)!e&&!he.call(t,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ho(c,u))||a.push(c);return a}function Tr(t){var e=t.length;return e?t[Si(0,e-1)]:n}function Ar(t,e){return cs(ro(t),Rr(e,0,t.length))}function Nr(t){return cs(ro(t))}function Cr(t,e,r){(r===n||pa(t[e],r))&&(r!==n||e in t)||xr(t,e,r)}function Or(t,e,r){var i=t[e];he.call(t,e)&&pa(i,r)&&(r!==n||e in t)||xr(t,e,r)}function Dr(t,e){for(var n=t.length;n--;)if(pa(t[n][0],e))return n;return-1}function kr(t,e,n,r){return jr(t,function(t,i,o){e(r,t,n(t),o)}),r}function Mr(t,e){return t&&io(e,ou(e),t)}function xr(t,e,n){"__proto__"==e&&Rn?Rn(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Pr(t,e){for(var r=-1,i=e.length,o=$t(i),s=null==t;++r<i;)o[r]=s?n:tu(t,e[r]);return o}function Rr(t,e,r){return t==t&&(r!==n&&(t=t<=r?t:r),e!==n&&(t=t>=e?t:e)),t}function Lr(t,e,r,i,o,s){var a,u=e&h,c=e&l,d=e&f;if(r&&(a=o?r(t,i,o,s):r(t)),a!==n)return a;if(!Ca(t))return t;var p=va(t);if(p){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&he.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return ro(t,a)}else{var m=Ko(t),y=m==G||m==H;if(Sa(t))return Yi(t,u);if(m==Y||m==F||y&&!o){if(a=c||y?{}:Wo(t),!u)return c?function(t,e){return io(t,Vo(t),e)}(t,function(t,e){return t&&io(e,su(e),t)}(a,t)):function(t,e){return io(t,qo(t),e)}(t,Mr(a,t))}else{if(!Te[m])return o?t:{};a=function(t,e,n){var r,i,o,s=t.constructor;switch(e){case st:return Xi(t);case V:case K:return new s(+t);case at:return function(t,e){var n=e?Xi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case ut:case ct:case ht:case lt:case ft:case dt:case pt:case mt:case yt:return Zi(t,n);case Q:return new s;case J:case et:return new s(t);case Z:return(o=new(i=t).constructor(i.source,qt.exec(i))).lastIndex=i.lastIndex,o;case tt:return new s;case nt:return r=t,fr?ee(fr.call(r)):{}}}(t,m,u)}}s||(s=new Er);var g=s.get(t);if(g)return g;s.set(t,a),Pa(t)?t.forEach(function(n){a.add(Lr(n,e,r,n,t,s))}):Da(t)&&t.forEach(function(n,i){a.set(i,Lr(n,e,r,i,t,s))});var v=p?n:(d?c?xo:Mo:c?su:ou)(t);return Ke(v||t,function(n,i){v&&(n=t[i=n]),Or(a,i,Lr(n,e,r,i,t,s))}),a}function Br(t,e,r){var i=r.length;if(null==t)return!i;for(t=ee(t);i--;){var o=r[i],s=e[o],a=t[o];if(a===n&&!(o in t)||!s(a))return!1}return!0}function Ur(t,e,r){if("function"!=typeof t)throw new ie(o);return os(function(){t.apply(n,r)},e)}function Fr(t,e,n,i){var o=-1,s=He,a=!0,u=t.length,c=[],h=e.length;if(!u)return c;n&&(e=Je(e,pn(n))),i?(s=Qe,a=!1):e.length>=r&&(s=yn,a=!1,e=new Sr(e));t:for(;++o<u;){var l=t[o],f=null==n?l:n(l);if(l=i||0!==l?l:0,a&&f==f){for(var d=h;d--;)if(e[d]===f)continue t;c.push(l)}else s(e,f,i)||c.push(l)}return c}pr.templateSettings={escape:It,evaluate:Tt,interpolate:At,variable:"",imports:{_:pr}},pr.prototype=yr.prototype,pr.prototype.constructor=pr,gr.prototype=mr(yr.prototype),gr.prototype.constructor=gr,vr.prototype=mr(yr.prototype),vr.prototype.constructor=vr,br.prototype.clear=function(){this.__data__=rr?rr(null):{},this.size=0},br.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},br.prototype.get=function(t){var e=this.__data__;if(rr){var r=e[t];return r===a?n:r}return he.call(e,t)?e[t]:n},br.prototype.has=function(t){var e=this.__data__;return rr?e[t]!==n:he.call(e,t)},br.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=rr&&e===n?a:e,this},wr.prototype.clear=function(){this.__data__=[],this.size=0},wr.prototype.delete=function(t){var e=this.__data__,n=Dr(e,t);return!(n<0||(n==e.length-1?e.pop():tn.call(e,n,1),--this.size,0))},wr.prototype.get=function(t){var e=this.__data__,r=Dr(e,t);return r<0?n:e[r][1]},wr.prototype.has=function(t){return Dr(this.__data__,t)>-1},wr.prototype.set=function(t,e){var n=this.__data__,r=Dr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},_r.prototype.clear=function(){this.size=0,this.__data__={hash:new br,map:new(Zn||wr),string:new br}},_r.prototype.delete=function(t){var e=Uo(this,t).delete(t);return this.size-=e?1:0,e},_r.prototype.get=function(t){return Uo(this,t).get(t)},_r.prototype.has=function(t){return Uo(this,t).has(t)},_r.prototype.set=function(t,e){var n=Uo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Sr.prototype.add=Sr.prototype.push=function(t){return this.__data__.set(t,a),this},Sr.prototype.has=function(t){return this.__data__.has(t)},Er.prototype.clear=function(){this.__data__=new wr,this.size=0},Er.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Er.prototype.get=function(t){return this.__data__.get(t)},Er.prototype.has=function(t){return this.__data__.has(t)},Er.prototype.set=function(t,e){var n=this.__data__;if(n instanceof wr){var i=n.__data__;if(!Zn||i.length<r-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new _r(i)}return n.set(t,e),this.size=n.size,this};var jr=ao(Qr),qr=ao(Jr,!0);function Vr(t,e){var n=!0;return jr(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Kr(t,e,r){for(var i=-1,o=t.length;++i<o;){var s=t[i],a=e(s);if(null!=a&&(u===n?a==a&&!La(a):r(a,u)))var u=a,c=s}return c}function zr(t,e){var n=[];return jr(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function Wr(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=Go),i||(i=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?Wr(a,e-1,n,r,i):$e(i,a):r||(i[i.length]=a)}return i}var Gr=uo(),Hr=uo(!0);function Qr(t,e){return t&&Gr(t,e,ou)}function Jr(t,e){return t&&Hr(t,e,ou)}function $r(t,e){return Ge(e,function(e){return Ta(t[e])})}function Yr(t,e){for(var r=0,i=(e=Hi(e,t)).length;null!=t&&r<i;)t=t[ls(e[r++])];return r&&r==i?t:n}function Xr(t,e,n){var r=e(t);return va(t)?r:$e(r,n(t))}function Zr(t){return null==t?t===n?rt:$:Pn&&Pn in ee(t)?function(t){var e=he.call(t,Pn),r=t[Pn];try{t[Pn]=n;var i=!0}catch(t){}var o=de.call(t);return i&&(e?t[Pn]=r:delete t[Pn]),o}(t):function(t){return de.call(t)}(t)}function ti(t,e){return t>e}function ei(t,e){return null!=t&&he.call(t,e)}function ni(t,e){return null!=t&&e in ee(t)}function ri(t,e,r){for(var i=r?Qe:He,o=t[0].length,s=t.length,a=s,u=$t(s),c=1/0,h=[];a--;){var l=t[a];a&&e&&(l=Je(l,pn(e))),c=Hn(l.length,c),u[a]=!r&&(e||o>=120&&l.length>=120)?new Sr(a&&l):n}l=t[0];var f=-1,d=u[0];t:for(;++f<o&&h.length<c;){var p=l[f],m=e?e(p):p;if(p=r||0!==p?p:0,!(d?yn(d,m):i(h,m,r))){for(a=s;--a;){var y=u[a];if(!(y?yn(y,m):i(t[a],m,r)))continue t}d&&d.push(m),h.push(p)}}return h}function ii(t,e,r){var i=null==(t=ns(t,e=Hi(e,t)))?t:t[ls(Is(e))];return null==i?n:qe(i,t,r)}function oi(t){return Oa(t)&&Zr(t)==F}function si(t,e,r,i,o){return t===e||(null==t||null==e||!Oa(t)&&!Oa(e)?t!=t&&e!=e:function(t,e,r,i,o,s){var a=va(t),u=va(e),c=a?j:Ko(t),h=u?j:Ko(e),l=(c=c==F?Y:c)==Y,f=(h=h==F?Y:h)==Y,m=c==h;if(m&&Sa(t)){if(!Sa(e))return!1;a=!0,l=!1}if(m&&!l)return s||(s=new Er),a||Ba(t)?Do(t,e,r,i,o,s):function(t,e,n,r,i,o,s){switch(n){case at:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case st:return!(t.byteLength!=e.byteLength||!o(new Ae(t),new Ae(e)));case V:case K:case J:return pa(+t,+e);case W:return t.name==e.name&&t.message==e.message;case Z:case et:return t==e+"";case Q:var a=En;case tt:var u=r&d;if(a||(a=An),t.size!=e.size&&!u)return!1;var c=s.get(t);if(c)return c==e;r|=p,s.set(t,e);var h=Do(a(t),a(e),r,i,o,s);return s.delete(t),h;case nt:if(fr)return fr.call(t)==fr.call(e)}return!1}(t,e,c,r,i,o,s);if(!(r&d)){var y=l&&he.call(t,"__wrapped__"),g=f&&he.call(e,"__wrapped__");if(y||g){var v=y?t.value():t,b=g?e.value():e;return s||(s=new Er),o(v,b,r,i,s)}}return!!m&&(s||(s=new Er),function(t,e,r,i,o,s){var a=r&d,u=Mo(t),c=u.length,h=Mo(e).length;if(c!=h&&!a)return!1;for(var l=c;l--;){var f=u[l];if(!(a?f in e:he.call(e,f)))return!1}var p=s.get(t),m=s.get(e);if(p&&m)return p==e&&m==t;var y=!0;s.set(t,e),s.set(e,t);for(var g=a;++l<c;){f=u[l];var v=t[f],b=e[f];if(i)var w=a?i(b,v,f,e,t,s):i(v,b,f,t,e,s);if(!(w===n?v===b||o(v,b,r,i,s):w)){y=!1;break}g||(g="constructor"==f)}if(y&&!g){var _=t.constructor,S=e.constructor;_!=S&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof S&&S instanceof S)&&(y=!1)}return s.delete(t),s.delete(e),y}(t,e,r,i,o,s))}(t,e,r,i,si,o))}function ai(t,e,r,i){var o=r.length,s=o,a=!i;if(null==t)return!s;for(t=ee(t);o--;){var u=r[o];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var c=(u=r[o])[0],h=t[c],l=u[1];if(a&&u[2]){if(h===n&&!(c in t))return!1}else{var f=new Er;if(i)var m=i(h,l,c,t,e,f);if(!(m===n?si(l,h,d|p,i,f):m))return!1}}return!0}function ui(t){return!(!Ca(t)||(e=t,fe&&fe in e))&&(Ta(t)?ve:zt).test(fs(t));var e}function ci(t){return"function"==typeof t?t:null==t?ku:"object"==typeof t?va(t)?mi(t[0],t[1]):pi(t):ju(t)}function hi(t){if(!Xo(t))return Wn(t);var e=[];for(var n in ee(t))he.call(t,n)&&"constructor"!=n&&e.push(n);return e}function li(t){if(!Ca(t))return function(t){var e=[];if(null!=t)for(var n in ee(t))e.push(n);return e}(t);var e=Xo(t),n=[];for(var r in t)("constructor"!=r||!e&&he.call(t,r))&&n.push(r);return n}function fi(t,e){return t<e}function di(t,e){var n=-1,r=wa(t)?$t(t.length):[];return jr(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function pi(t){var e=Fo(t);return 1==e.length&&e[0][2]?ts(e[0][0],e[0][1]):function(n){return n===t||ai(n,t,e)}}function mi(t,e){return Jo(t)&&Zo(e)?ts(ls(t),e):function(r){var i=tu(r,t);return i===n&&i===e?eu(r,t):si(e,i,d|p)}}function yi(t,e,r,i,o){t!==e&&Gr(e,function(s,a){if(o||(o=new Er),Ca(s))!function(t,e,r,i,o,s,a){var u=rs(t,r),c=rs(e,r),h=a.get(c);if(h)Cr(t,r,h);else{var l=s?s(u,c,r+"",t,e,a):n,f=l===n;if(f){var d=va(c),p=!d&&Sa(c),m=!d&&!p&&Ba(c);l=c,d||p||m?va(u)?l=u:_a(u)?l=ro(u):p?(f=!1,l=Yi(c,!0)):m?(f=!1,l=Zi(c,!0)):l=[]:Ma(c)||ga(c)?(l=u,ga(u)?l=Wa(u):Ca(u)&&!Ta(u)||(l=Wo(c))):f=!1}f&&(a.set(c,l),o(l,c,i,s,a),a.delete(c)),Cr(t,r,l)}}(t,e,a,r,yi,i,o);else{var u=i?i(rs(t,a),s,a+"",t,e,o):n;u===n&&(u=s),Cr(t,a,u)}},su)}function gi(t,e){var r=t.length;if(r)return Ho(e+=e<0?r:0,r)?t[e]:n}function vi(t,e,n){e=e.length?Je(e,function(t){return va(t)?function(e){return Yr(e,1===t.length?t[0]:t)}:t}):[ku];var r=-1;return e=Je(e,pn(Bo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(di(t,function(t,n,i){return{criteria:Je(e,function(e){return e(t)}),index:++r,value:t}}),function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,s=i.length,a=n.length;++r<s;){var u=to(i[r],o[r]);if(u){if(r>=a)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)})}function bi(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=Yr(t,s);n(a,s)&&Ni(o,Hi(s,t),a)}return o}function wi(t,e,n,r){var i=r?on:rn,o=-1,s=e.length,a=t;for(t===e&&(e=ro(e)),n&&(a=Je(t,pn(n)));++o<s;)for(var u=0,c=e[o],h=n?n(c):c;(u=i(a,h,u,r))>-1;)a!==t&&tn.call(a,u,1),tn.call(t,u,1);return t}function _i(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Ho(i)?tn.call(t,i,1):Fi(t,i)}}return t}function Si(t,e){return t+jn($n()*(e-t+1))}function Ei(t,e){var n="";if(!t||e<1||e>M)return n;do{e%2&&(n+=t),(e=jn(e/2))&&(t+=t)}while(e);return n}function Ii(t,e){return ss(es(t,e,ku),t+"")}function Ti(t){return Tr(pu(t))}function Ai(t,e){var n=pu(t);return cs(n,Rr(e,0,n.length))}function Ni(t,e,r,i){if(!Ca(t))return t;for(var o=-1,s=(e=Hi(e,t)).length,a=s-1,u=t;null!=u&&++o<s;){var c=ls(e[o]),h=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=a){var l=u[c];(h=i?i(l,c,u):n)===n&&(h=Ca(l)?l:Ho(e[o+1])?[]:{})}Or(u,c,h),u=u[c]}return t}var Ci=ir?function(t,e){return ir.set(t,e),t}:ku,Oi=Rn?function(t,e){return Rn(t,"toString",{configurable:!0,enumerable:!1,value:Cu(e),writable:!0})}:ku;function Di(t){return cs(pu(t))}function ki(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=$t(i);++r<i;)o[r]=t[r+e];return o}function Mi(t,e){var n;return jr(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function xi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=B){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!La(s)&&(n?s<=e:s<e)?r=o+1:i=o}return i}return Pi(t,e,ku,n)}function Pi(t,e,r,i){var o=0,s=null==t?0:t.length;if(0===s)return 0;for(var a=(e=r(e))!=e,u=null===e,c=La(e),h=e===n;o<s;){var l=jn((o+s)/2),f=r(t[l]),d=f!==n,p=null===f,m=f==f,y=La(f);if(a)var g=i||m;else g=h?m&&(i||d):u?m&&d&&(i||!p):c?m&&d&&!p&&(i||!y):!p&&!y&&(i?f<=e:f<e);g?o=l+1:s=l}return Hn(s,L)}function Ri(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!pa(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function Li(t){return"number"==typeof t?t:La(t)?P:+t}function Bi(t){if("string"==typeof t)return t;if(va(t))return Je(t,Bi)+"";if(La(t))return dr?dr.call(t):"";var e=t+"";return"0"==e&&1/t==-k?"-0":e}function Ui(t,e,n){var i=-1,o=He,s=t.length,a=!0,u=[],c=u;if(n)a=!1,o=Qe;else if(s>=r){var h=e?null:Io(t);if(h)return An(h);a=!1,o=yn,c=new Sr}else c=e?[]:u;t:for(;++i<s;){var l=t[i],f=e?e(l):l;if(l=n||0!==l?l:0,a&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue t;e&&c.push(f),u.push(l)}else o(c,f,n)||(c!==u&&c.push(f),u.push(l))}return u}function Fi(t,e){return null==(t=ns(t,e=Hi(e,t)))||delete t[ls(Is(e))]}function ji(t,e,n,r){return Ni(t,e,n(Yr(t,e)),r)}function qi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ki(t,r?0:o,r?o+1:i):ki(t,r?o+1:0,r?i:o)}function Vi(t,e){var n=t;return n instanceof vr&&(n=n.value()),Ye(e,function(t,e){return e.func.apply(e.thisArg,$e([t],e.args))},n)}function Ki(t,e,n){var r=t.length;if(r<2)return r?Ui(t[0]):[];for(var i=-1,o=$t(r);++i<r;)for(var s=t[i],a=-1;++a<r;)a!=i&&(o[i]=Fr(o[i]||s,t[a],e,n));return Ui(Wr(o,1),e,n)}function zi(t,e,r){for(var i=-1,o=t.length,s=e.length,a={};++i<o;){var u=i<s?e[i]:n;r(a,t[i],u)}return a}function Wi(t){return _a(t)?t:[]}function Gi(t){return"function"==typeof t?t:ku}function Hi(t,e){return va(t)?t:Jo(t,e)?[t]:hs(Ga(t))}var Qi=Ii;function Ji(t,e,r){var i=t.length;return r=r===n?i:r,!e&&r>=i?t:ki(t,e,r)}var $i=Ln||function(t){return Oe.clearTimeout(t)};function Yi(t,e){if(e)return t.slice();var n=t.length,r=De?De(n):new t.constructor(n);return t.copy(r),r}function Xi(t){var e=new t.constructor(t.byteLength);return new Ae(e).set(new Ae(t)),e}function Zi(t,e){var n=e?Xi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function to(t,e){if(t!==e){var r=t!==n,i=null===t,o=t==t,s=La(t),a=e!==n,u=null===e,c=e==e,h=La(e);if(!u&&!h&&!s&&t>e||s&&a&&c&&!u&&!h||i&&a&&c||!r&&c||!o)return 1;if(!i&&!s&&!h&&t<e||h&&r&&o&&!i&&!s||u&&r&&o||!a&&o||!c)return-1}return 0}function eo(t,e,n,r){for(var i=-1,o=t.length,s=n.length,a=-1,u=e.length,c=Gn(o-s,0),h=$t(u+c),l=!r;++a<u;)h[a]=e[a];for(;++i<s;)(l||i<o)&&(h[n[i]]=t[i]);for(;c--;)h[a++]=t[i++];return h}function no(t,e,n,r){for(var i=-1,o=t.length,s=-1,a=n.length,u=-1,c=e.length,h=Gn(o-a,0),l=$t(h+c),f=!r;++i<h;)l[i]=t[i];for(var d=i;++u<c;)l[d+u]=e[u];for(;++s<a;)(f||i<o)&&(l[d+n[s]]=t[i++]);return l}function ro(t,e){var n=-1,r=t.length;for(e||(e=$t(r));++n<r;)e[n]=t[n];return e}function io(t,e,r,i){var o=!r;r||(r={});for(var s=-1,a=e.length;++s<a;){var u=e[s],c=i?i(r[u],t[u],u,r,t):n;c===n&&(c=t[u]),o?xr(r,u,c):Or(r,u,c)}return r}function oo(t,e){return function(n,r){var i=va(n)?Ve:kr,o=e?e():{};return i(n,t,Bo(r,2),o)}}function so(t){return Ii(function(e,r){var i=-1,o=r.length,s=o>1?r[o-1]:n,a=o>2?r[2]:n;for(s=t.length>3&&"function"==typeof s?(o--,s):n,a&&Qo(r[0],r[1],a)&&(s=o<3?n:s,o=1),e=ee(e);++i<o;){var u=r[i];u&&t(e,u,i,s)}return e})}function ao(t,e){return function(n,r){if(null==n)return n;if(!wa(n))return t(n,r);for(var i=n.length,o=e?i:-1,s=ee(n);(e?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function uo(t){return function(e,n,r){for(var i=-1,o=ee(e),s=r(e),a=s.length;a--;){var u=s[t?a:++i];if(!1===n(o[u],u,o))break}return e}}function co(t){return function(e){var r=Sn(e=Ga(e))?On(e):n,i=r?r[0]:e.charAt(0),o=r?Ji(r,1).join(""):e.slice(1);return i[t]()+o}}function ho(t){return function(e){return Ye(Tu(gu(e).replace(ye,"")),t,"")}}function lo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=mr(t.prototype),r=t.apply(n,e);return Ca(r)?r:n}}function fo(t){return function(e,r,i){var o=ee(e);if(!wa(e)){var s=Bo(r,3);e=ou(e),r=function(t){return s(o[t],t,o)}}var a=t(e,r,i);return a>-1?o[s?e[a]:a]:n}}function po(t){return ko(function(e){var r=e.length,i=r,s=gr.prototype.thru;for(t&&e.reverse();i--;){var a=e[i];if("function"!=typeof a)throw new ie(o);if(s&&!u&&"wrapper"==Ro(a))var u=new gr([],!0)}for(i=u?i:r;++i<r;){var c=Ro(a=e[i]),h="wrapper"==c?Po(a):n;u=h&&$o(h[0])&&h[1]==(S|v|w|E)&&!h[4].length&&1==h[9]?u[Ro(h[0])].apply(u,h[3]):1==a.length&&$o(a)?u[c]():u.thru(a)}return function(){var t=arguments,n=t[0];if(u&&1==t.length&&va(n))return u.plant(n).value();for(var i=0,o=r?e[i].apply(this,t):n;++i<r;)o=e[i].call(this,o);return o}})}function mo(t,e,r,i,o,s,a,u,c,h){var l=e&S,f=e&m,d=e&y,p=e&(v|b),g=e&I,w=d?n:lo(t);return function m(){for(var y=arguments.length,v=$t(y),b=y;b--;)v[b]=arguments[b];if(p)var _=Lo(m),S=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(v,_);if(i&&(v=eo(v,i,o,p)),s&&(v=no(v,s,a,p)),y-=S,p&&y<h){var E=Tn(v,_);return So(t,e,mo,m.placeholder,r,v,E,u,c,h-y)}var I=f?r:this,T=d?I[t]:t;return y=v.length,u?v=function(t,e){for(var r=t.length,i=Hn(e.length,r),o=ro(t);i--;){var s=e[i];t[i]=Ho(s,r)?o[s]:n}return t}(v,u):g&&y>1&&v.reverse(),l&&c<y&&(v.length=c),this&&this!==Oe&&this instanceof m&&(T=w||lo(T)),T.apply(I,v)}}function yo(t,e){return function(n,r){return function(t,e,n,r){return Qr(t,function(t,i,o){e(r,n(t),i,o)}),r}(n,t,e(r),{})}}function go(t,e){return function(r,i){var o;if(r===n&&i===n)return e;if(r!==n&&(o=r),i!==n){if(o===n)return i;"string"==typeof r||"string"==typeof i?(r=Bi(r),i=Bi(i)):(r=Li(r),i=Li(i)),o=t(r,i)}return o}}function vo(t){return ko(function(e){return e=Je(e,pn(Bo())),Ii(function(n){var r=this;return t(e,function(t){return qe(t,r,n)})})})}function bo(t,e){var r=(e=e===n?" ":Bi(e)).length;if(r<2)return r?Ei(e,t):e;var i=Ei(e,Fn(t/Cn(e)));return Sn(e)?Ji(On(i),0,t).join(""):i.slice(0,t)}function wo(t){return function(e,r,i){return i&&"number"!=typeof i&&Qo(e,r,i)&&(r=i=n),e=qa(e),r===n?(r=e,e=0):r=qa(r),function(t,e,n,r){for(var i=-1,o=Gn(Fn((e-t)/(n||1)),0),s=$t(o);o--;)s[r?o:++i]=t,t+=n;return s}(e,r,i=i===n?e<r?1:-1:qa(i),t)}}function _o(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=za(e),n=za(n)),t(e,n)}}function So(t,e,r,i,o,s,a,u,c,h){var l=e&v;e|=l?w:_,(e&=~(l?_:w))&g||(e&=~(m|y));var f=[t,e,o,l?s:n,l?a:n,l?n:s,l?n:a,u,c,h],d=r.apply(n,f);return $o(t)&&is(d,f),d.placeholder=i,as(d,t,e)}function Eo(t){var e=te[t];return function(t,n){if(t=za(t),(n=null==n?0:Hn(Va(n),292))&&Kn(t)){var r=(Ga(t)+"e").split("e");return+((r=(Ga(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Io=er&&1/An(new er([,-0]))[1]==k?function(t){return new er(t)}:Lu;function To(t){return function(e){var n=Ko(e);return n==Q?En(e):n==tt?Nn(e):function(t,e){return Je(e,function(e){return[e,t[e]]})}(e,t(e))}}function Ao(t,e,r,i,s,a,u,h){var l=e&y;if(!l&&"function"!=typeof t)throw new ie(o);var f=i?i.length:0;if(f||(e&=~(w|_),i=s=n),u=u===n?u:Gn(Va(u),0),h=h===n?h:Va(h),f-=s?s.length:0,e&_){var d=i,p=s;i=s=n}var I=l?n:Po(t),T=[t,e,r,i,s,d,p,a,u,h];if(I&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<(m|y|S),s=r==S&&n==v||r==S&&n==E&&t[7].length<=e[8]||r==(S|E)&&e[7].length<=e[8]&&n==v;if(!o&&!s)return t;r&m&&(t[2]=e[2],i|=n&m?0:g);var a=e[3];if(a){var u=t[3];t[3]=u?eo(u,a,e[4]):a,t[4]=u?Tn(t[3],c):e[4]}(a=e[5])&&(u=t[5],t[5]=u?no(u,a,e[6]):a,t[6]=u?Tn(t[5],c):e[6]),(a=e[7])&&(t[7]=a),r&S&&(t[8]=null==t[8]?e[8]:Hn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(T,I),t=T[0],e=T[1],r=T[2],i=T[3],s=T[4],!(h=T[9]=T[9]===n?l?0:t.length:Gn(T[9]-f,0))&&e&(v|b)&&(e&=~(v|b)),e&&e!=m)A=e==v||e==b?function(t,e,r){var i=lo(t);return function o(){for(var s=arguments.length,a=$t(s),u=s,c=Lo(o);u--;)a[u]=arguments[u];var h=s<3&&a[0]!==c&&a[s-1]!==c?[]:Tn(a,c);return(s-=h.length)<r?So(t,e,mo,o.placeholder,n,a,h,n,n,r-s):qe(this&&this!==Oe&&this instanceof o?i:t,this,a)}}(t,e,h):e!=w&&e!=(m|w)||s.length?mo.apply(n,T):function(t,e,n,r){var i=e&m,o=lo(t);return function e(){for(var s=-1,a=arguments.length,u=-1,c=r.length,h=$t(c+a),l=this&&this!==Oe&&this instanceof e?o:t;++u<c;)h[u]=r[u];for(;a--;)h[u++]=arguments[++s];return qe(l,i?n:this,h)}}(t,e,r,i);else var A=function(t,e,n){var r=e&m,i=lo(t);return function e(){return(this&&this!==Oe&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,r);return as((I?Ci:is)(A,T),t,e)}function No(t,e,r,i){return t===n||pa(t,ae[r])&&!he.call(i,r)?e:t}function Co(t,e,r,i,o,s){return Ca(t)&&Ca(e)&&(s.set(e,t),yi(t,e,n,Co,s),s.delete(e)),t}function Oo(t){return Ma(t)?n:t}function Do(t,e,r,i,o,s){var a=r&d,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var h=s.get(t),l=s.get(e);if(h&&l)return h==e&&l==t;var f=-1,m=!0,y=r&p?new Sr:n;for(s.set(t,e),s.set(e,t);++f<u;){var g=t[f],v=e[f];if(i)var b=a?i(v,g,f,e,t,s):i(g,v,f,t,e,s);if(b!==n){if(b)continue;m=!1;break}if(y){if(!Ze(e,function(t,e){if(!yn(y,e)&&(g===t||o(g,t,r,i,s)))return y.push(e)})){m=!1;break}}else if(g!==v&&!o(g,v,r,i,s)){m=!1;break}}return s.delete(t),s.delete(e),m}function ko(t){return ss(es(t,n,bs),t+"")}function Mo(t){return Xr(t,ou,qo)}function xo(t){return Xr(t,su,Vo)}var Po=ir?function(t){return ir.get(t)}:Lu;function Ro(t){for(var e=t.name+"",n=or[e],r=he.call(or,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Lo(t){return(he.call(pr,"placeholder")?pr:t).placeholder}function Bo(){var t=pr.iteratee||Mu;return t=t===Mu?ci:t,arguments.length?t(arguments[0],arguments[1]):t}function Uo(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Fo(t){for(var e=ou(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Zo(i)]}return e}function jo(t,e){var r=function(t,e){return null==t?n:t[e]}(t,e);return ui(r)?r:n}var qo=qn?function(t){return null==t?[]:(t=ee(t),Ge(qn(t),function(e){return Pe.call(t,e)}))}:Ku,Vo=qn?function(t){for(var e=[];t;)$e(e,qo(t)),t=ke(t);return e}:Ku,Ko=Zr;function zo(t,e,n){for(var r=-1,i=(e=Hi(e,t)).length,o=!1;++r<i;){var s=ls(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Na(i)&&Ho(s,i)&&(va(t)||ga(t))}function Wo(t){return"function"!=typeof t.constructor||Xo(t)?{}:mr(ke(t))}function Go(t){return va(t)||ga(t)||!!(cn&&t&&t[cn])}function Ho(t,e){var n=typeof t;return!!(e=null==e?M:e)&&("number"==n||"symbol"!=n&&Gt.test(t))&&t>-1&&t%1==0&&t<e}function Qo(t,e,n){if(!Ca(n))return!1;var r=typeof e;return!!("number"==r?wa(n)&&Ho(e,n.length):"string"==r&&e in n)&&pa(n[e],t)}function Jo(t,e){if(va(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!La(t))||Ct.test(t)||!Nt.test(t)||null!=e&&t in ee(e)}function $o(t){var e=Ro(t),n=pr[e];if("function"!=typeof n||!(e in vr.prototype))return!1;if(t===n)return!0;var r=Po(n);return!!r&&t===r[0]}(Xn&&Ko(new Xn(new ArrayBuffer(1)))!=at||Zn&&Ko(new Zn)!=Q||tr&&"[object Promise]"!=Ko(tr.resolve())||er&&Ko(new er)!=tt||nr&&Ko(new nr)!=it)&&(Ko=function(t){var e=Zr(t),r=e==Y?t.constructor:n,i=r?fs(r):"";if(i)switch(i){case sr:return at;case ar:return Q;case ur:return"[object Promise]";case cr:return tt;case hr:return it}return e});var Yo=ue?Ta:zu;function Xo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ae)}function Zo(t){return t==t&&!Ca(t)}function ts(t,e){return function(r){return null!=r&&r[t]===e&&(e!==n||t in ee(r))}}function es(t,e,r){return e=Gn(e===n?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=Gn(n.length-e,0),s=$t(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=$t(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),qe(t,this,a)}}function ns(t,e){return e.length<2?t:Yr(t,ki(e,0,-1))}function rs(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var is=us(Ci),os=Un||function(t,e){return Oe.setTimeout(t,e)},ss=us(Oi);function as(t,e,n){var r=e+"";return ss(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Pt,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ke(U,function(n){var r="_."+n[0];e&n[1]&&!He(t,r)&&t.push(r)}),t.sort()}(function(t){var e=t.match(Rt);return e?e[1].split(Lt):[]}(r),n)))}function us(t){var e=0,r=0;return function(){var i=Qn(),o=C-(i-r);if(r=i,o>0){if(++e>=N)return arguments[0]}else e=0;return t.apply(n,arguments)}}function cs(t,e){var r=-1,i=t.length,o=i-1;for(e=e===n?i:e;++r<e;){var s=Si(r,o),a=t[s];t[s]=t[r],t[r]=a}return t.length=e,t}var hs=function(t){var e=ua(t,function(t){return n.size===u&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ot,function(t,n,r,i){e.push(r?i.replace(Ft,"$1"):n||t)}),e});function ls(t){if("string"==typeof t||La(t))return t;var e=t+"";return"0"==e&&1/t==-k?"-0":e}function fs(t){if(null!=t){try{return ce.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ds(t){if(t instanceof vr)return t.clone();var e=new gr(t.__wrapped__,t.__chain__);return e.__actions__=ro(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var ps=Ii(function(t,e){return _a(t)?Fr(t,Wr(e,1,_a,!0)):[]}),ms=Ii(function(t,e){var r=Is(e);return _a(r)&&(r=n),_a(t)?Fr(t,Wr(e,1,_a,!0),Bo(r,2)):[]}),ys=Ii(function(t,e){var r=Is(e);return _a(r)&&(r=n),_a(t)?Fr(t,Wr(e,1,_a,!0),n,r):[]});function gs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Va(n);return i<0&&(i=Gn(r+i,0)),nn(t,Bo(e,3),i)}function vs(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var o=i-1;return r!==n&&(o=Va(r),o=r<0?Gn(i+o,0):Hn(o,i-1)),nn(t,Bo(e,3),o,!0)}function bs(t){return null!=t&&t.length?Wr(t,1):[]}function ws(t){return t&&t.length?t[0]:n}var _s=Ii(function(t){var e=Je(t,Wi);return e.length&&e[0]===t[0]?ri(e):[]}),Ss=Ii(function(t){var e=Is(t),r=Je(t,Wi);return e===Is(r)?e=n:r.pop(),r.length&&r[0]===t[0]?ri(r,Bo(e,2)):[]}),Es=Ii(function(t){var e=Is(t),r=Je(t,Wi);return(e="function"==typeof e?e:n)&&r.pop(),r.length&&r[0]===t[0]?ri(r,n,e):[]});function Is(t){var e=null==t?0:t.length;return e?t[e-1]:n}var Ts=Ii(As);function As(t,e){return t&&t.length&&e&&e.length?wi(t,e):t}var Ns=ko(function(t,e){var n=null==t?0:t.length,r=Pr(t,e);return _i(t,Je(e,function(t){return Ho(t,n)?+t:t}).sort(to)),r});function Cs(t){return null==t?t:Yn.call(t)}var Os=Ii(function(t){return Ui(Wr(t,1,_a,!0))}),Ds=Ii(function(t){var e=Is(t);return _a(e)&&(e=n),Ui(Wr(t,1,_a,!0),Bo(e,2))}),ks=Ii(function(t){var e=Is(t);return e="function"==typeof e?e:n,Ui(Wr(t,1,_a,!0),n,e)});function Ms(t){if(!t||!t.length)return[];var e=0;return t=Ge(t,function(t){if(_a(t))return e=Gn(t.length,e),!0}),fn(e,function(e){return Je(t,un(e))})}function xs(t,e){if(!t||!t.length)return[];var r=Ms(t);return null==e?r:Je(r,function(t){return qe(e,n,t)})}var Ps=Ii(function(t,e){return _a(t)?Fr(t,e):[]}),Rs=Ii(function(t){return Ki(Ge(t,_a))}),Ls=Ii(function(t){var e=Is(t);return _a(e)&&(e=n),Ki(Ge(t,_a),Bo(e,2))}),Bs=Ii(function(t){var e=Is(t);return e="function"==typeof e?e:n,Ki(Ge(t,_a),n,e)}),Us=Ii(Ms);var Fs=Ii(function(t){var e=t.length,r=e>1?t[e-1]:n;return r="function"==typeof r?(t.pop(),r):n,xs(t,r)});function js(t){var e=pr(t);return e.__chain__=!0,e}function qs(t,e){return e(t)}var Vs=ko(function(t){var e=t.length,r=e?t[0]:0,i=this.__wrapped__,o=function(e){return Pr(e,t)};return!(e>1||this.__actions__.length)&&i instanceof vr&&Ho(r)?((i=i.slice(r,+r+(e?1:0))).__actions__.push({func:qs,args:[o],thisArg:n}),new gr(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(n),t})):this.thru(o)});var Ks=oo(function(t,e,n){he.call(t,n)?++t[n]:xr(t,n,1)});var zs=fo(gs),Ws=fo(vs);function Gs(t,e){return(va(t)?Ke:jr)(t,Bo(e,3))}function Hs(t,e){return(va(t)?ze:qr)(t,Bo(e,3))}var Qs=oo(function(t,e,n){he.call(t,n)?t[n].push(e):xr(t,n,[e])});var Js=Ii(function(t,e,n){var r=-1,i="function"==typeof e,o=wa(t)?$t(t.length):[];return jr(t,function(t){o[++r]=i?qe(e,t,n):ii(t,e,n)}),o}),$s=oo(function(t,e,n){xr(t,n,e)});function Ys(t,e){return(va(t)?Je:di)(t,Bo(e,3))}var Xs=oo(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var Zs=Ii(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Qo(t,e[0],e[1])?e=[]:n>2&&Qo(e[0],e[1],e[2])&&(e=[e[0]]),vi(t,Wr(e,1),[])}),ta=Bn||function(){return Oe.Date.now()};function ea(t,e,r){return e=r?n:e,e=t&&null==e?t.length:e,Ao(t,S,n,n,n,n,e)}function na(t,e){var r;if("function"!=typeof e)throw new ie(o);return t=Va(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=n),r}}var ra=Ii(function(t,e,n){var r=m;if(n.length){var i=Tn(n,Lo(ra));r|=w}return Ao(t,r,e,n,i)}),ia=Ii(function(t,e,n){var r=m|y;if(n.length){var i=Tn(n,Lo(ia));r|=w}return Ao(e,r,t,n,i)});function oa(t,e,r){var i,s,a,u,c,h,l=0,f=!1,d=!1,p=!0;if("function"!=typeof t)throw new ie(o);function m(e){var r=i,o=s;return i=s=n,l=e,u=t.apply(o,r)}function y(t){var r=t-h;return h===n||r>=e||r<0||d&&t-l>=a}function g(){var t=ta();if(y(t))return v(t);c=os(g,function(t){var n=e-(t-h);return d?Hn(n,a-(t-l)):n}(t))}function v(t){return c=n,p&&i?m(t):(i=s=n,u)}function b(){var t=ta(),r=y(t);if(i=arguments,s=this,h=t,r){if(c===n)return function(t){return l=t,c=os(g,e),f?m(t):u}(h);if(d)return $i(c),c=os(g,e),m(h)}return c===n&&(c=os(g,e)),u}return e=za(e)||0,Ca(r)&&(f=!!r.leading,a=(d="maxWait"in r)?Gn(za(r.maxWait)||0,e):a,p="trailing"in r?!!r.trailing:p),b.cancel=function(){c!==n&&$i(c),l=0,i=h=s=c=n},b.flush=function(){return c===n?u:v(ta())},b}var sa=Ii(function(t,e){return Ur(t,1,e)}),aa=Ii(function(t,e,n){return Ur(t,za(e)||0,n)});function ua(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ie(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(ua.Cache||_r),n}function ca(t){if("function"!=typeof t)throw new ie(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ua.Cache=_r;var ha=Qi(function(t,e){var n=(e=1==e.length&&va(e[0])?Je(e[0],pn(Bo())):Je(Wr(e,1),pn(Bo()))).length;return Ii(function(r){for(var i=-1,o=Hn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return qe(t,this,r)})}),la=Ii(function(t,e){var r=Tn(e,Lo(la));return Ao(t,w,n,e,r)}),fa=Ii(function(t,e){var r=Tn(e,Lo(fa));return Ao(t,_,n,e,r)}),da=ko(function(t,e){return Ao(t,E,n,n,n,e)});function pa(t,e){return t===e||t!=t&&e!=e}var ma=_o(ti),ya=_o(function(t,e){return t>=e}),ga=oi(function(){return arguments}())?oi:function(t){return Oa(t)&&he.call(t,"callee")&&!Pe.call(t,"callee")},va=$t.isArray,ba=Re?pn(Re):function(t){return Oa(t)&&Zr(t)==st};function wa(t){return null!=t&&Na(t.length)&&!Ta(t)}function _a(t){return Oa(t)&&wa(t)}var Sa=Vn||zu,Ea=Le?pn(Le):function(t){return Oa(t)&&Zr(t)==K};function Ia(t){if(!Oa(t))return!1;var e=Zr(t);return e==W||e==z||"string"==typeof t.message&&"string"==typeof t.name&&!Ma(t)}function Ta(t){if(!Ca(t))return!1;var e=Zr(t);return e==G||e==H||e==q||e==X}function Aa(t){return"number"==typeof t&&t==Va(t)}function Na(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=M}function Ca(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Oa(t){return null!=t&&"object"==typeof t}var Da=Be?pn(Be):function(t){return Oa(t)&&Ko(t)==Q};function ka(t){return"number"==typeof t||Oa(t)&&Zr(t)==J}function Ma(t){if(!Oa(t)||Zr(t)!=Y)return!1;var e=ke(t);if(null===e)return!0;var n=he.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ce.call(n)==pe}var xa=Ue?pn(Ue):function(t){return Oa(t)&&Zr(t)==Z};var Pa=Fe?pn(Fe):function(t){return Oa(t)&&Ko(t)==tt};function Ra(t){return"string"==typeof t||!va(t)&&Oa(t)&&Zr(t)==et}function La(t){return"symbol"==typeof t||Oa(t)&&Zr(t)==nt}var Ba=je?pn(je):function(t){return Oa(t)&&Na(t.length)&&!!Ie[Zr(t)]};var Ua=_o(fi),Fa=_o(function(t,e){return t<=e});function ja(t){if(!t)return[];if(wa(t))return Ra(t)?On(t):ro(t);if(xn&&t[xn])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[xn]());var e=Ko(t);return(e==Q?En:e==tt?An:pu)(t)}function qa(t){return t?(t=za(t))===k||t===-k?(t<0?-1:1)*x:t==t?t:0:0===t?t:0}function Va(t){var e=qa(t),n=e%1;return e==e?n?e-n:e:0}function Ka(t){return t?Rr(Va(t),0,R):0}function za(t){if("number"==typeof t)return t;if(La(t))return P;if(Ca(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ca(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=dn(t);var n=Kt.test(t);return n||Wt.test(t)?Ce(t.slice(2),n?2:8):Vt.test(t)?P:+t}function Wa(t){return io(t,su(t))}function Ga(t){return null==t?"":Bi(t)}var Ha=so(function(t,e){if(Xo(e)||wa(e))io(e,ou(e),t);else for(var n in e)he.call(e,n)&&Or(t,n,e[n])}),Qa=so(function(t,e){io(e,su(e),t)}),Ja=so(function(t,e,n,r){io(e,su(e),t,r)}),$a=so(function(t,e,n,r){io(e,ou(e),t,r)}),Ya=ko(Pr);var Xa=Ii(function(t,e){t=ee(t);var r=-1,i=e.length,o=i>2?e[2]:n;for(o&&Qo(e[0],e[1],o)&&(i=1);++r<i;)for(var s=e[r],a=su(s),u=-1,c=a.length;++u<c;){var h=a[u],l=t[h];(l===n||pa(l,ae[h])&&!he.call(t,h))&&(t[h]=s[h])}return t}),Za=Ii(function(t){return t.push(n,Co),qe(uu,n,t)});function tu(t,e,r){var i=null==t?n:Yr(t,e);return i===n?r:i}function eu(t,e){return null!=t&&zo(t,e,ni)}var nu=yo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=de.call(e)),t[e]=n},Cu(ku)),ru=yo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=de.call(e)),he.call(t,e)?t[e].push(n):t[e]=[n]},Bo),iu=Ii(ii);function ou(t){return wa(t)?Ir(t):hi(t)}function su(t){return wa(t)?Ir(t,!0):li(t)}var au=so(function(t,e,n){yi(t,e,n)}),uu=so(function(t,e,n,r){yi(t,e,n,r)}),cu=ko(function(t,e){var n={};if(null==t)return n;var r=!1;e=Je(e,function(e){return e=Hi(e,t),r||(r=e.length>1),e}),io(t,xo(t),n),r&&(n=Lr(n,h|l|f,Oo));for(var i=e.length;i--;)Fi(n,e[i]);return n});var hu=ko(function(t,e){return null==t?{}:function(t,e){return bi(t,e,function(e,n){return eu(t,n)})}(t,e)});function lu(t,e){if(null==t)return{};var n=Je(xo(t),function(t){return[t]});return e=Bo(e),bi(t,n,function(t,n){return e(t,n[0])})}var fu=To(ou),du=To(su);function pu(t){return null==t?[]:mn(t,ou(t))}var mu=ho(function(t,e,n){return e=e.toLowerCase(),t+(n?yu(e):e)});function yu(t){return Iu(Ga(t).toLowerCase())}function gu(t){return(t=Ga(t))&&t.replace(Ht,bn).replace(ge,"")}var vu=ho(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),bu=ho(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),wu=co("toLowerCase");var _u=ho(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});var Su=ho(function(t,e,n){return t+(n?" ":"")+Iu(e)});var Eu=ho(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Iu=co("toUpperCase");function Tu(t,e,r){return t=Ga(t),(e=r?n:e)===n?function(t){return _e.test(t)}(t)?function(t){return t.match(be)||[]}(t):function(t){return t.match(Bt)||[]}(t):t.match(e)||[]}var Au=Ii(function(t,e){try{return qe(t,n,e)}catch(t){return Ia(t)?t:new Xt(t)}}),Nu=ko(function(t,e){return Ke(e,function(e){e=ls(e),xr(t,e,ra(t[e],t))}),t});function Cu(t){return function(){return t}}var Ou=po(),Du=po(!0);function ku(t){return t}function Mu(t){return ci("function"==typeof t?t:Lr(t,h))}var xu=Ii(function(t,e){return function(n){return ii(n,t,e)}}),Pu=Ii(function(t,e){return function(n){return ii(t,n,e)}});function Ru(t,e,n){var r=ou(e),i=$r(e,r);null!=n||Ca(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=$r(e,ou(e)));var o=!(Ca(n)&&"chain"in n&&!n.chain),s=Ta(t);return Ke(i,function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=ro(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,$e([this.value()],arguments))})}),t}function Lu(){}var Bu=vo(Je),Uu=vo(We),Fu=vo(Ze);function ju(t){return Jo(t)?un(ls(t)):function(t){return function(e){return Yr(e,t)}}(t)}var qu=wo(),Vu=wo(!0);function Ku(){return[]}function zu(){return!1}var Wu=go(function(t,e){return t+e},0),Gu=Eo("ceil"),Hu=go(function(t,e){return t/e},1),Qu=Eo("floor");var Ju,$u=go(function(t,e){return t*e},1),Yu=Eo("round"),Xu=go(function(t,e){return t-e},0);return pr.after=function(t,e){if("function"!=typeof e)throw new ie(o);return t=Va(t),function(){if(--t<1)return e.apply(this,arguments)}},pr.ary=ea,pr.assign=Ha,pr.assignIn=Qa,pr.assignInWith=Ja,pr.assignWith=$a,pr.at=Ya,pr.before=na,pr.bind=ra,pr.bindAll=Nu,pr.bindKey=ia,pr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return va(t)?t:[t]},pr.chain=js,pr.chunk=function(t,e,r){e=(r?Qo(t,e,r):e===n)?1:Gn(Va(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,s=0,a=$t(Fn(i/e));o<i;)a[s++]=ki(t,o,o+=e);return a},pr.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},pr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=$t(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return $e(va(n)?ro(n):[n],Wr(e,1))},pr.cond=function(t){var e=null==t?0:t.length,n=Bo();return t=e?Je(t,function(t){if("function"!=typeof t[1])throw new ie(o);return[n(t[0]),t[1]]}):[],Ii(function(n){for(var r=-1;++r<e;){var i=t[r];if(qe(i[0],this,n))return qe(i[1],this,n)}})},pr.conforms=function(t){return function(t){var e=ou(t);return function(n){return Br(n,t,e)}}(Lr(t,h))},pr.constant=Cu,pr.countBy=Ks,pr.create=function(t,e){var n=mr(t);return null==e?n:Mr(n,e)},pr.curry=function t(e,r,i){var o=Ao(e,v,n,n,n,n,n,r=i?n:r);return o.placeholder=t.placeholder,o},pr.curryRight=function t(e,r,i){var o=Ao(e,b,n,n,n,n,n,r=i?n:r);return o.placeholder=t.placeholder,o},pr.debounce=oa,pr.defaults=Xa,pr.defaultsDeep=Za,pr.defer=sa,pr.delay=aa,pr.difference=ps,pr.differenceBy=ms,pr.differenceWith=ys,pr.drop=function(t,e,r){var i=null==t?0:t.length;return i?ki(t,(e=r||e===n?1:Va(e))<0?0:e,i):[]},pr.dropRight=function(t,e,r){var i=null==t?0:t.length;return i?ki(t,0,(e=i-(e=r||e===n?1:Va(e)))<0?0:e):[]},pr.dropRightWhile=function(t,e){return t&&t.length?qi(t,Bo(e,3),!0,!0):[]},pr.dropWhile=function(t,e){return t&&t.length?qi(t,Bo(e,3),!0):[]},pr.fill=function(t,e,r,i){var o=null==t?0:t.length;return o?(r&&"number"!=typeof r&&Qo(t,e,r)&&(r=0,i=o),function(t,e,r,i){var o=t.length;for((r=Va(r))<0&&(r=-r>o?0:o+r),(i=i===n||i>o?o:Va(i))<0&&(i+=o),i=r>i?0:Ka(i);r<i;)t[r++]=e;return t}(t,e,r,i)):[]},pr.filter=function(t,e){return(va(t)?Ge:zr)(t,Bo(e,3))},pr.flatMap=function(t,e){return Wr(Ys(t,e),1)},pr.flatMapDeep=function(t,e){return Wr(Ys(t,e),k)},pr.flatMapDepth=function(t,e,r){return r=r===n?1:Va(r),Wr(Ys(t,e),r)},pr.flatten=bs,pr.flattenDeep=function(t){return null!=t&&t.length?Wr(t,k):[]},pr.flattenDepth=function(t,e){return null!=t&&t.length?Wr(t,e=e===n?1:Va(e)):[]},pr.flip=function(t){return Ao(t,I)},pr.flow=Ou,pr.flowRight=Du,pr.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},pr.functions=function(t){return null==t?[]:$r(t,ou(t))},pr.functionsIn=function(t){return null==t?[]:$r(t,su(t))},pr.groupBy=Qs,pr.initial=function(t){return null!=t&&t.length?ki(t,0,-1):[]},pr.intersection=_s,pr.intersectionBy=Ss,pr.intersectionWith=Es,pr.invert=nu,pr.invertBy=ru,pr.invokeMap=Js,pr.iteratee=Mu,pr.keyBy=$s,pr.keys=ou,pr.keysIn=su,pr.map=Ys,pr.mapKeys=function(t,e){var n={};return e=Bo(e,3),Qr(t,function(t,r,i){xr(n,e(t,r,i),t)}),n},pr.mapValues=function(t,e){var n={};return e=Bo(e,3),Qr(t,function(t,r,i){xr(n,r,e(t,r,i))}),n},pr.matches=function(t){return pi(Lr(t,h))},pr.matchesProperty=function(t,e){return mi(t,Lr(e,h))},pr.memoize=ua,pr.merge=au,pr.mergeWith=uu,pr.method=xu,pr.methodOf=Pu,pr.mixin=Ru,pr.negate=ca,pr.nthArg=function(t){return t=Va(t),Ii(function(e){return gi(e,t)})},pr.omit=cu,pr.omitBy=function(t,e){return lu(t,ca(Bo(e)))},pr.once=function(t){return na(2,t)},pr.orderBy=function(t,e,r,i){return null==t?[]:(va(e)||(e=null==e?[]:[e]),va(r=i?n:r)||(r=null==r?[]:[r]),vi(t,e,r))},pr.over=Bu,pr.overArgs=ha,pr.overEvery=Uu,pr.overSome=Fu,pr.partial=la,pr.partialRight=fa,pr.partition=Xs,pr.pick=hu,pr.pickBy=lu,pr.property=ju,pr.propertyOf=function(t){return function(e){return null==t?n:Yr(t,e)}},pr.pull=Ts,pr.pullAll=As,pr.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?wi(t,e,Bo(n,2)):t},pr.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?wi(t,e,n,r):t},pr.pullAt=Ns,pr.range=qu,pr.rangeRight=Vu,pr.rearg=da,pr.reject=function(t,e){return(va(t)?Ge:zr)(t,ca(Bo(e,3)))},pr.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Bo(e,3);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return _i(t,i),n},pr.rest=function(t,e){if("function"!=typeof t)throw new ie(o);return Ii(t,e=e===n?e:Va(e))},pr.reverse=Cs,pr.sampleSize=function(t,e,r){return e=(r?Qo(t,e,r):e===n)?1:Va(e),(va(t)?Ar:Ai)(t,e)},pr.set=function(t,e,n){return null==t?t:Ni(t,e,n)},pr.setWith=function(t,e,r,i){return i="function"==typeof i?i:n,null==t?t:Ni(t,e,r,i)},pr.shuffle=function(t){return(va(t)?Nr:Di)(t)},pr.slice=function(t,e,r){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&Qo(t,e,r)?(e=0,r=i):(e=null==e?0:Va(e),r=r===n?i:Va(r)),ki(t,e,r)):[]},pr.sortBy=Zs,pr.sortedUniq=function(t){return t&&t.length?Ri(t):[]},pr.sortedUniqBy=function(t,e){return t&&t.length?Ri(t,Bo(e,2)):[]},pr.split=function(t,e,r){return r&&"number"!=typeof r&&Qo(t,e,r)&&(e=r=n),(r=r===n?R:r>>>0)?(t=Ga(t))&&("string"==typeof e||null!=e&&!xa(e))&&!(e=Bi(e))&&Sn(t)?Ji(On(t),0,r):t.split(e,r):[]},pr.spread=function(t,e){if("function"!=typeof t)throw new ie(o);return e=null==e?0:Gn(Va(e),0),Ii(function(n){var r=n[e],i=Ji(n,0,e);return r&&$e(i,r),qe(t,this,i)})},pr.tail=function(t){var e=null==t?0:t.length;return e?ki(t,1,e):[]},pr.take=function(t,e,r){return t&&t.length?ki(t,0,(e=r||e===n?1:Va(e))<0?0:e):[]},pr.takeRight=function(t,e,r){var i=null==t?0:t.length;return i?ki(t,(e=i-(e=r||e===n?1:Va(e)))<0?0:e,i):[]},pr.takeRightWhile=function(t,e){return t&&t.length?qi(t,Bo(e,3),!1,!0):[]},pr.takeWhile=function(t,e){return t&&t.length?qi(t,Bo(e,3)):[]},pr.tap=function(t,e){return e(t),t},pr.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new ie(o);return Ca(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),oa(t,e,{leading:r,maxWait:e,trailing:i})},pr.thru=qs,pr.toArray=ja,pr.toPairs=fu,pr.toPairsIn=du,pr.toPath=function(t){return va(t)?Je(t,ls):La(t)?[t]:ro(hs(Ga(t)))},pr.toPlainObject=Wa,pr.transform=function(t,e,n){var r=va(t),i=r||Sa(t)||Ba(t);if(e=Bo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:Ca(t)&&Ta(o)?mr(ke(t)):{}}return(i?Ke:Qr)(t,function(t,r,i){return e(n,t,r,i)}),n},pr.unary=function(t){return ea(t,1)},pr.union=Os,pr.unionBy=Ds,pr.unionWith=ks,pr.uniq=function(t){return t&&t.length?Ui(t):[]},pr.uniqBy=function(t,e){return t&&t.length?Ui(t,Bo(e,2)):[]},pr.uniqWith=function(t,e){return e="function"==typeof e?e:n,t&&t.length?Ui(t,n,e):[]},pr.unset=function(t,e){return null==t||Fi(t,e)},pr.unzip=Ms,pr.unzipWith=xs,pr.update=function(t,e,n){return null==t?t:ji(t,e,Gi(n))},pr.updateWith=function(t,e,r,i){return i="function"==typeof i?i:n,null==t?t:ji(t,e,Gi(r),i)},pr.values=pu,pr.valuesIn=function(t){return null==t?[]:mn(t,su(t))},pr.without=Ps,pr.words=Tu,pr.wrap=function(t,e){return la(Gi(e),t)},pr.xor=Rs,pr.xorBy=Ls,pr.xorWith=Bs,pr.zip=Us,pr.zipObject=function(t,e){return zi(t||[],e||[],Or)},pr.zipObjectDeep=function(t,e){return zi(t||[],e||[],Ni)},pr.zipWith=Fs,pr.entries=fu,pr.entriesIn=du,pr.extend=Qa,pr.extendWith=Ja,Ru(pr,pr),pr.add=Wu,pr.attempt=Au,pr.camelCase=mu,pr.capitalize=yu,pr.ceil=Gu,pr.clamp=function(t,e,r){return r===n&&(r=e,e=n),r!==n&&(r=(r=za(r))==r?r:0),e!==n&&(e=(e=za(e))==e?e:0),Rr(za(t),e,r)},pr.clone=function(t){return Lr(t,f)},pr.cloneDeep=function(t){return Lr(t,h|f)},pr.cloneDeepWith=function(t,e){return Lr(t,h|f,e="function"==typeof e?e:n)},pr.cloneWith=function(t,e){return Lr(t,f,e="function"==typeof e?e:n)},pr.conformsTo=function(t,e){return null==e||Br(t,e,ou(e))},pr.deburr=gu,pr.defaultTo=function(t,e){return null==t||t!=t?e:t},pr.divide=Hu,pr.endsWith=function(t,e,r){t=Ga(t),e=Bi(e);var i=t.length,o=r=r===n?i:Rr(Va(r),0,i);return(r-=e.length)>=0&&t.slice(r,o)==e},pr.eq=pa,pr.escape=function(t){return(t=Ga(t))&&Et.test(t)?t.replace(_t,wn):t},pr.escapeRegExp=function(t){return(t=Ga(t))&&kt.test(t)?t.replace(Dt,"\\$&"):t},pr.every=function(t,e,r){var i=va(t)?We:Vr;return r&&Qo(t,e,r)&&(e=n),i(t,Bo(e,3))},pr.find=zs,pr.findIndex=gs,pr.findKey=function(t,e){return en(t,Bo(e,3),Qr)},pr.findLast=Ws,pr.findLastIndex=vs,pr.findLastKey=function(t,e){return en(t,Bo(e,3),Jr)},pr.floor=Qu,pr.forEach=Gs,pr.forEachRight=Hs,pr.forIn=function(t,e){return null==t?t:Gr(t,Bo(e,3),su)},pr.forInRight=function(t,e){return null==t?t:Hr(t,Bo(e,3),su)},pr.forOwn=function(t,e){return t&&Qr(t,Bo(e,3))},pr.forOwnRight=function(t,e){return t&&Jr(t,Bo(e,3))},pr.get=tu,pr.gt=ma,pr.gte=ya,pr.has=function(t,e){return null!=t&&zo(t,e,ei)},pr.hasIn=eu,pr.head=ws,pr.identity=ku,pr.includes=function(t,e,n,r){t=wa(t)?t:pu(t),n=n&&!r?Va(n):0;var i=t.length;return n<0&&(n=Gn(i+n,0)),Ra(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&rn(t,e,n)>-1},pr.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Va(n);return i<0&&(i=Gn(r+i,0)),rn(t,e,i)},pr.inRange=function(t,e,r){return e=qa(e),r===n?(r=e,e=0):r=qa(r),function(t,e,n){return t>=Hn(e,n)&&t<Gn(e,n)}(t=za(t),e,r)},pr.invoke=iu,pr.isArguments=ga,pr.isArray=va,pr.isArrayBuffer=ba,pr.isArrayLike=wa,pr.isArrayLikeObject=_a,pr.isBoolean=function(t){return!0===t||!1===t||Oa(t)&&Zr(t)==V},pr.isBuffer=Sa,pr.isDate=Ea,pr.isElement=function(t){return Oa(t)&&1===t.nodeType&&!Ma(t)},pr.isEmpty=function(t){if(null==t)return!0;if(wa(t)&&(va(t)||"string"==typeof t||"function"==typeof t.splice||Sa(t)||Ba(t)||ga(t)))return!t.length;var e=Ko(t);if(e==Q||e==tt)return!t.size;if(Xo(t))return!hi(t).length;for(var n in t)if(he.call(t,n))return!1;return!0},pr.isEqual=function(t,e){return si(t,e)},pr.isEqualWith=function(t,e,r){var i=(r="function"==typeof r?r:n)?r(t,e):n;return i===n?si(t,e,n,r):!!i},pr.isError=Ia,pr.isFinite=function(t){return"number"==typeof t&&Kn(t)},pr.isFunction=Ta,pr.isInteger=Aa,pr.isLength=Na,pr.isMap=Da,pr.isMatch=function(t,e){return t===e||ai(t,e,Fo(e))},pr.isMatchWith=function(t,e,r){return r="function"==typeof r?r:n,ai(t,e,Fo(e),r)},pr.isNaN=function(t){return ka(t)&&t!=+t},pr.isNative=function(t){if(Yo(t))throw new Xt(i);return ui(t)},pr.isNil=function(t){return null==t},pr.isNull=function(t){return null===t},pr.isNumber=ka,pr.isObject=Ca,pr.isObjectLike=Oa,pr.isPlainObject=Ma,pr.isRegExp=xa,pr.isSafeInteger=function(t){return Aa(t)&&t>=-M&&t<=M},pr.isSet=Pa,pr.isString=Ra,pr.isSymbol=La,pr.isTypedArray=Ba,pr.isUndefined=function(t){return t===n},pr.isWeakMap=function(t){return Oa(t)&&Ko(t)==it},pr.isWeakSet=function(t){return Oa(t)&&Zr(t)==ot},pr.join=function(t,e){return null==t?"":zn.call(t,e)},pr.kebabCase=vu,pr.last=Is,pr.lastIndexOf=function(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var o=i;return r!==n&&(o=(o=Va(r))<0?Gn(i+o,0):Hn(o,i-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):nn(t,sn,o,!0)},pr.lowerCase=bu,pr.lowerFirst=wu,pr.lt=Ua,pr.lte=Fa,pr.max=function(t){return t&&t.length?Kr(t,ku,ti):n},pr.maxBy=function(t,e){return t&&t.length?Kr(t,Bo(e,2),ti):n},pr.mean=function(t){return an(t,ku)},pr.meanBy=function(t,e){return an(t,Bo(e,2))},pr.min=function(t){return t&&t.length?Kr(t,ku,fi):n},pr.minBy=function(t,e){return t&&t.length?Kr(t,Bo(e,2),fi):n},pr.stubArray=Ku,pr.stubFalse=zu,pr.stubObject=function(){return{}},pr.stubString=function(){return""},pr.stubTrue=function(){return!0},pr.multiply=$u,pr.nth=function(t,e){return t&&t.length?gi(t,Va(e)):n},pr.noConflict=function(){return Oe._===this&&(Oe._=me),this},pr.noop=Lu,pr.now=ta,pr.pad=function(t,e,n){t=Ga(t);var r=(e=Va(e))?Cn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return bo(jn(i),n)+t+bo(Fn(i),n)},pr.padEnd=function(t,e,n){t=Ga(t);var r=(e=Va(e))?Cn(t):0;return e&&r<e?t+bo(e-r,n):t},pr.padStart=function(t,e,n){t=Ga(t);var r=(e=Va(e))?Cn(t):0;return e&&r<e?bo(e-r,n)+t:t},pr.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Jn(Ga(t).replace(Mt,""),e||0)},pr.random=function(t,e,r){if(r&&"boolean"!=typeof r&&Qo(t,e,r)&&(e=r=n),r===n&&("boolean"==typeof e?(r=e,e=n):"boolean"==typeof t&&(r=t,t=n)),t===n&&e===n?(t=0,e=1):(t=qa(t),e===n?(e=t,t=0):e=qa(e)),t>e){var i=t;t=e,e=i}if(r||t%1||e%1){var o=$n();return Hn(t+o*(e-t+Ne("1e-"+((o+"").length-1))),e)}return Si(t,e)},pr.reduce=function(t,e,n){var r=va(t)?Ye:hn,i=arguments.length<3;return r(t,Bo(e,4),n,i,jr)},pr.reduceRight=function(t,e,n){var r=va(t)?Xe:hn,i=arguments.length<3;return r(t,Bo(e,4),n,i,qr)},pr.repeat=function(t,e,r){return e=(r?Qo(t,e,r):e===n)?1:Va(e),Ei(Ga(t),e)},pr.replace=function(){var t=arguments,e=Ga(t[0]);return t.length<3?e:e.replace(t[1],t[2])},pr.result=function(t,e,r){var i=-1,o=(e=Hi(e,t)).length;for(o||(o=1,t=n);++i<o;){var s=null==t?n:t[ls(e[i])];s===n&&(i=o,s=r),t=Ta(s)?s.call(t):s}return t},pr.round=Yu,pr.runInContext=t,pr.sample=function(t){return(va(t)?Tr:Ti)(t)},pr.size=function(t){if(null==t)return 0;if(wa(t))return Ra(t)?Cn(t):t.length;var e=Ko(t);return e==Q||e==tt?t.size:hi(t).length},pr.snakeCase=_u,pr.some=function(t,e,r){var i=va(t)?Ze:Mi;return r&&Qo(t,e,r)&&(e=n),i(t,Bo(e,3))},pr.sortedIndex=function(t,e){return xi(t,e)},pr.sortedIndexBy=function(t,e,n){return Pi(t,e,Bo(n,2))},pr.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=xi(t,e);if(r<n&&pa(t[r],e))return r}return-1},pr.sortedLastIndex=function(t,e){return xi(t,e,!0)},pr.sortedLastIndexBy=function(t,e,n){return Pi(t,e,Bo(n,2),!0)},pr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=xi(t,e,!0)-1;if(pa(t[n],e))return n}return-1},pr.startCase=Su,pr.startsWith=function(t,e,n){return t=Ga(t),n=null==n?0:Rr(Va(n),0,t.length),e=Bi(e),t.slice(n,n+e.length)==e},pr.subtract=Xu,pr.sum=function(t){return t&&t.length?ln(t,ku):0},pr.sumBy=function(t,e){return t&&t.length?ln(t,Bo(e,2)):0},pr.template=function(t,e,r){var i=pr.templateSettings;r&&Qo(t,e,r)&&(e=n),t=Ga(t),e=Ja({},e,i,No);var o,a,u=Ja({},e.imports,i.imports,No),c=ou(u),h=mn(u,c),l=0,f=e.interpolate||Qt,d="__p += '",p=ne((e.escape||Qt).source+"|"+f.source+"|"+(f===At?jt:Qt).source+"|"+(e.evaluate||Qt).source+"|$","g"),m="//# sourceURL="+(he.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ee+"]")+"\n";t.replace(p,function(e,n,r,i,s,u){return r||(r=i),d+=t.slice(l,u).replace(Jt,_n),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),d+="';\n";var y=he.call(e,"variable")&&e.variable;if(y){if(Ut.test(y))throw new Xt(s)}else d="with (obj) {\n"+d+"\n}\n";d=(a?d.replace(gt,""):d).replace(vt,"$1").replace(bt,"$1;"),d="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Au(function(){return Zt(c,m+"return "+d).apply(n,h)});if(g.source=d,Ia(g))throw g;return g},pr.times=function(t,e){if((t=Va(t))<1||t>M)return[];var n=R,r=Hn(t,R);e=Bo(e),t-=R;for(var i=fn(r,e);++n<t;)e(n);return i},pr.toFinite=qa,pr.toInteger=Va,pr.toLength=Ka,pr.toLower=function(t){return Ga(t).toLowerCase()},pr.toNumber=za,pr.toSafeInteger=function(t){return t?Rr(Va(t),-M,M):0===t?t:0},pr.toString=Ga,pr.toUpper=function(t){return Ga(t).toUpperCase()},pr.trim=function(t,e,r){if((t=Ga(t))&&(r||e===n))return dn(t);if(!t||!(e=Bi(e)))return t;var i=On(t),o=On(e);return Ji(i,gn(i,o),vn(i,o)+1).join("")},pr.trimEnd=function(t,e,r){if((t=Ga(t))&&(r||e===n))return t.slice(0,Dn(t)+1);if(!t||!(e=Bi(e)))return t;var i=On(t);return Ji(i,0,vn(i,On(e))+1).join("")},pr.trimStart=function(t,e,r){if((t=Ga(t))&&(r||e===n))return t.replace(Mt,"");if(!t||!(e=Bi(e)))return t;var i=On(t);return Ji(i,gn(i,On(e))).join("")},pr.truncate=function(t,e){var r=T,i=A;if(Ca(e)){var o="separator"in e?e.separator:o;r="length"in e?Va(e.length):r,i="omission"in e?Bi(e.omission):i}var s=(t=Ga(t)).length;if(Sn(t)){var a=On(t);s=a.length}if(r>=s)return t;var u=r-Cn(i);if(u<1)return i;var c=a?Ji(a,0,u).join(""):t.slice(0,u);if(o===n)return c+i;if(a&&(u+=c.length-u),xa(o)){if(t.slice(u).search(o)){var h,l=c;for(o.global||(o=ne(o.source,Ga(qt.exec(o))+"g")),o.lastIndex=0;h=o.exec(l);)var f=h.index;c=c.slice(0,f===n?u:f)}}else if(t.indexOf(Bi(o),u)!=u){var d=c.lastIndexOf(o);d>-1&&(c=c.slice(0,d))}return c+i},pr.unescape=function(t){return(t=Ga(t))&&St.test(t)?t.replace(wt,kn):t},pr.uniqueId=function(t){var e=++le;return Ga(t)+e},pr.upperCase=Eu,pr.upperFirst=Iu,pr.each=Gs,pr.eachRight=Hs,pr.first=ws,Ru(pr,(Ju={},Qr(pr,function(t,e){he.call(pr.prototype,e)||(Ju[e]=t)}),Ju),{chain:!1}),pr.VERSION="4.17.21",Ke(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){pr[t].placeholder=pr}),Ke(["drop","take"],function(t,e){vr.prototype[t]=function(r){r=r===n?1:Gn(Va(r),0);var i=this.__filtered__&&!e?new vr(this):this.clone();return i.__filtered__?i.__takeCount__=Hn(r,i.__takeCount__):i.__views__.push({size:Hn(r,R),type:t+(i.__dir__<0?"Right":"")}),i},vr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Ke(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==O||3==n;vr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Bo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Ke(["head","last"],function(t,e){var n="take"+(e?"Right":"");vr.prototype[t]=function(){return this[n](1).value()[0]}}),Ke(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");vr.prototype[t]=function(){return this.__filtered__?new vr(this):this[n](1)}}),vr.prototype.compact=function(){return this.filter(ku)},vr.prototype.find=function(t){return this.filter(t).head()},vr.prototype.findLast=function(t){return this.reverse().find(t)},vr.prototype.invokeMap=Ii(function(t,e){return"function"==typeof t?new vr(this):this.map(function(n){return ii(n,t,e)})}),vr.prototype.reject=function(t){return this.filter(ca(Bo(t)))},vr.prototype.slice=function(t,e){t=Va(t);var r=this;return r.__filtered__&&(t>0||e<0)?new vr(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==n&&(r=(e=Va(e))<0?r.dropRight(-e):r.take(e-t)),r)},vr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},vr.prototype.toArray=function(){return this.take(R)},Qr(vr.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),o=pr[i?"take"+("last"==e?"Right":""):e],s=i||/^find/.test(e);o&&(pr.prototype[e]=function(){var e=this.__wrapped__,a=i?[1]:arguments,u=e instanceof vr,c=a[0],h=u||va(e),l=function(t){var e=o.apply(pr,$e([t],a));return i&&f?e[0]:e};h&&r&&"function"==typeof c&&1!=c.length&&(u=h=!1);var f=this.__chain__,d=!!this.__actions__.length,p=s&&!f,m=u&&!d;if(!s&&h){e=m?e:new vr(this);var y=t.apply(e,a);return y.__actions__.push({func:qs,args:[l],thisArg:n}),new gr(y,f)}return p&&m?t.apply(this,a):(y=this.thru(l),p?i?y.value()[0]:y.value():y)})}),Ke(["pop","push","shift","sort","splice","unshift"],function(t){var e=oe[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);pr.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(va(i)?i:[],t)}return this[n](function(n){return e.apply(va(n)?n:[],t)})}}),Qr(vr.prototype,function(t,e){var n=pr[e];if(n){var r=n.name+"";he.call(or,r)||(or[r]=[]),or[r].push({name:e,func:n})}}),or[mo(n,y).name]=[{name:"wrapper",func:n}],vr.prototype.clone=function(){var t=new vr(this.__wrapped__);return t.__actions__=ro(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ro(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ro(this.__views__),t},vr.prototype.reverse=function(){if(this.__filtered__){var t=new vr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},vr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=va(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Hn(e,t+s);break;case"takeRight":t=Gn(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=r?a:s-1,h=this.__iteratees__,l=h.length,f=0,d=Hn(u,this.__takeCount__);if(!n||!r&&i==u&&d==u)return Vi(t,this.__actions__);var p=[];t:for(;u--&&f<d;){for(var m=-1,y=t[c+=e];++m<l;){var g=h[m],v=g.iteratee,b=g.type,w=v(y);if(b==D)y=w;else if(!w){if(b==O)continue t;break t}}p[f++]=y}return p},pr.prototype.at=Vs,pr.prototype.chain=function(){return js(this)},pr.prototype.commit=function(){return new gr(this.value(),this.__chain__)},pr.prototype.next=function(){this.__values__===n&&(this.__values__=ja(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?n:this.__values__[this.__index__++]}},pr.prototype.plant=function(t){for(var e,r=this;r instanceof yr;){var i=ds(r);i.__index__=0,i.__values__=n,e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e},pr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof vr){var e=t;return this.__actions__.length&&(e=new vr(this)),(e=e.reverse()).__actions__.push({func:qs,args:[Cs],thisArg:n}),new gr(e,this.__chain__)}return this.thru(Cs)},pr.prototype.toJSON=pr.prototype.valueOf=pr.prototype.value=function(){return Vi(this.__wrapped__,this.__actions__)},pr.prototype.first=pr.prototype.head,xn&&(pr.prototype[xn]=function(){return this}),pr}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Oe._=Mn,define(function(){return Mn})):ke?((ke.exports=Mn)._=Mn,De._=Mn):Oe._=Mn}).call(this)}).call(this,n(128)(t))},function(t,e,n){t.exports=n(129)},function(t,e,n){"use strict";var r=n(63);n.d(e,"default",function(){return r.default})},function(t,e,n){"use strict";n(64);var r=n(31);n.d(e,"default",function(){return r.default});var i=n(20);n.d(e,"isNumberUnit",function(){return i.default});n(30),n(62);var o=n(32);n.d(e,"UnitType",function(){return o.default})},function(t,e,n){"use strict";n.d(e,"maybeReportDifferentTypesDeprecated",function(){return i});const r=t=>{try{console.warn("***************************************************************"),console.warn(t),console.warn("***************************************************************"),console.trace()}catch{}},i=(t,e,n)=>{if(!t.unitType.equals(e.unitType)){const i=`number-unit.${n} on different NumberUnit types (${t}, ${e}) is not correct and will be removed soon.`;r(`DEPRECATION WARNING: ${i}`)}};e.default=r},function(t,e,n){"use strict";var r=n(76);n.o(r,"ENV_DEV")&&n.d(e,"ENV_DEV",function(){return r.ENV_DEV}),n.o(r,"ENV_EXODUS_PROD")&&n.d(e,"ENV_EXODUS_PROD",function(){return r.ENV_EXODUS_PROD}),n.o(r,"FIREBASE_API_URL")&&n.d(e,"FIREBASE_API_URL",function(){return r.FIREBASE_API_URL}),n.o(r,"FIREBASE_CONFIG")&&n.d(e,"FIREBASE_CONFIG",function(){return r.FIREBASE_CONFIG}),n.o(r,"RESTORE_ACTIONS")&&n.d(e,"RESTORE_ACTIONS",function(){return r.RESTORE_ACTIONS})},function(t,e,n){"use strict";var r=n(2),i=n.n(r),o=n(25);n.o(o,"deserialize")&&n.d(e,"deserialize",function(){return o.deserialize}),n.o(o,"serialize")&&n.d(e,"serialize",function(){return o.serialize});const{isEqual:s,pick:a,mapValues:u,isString:c}=i.a;class h{static _getAllFieldNames(){return this._allFieldNames||(this._allFieldNames=Object.keys(this.defaults),this._allFieldNames.push("_version")),this._allFieldNames}static _getFieldNames(){const t=this._getAllFieldNames();return this._fieldNames||(this._fieldNames=t.filter(t=>"mem"!==t)),this._fieldNames}static serialize(t,{includeMem:e=!1}={}){const n=e?this._getAllFieldNames():this._getFieldNames();return Object(o.serialize)(a(t,n))}static deserialize(t){return new this(t&&t.v&&1===t.v._version?Object(o.deserialize)(t):this._legacyParse(t))}static fromJSON(t){return this.deserialize(t)}static create(t){return new this(t)}constructor(t={}){const{defaults:e}=this.constructor;if(this.constructor===h)throw new Error("Instantiating the base AccountState class is forbidden, please instantiate a subclass instance");const n={...e,...a(t,this.constructor._getAllFieldNames())};Object.assign(this,n,{_version:1})}static _legacyParse(t){return this._postParse(u(t,(t,e)=>{if(this._dateKeys.includes(e)&&t)return new Date(t);const n=c(t)&&this._tokens.find(e=>(function(t){const e=Object.keys(t.currency.units);return new RegExp(` (${e.join("|")})$`)})(e).test(t));return n?n.currency.parse(t):t}))}static _postParse(t){return t}toJSON(t){return this.constructor.serialize(this,t)}equals(t,e={includeMem:!0}){return this===t||s(this.toJSON(e),t.toJSON(e))}merge(t){return this.constructor.create({...this,...t})}contains(t){return this.equals(this.merge(t))}}h.defaults={},h._allFieldNames=null,h._fieldNames=null,h._version=0,h._tokens=[],h._dateKeys=[]},function(t,e,n){"use strict";n.d(e,"default",function(){return a});var r=n(0),i=n.n(r),o=n(11),s=Symbol.iterator;class a{constructor(){this._data=void 0,this._data=new Map}static fromArray(t){const e=t.map(t=>{if("string"==typeof t)return o.default.create(t);if("object"==typeof t)return o.default.fromJSON(t);if(t instanceof o.default)return t;throw console.dir(t),new Error("AddressSet#fromArray(): unknown type")}),n=new a;for(const t of e)n._data.set(t.address,t);return n}add(t){i()(o.default.isAddress(t),"Must be an instance of an Address.");const e=new a;return e._data=new Map(this._data),e._data.set(t.address,t),e}delete(t){return this.remove(t)}get(t){return this._data.get(String(t))}has(t){return!!this._data.get(String(t))}remove(t){const e=this.get(t);if(!e)return this;const n=new a;return n._data=new Map(this._data),n._data.delete(e.address),n}sort(t){let e=[...this];return e=e.sort(t),a.fromArray(e)}toArray(){return[...this._data.values()]}toAddressStrings(){return[...this._data.keys()]}toString(){return[...this._data.keys()].join(", ")}union(t){const e=[...[...this],...[...t]];return a.fromArray(e)}[s](){return this._data.values()}get size(){return this._data.size}}a.EMPTY=a.fromArray([]),a.PATH_SORTER=((t,e)=>{const n=t.pathArray,r=e.pathArray;return n[0]<r[0]?-1:n[0]>r[0]?1:n[0]===r[0]?n[1]<r[1]?-1:n[1]>r[1]?1:0:void 0})},function(t,e,n){"use strict";n.d(e,"fiatUnit",function(){return r}),n.d(e,"themeName",function(){return i}),n.d(e,"adaLegacyAddressEnabled",function(){return o}),n.d(e,"moneroInitialHeight",function(){return s}),n.d(e,"moneroSubaddressesEnabled",function(){return a}),n.d(e,"bitcoinLegacyAddressEnabled",function(){return u}),n.d(e,"bitcoinTaprootAddressEnabled",function(){return c}),n.d(e,"rbfEnabledBitcoin",function(){return h}),n.d(e,"rbfEnabledEthereum",function(){return l}),n.d(e,"wentThroughFiatOnboarding",function(){return f});const r="fiat.unit",i="theme.name",o="adaLegacyAddressEnabled",s="moneroInitialHeight",a="moneroSubaddressesEnabled",u="bitcoinLegacyAddressEnabled",c="bitcoinTaprootAddressEnabled",h="advanced.advancedMode.assets.bitcoin",l="advanced.advancedMode.assets.ethereum",f="fiatOnramp.wentThroughFiatOnboarding"},function(t,e,n){"use strict";n.d(e,"default",function(){return a});var r=n(87),i=n.n(r),o=n(86),s=Symbol.toStringTag;class a{constructor(t,e){this.address=void 0,this.meta=void 0,this.address=t,this.meta=e||{}}static create(t,e){return Object.freeze(new a(t,e))}static fromJSON(t){return"string"==typeof t&&(t=JSON.parse(t)),a.create(t.address,t.meta||t.path)}get pathArray(){return i.a.fromString(this.meta.path||"m/0/0").toPathArray()}toJSON(){return{address:this.address,meta:this.meta}}toString(){return this.address}get[s](){return this.address}static isAddress(t){return"object"==typeof t&&(t instanceof a||"address"in t&&"meta"in t)}}a.util=o},function(t,e,n){"use strict";n.d(e,"default",function(){return g});var r=n(0),i=n.n(r),o=n(2),s=n.n(o),a=n(5),u=n(8),c=n(13);const{get:h,isPlainObject:l,isString:f}=s.a,d={aero:["failed","overdue","expired"],ch:["failed","overdue","expired"],chf:["failed","overdue","expired"],cic:["failed","overdue","expired"],cn:["failed","expired"],"inch-eth":["failed"],"inch-bsc":["failed"],"inch-matic":["failed"],cs:["failed","timeout"],csus:["failed","timeout"],sw:["failed","expired"],fa:["cancelled"],he:["failed","overdue","hold","expired"],fox:["failed","timeout","unknown"],ne:["canceled"],nrnb:["overdue","error"]},p={aero:["refunded"],ch:["refunded"],chf:["refunded"],cic:["refunded"],cn:["refunded"],cs:["refunded"],csus:["refunded"],sw:["refunded"],fa:["refunded"],he:["refunded"],fox:["cancelled"],ne:["refunded"],nrnb:["refunded"]},m=new Set(["optimistic-complete","potential-complete"]),y=Symbol("Order");class g{constructor(t,e){if(i()(e===y,"please use Order.fromJSON()"),this.orderId=t.orderId,i()("string"==typeof this.orderId,`orderId must be a string, received: ${this.orderId}`),void 0!==t.fromAmount&&!Object(a.isNumberUnit)(t.fromAmount))throw new Error("fromAmount must be of type: NumberUnit");if(void 0!==t.toAmount&&!Object(a.isNumberUnit)(t.toAmount))throw new Error("toAmount must be of type: NumberUnit");this.status=t.status||"",t.errorDetails&&(this.errorDetails=t.errorDetails),this.date=t.date?t.date instanceof Date?t.date:new Date(t.date):new Date,t.fromTxId&&(this.fromTxId=t.fromTxId),t.toTxId&&(this.toTxId=t.toTxId),t.txIds&&(this.txIds=t.txIds),t.fromAsset&&(this.fromAsset=String(t.fromAsset)),t.fromAmount&&(this.fromAmount=t.fromAmount),t.toAsset&&(this.toAsset=String(t.toAsset)),t.toAmount&&(this.toAmount=t.toAmount),this.fromWalletAccount=t.fromWalletAccount||c.default.DEFAULT_NAME,this.toWalletAccount=t.toWalletAccount||c.default.DEFAULT_NAME,t.svc||console.log(`${t.orderId} has no 'svc' field set.`),this.svc=t.svc||"ss",t.svcOptions&&(this.svcOptions=t.svcOptions),void 0!==t.message&&"null"!==t.message&&(this.message=t.message),"boolean"==typeof t.synced&&(this.synced=t.synced),"string"==typeof t.region&&(this.region=t.region),"string"==typeof t.displaySvc&&(this.displaySvc=t.displaySvc),this.toTxId=t.toTxId,this.potentialToTxIds=t.potentialToTxIds||[],this._version=1}static fromJSON(t){i()(t&&(f(t)||l(t)),"fromJSON: requires a string or a plain object"),"string"==typeof t&&(t=JSON.parse(t));const e=t.fromAmount?Object(u.deserialize)(t.fromAmount):void 0,n=t.toAmount?Object(u.deserialize)(t.toAmount):void 0;return new g({...t,fromAmount:e,toAmount:n},y)}inspect(){return`[Order ${this.orderId}]`}toJSON(){const t={...this,date:this.date.toISOString()};return t.fromAmount&&(t.fromAmount=Object(u.serialize)(t.fromAmount)),t.toAmount&&(t.toAmount=Object(u.serialize)(t.toAmount)),t._version=1,t}toJSONLegacy(){console.log("Order: calling deprecated function order.toJSONLegacy(), use orderToJSONLegacy() instead");const t={...this,date:this.date.toISOString()};return t.fromAmount&&(t.fromAmount=t.fromAmount.toString()),t.toAmount&&(t.toAmount=t.toAmount.toString()),delete t._version,t}toString(){return String(this.orderId)}update(t){return g.fromJSON({...this.toJSON(),...t})}get exodusStatus(){return"e2e-syncing"===this.status?"syncing":"complete-verified"===this.status?"complete":"failed-final"===this.status?"failed":h(p,this.svc,[]).includes(this.status)?"failed":"in-progress"}get error(){return!!h(d,this.svc,[]).includes(this.status)||(!!h(p,this.svc,[]).includes(this.status)||"failed-final"===this.status)}get finalized(){return["failed-final","complete-verified"].includes(this.status)}get floatingRate(){return"ch"===this.svc&&"complete-verified"!==this.status}get hasOptimisticStatus(){return m.has(this.status)}get exchangeApp(){return"ftx"===this.svc?"ftx":"exodus"}}},function(t,e,n){"use strict";n.d(e,"default",function(){return E});var r=n(35),i=n.n(r),o=n(2),s=n.n(o),a=n(0),u=n.n(a);const{isEqual:c,isNil:h,merge:l}=s.a,f="exodus",d="seed",p=["ftx"],m=["trezor","ledger"],y=[f,d],g=Object.freeze({exodus:"#7b39ff",seed:"#7b39ff",trezor:"#30d968",ledger:"#f5e400",ftx:"#00b4c2"}),v=Object.freeze({exodus:"exodus",seed:"exodus",trezor:"trezor",ledger:"trezor",ftx:"ftx"}),b=100,w=({source:t,index:e})=>0===e?(t=>t[0].toUpperCase()+t.slice(1))(t):"",_=t=>"string"==typeof t&&/^#[\dA-Fa-f]{3,6}$/.test(t),S=["id","source","index","isMultisig"];class E{constructor({source:t,index:e,id:n,label:r,model:o,lastConnected:s,is2FA:a,color:c,icon:l,compatibilityMode:m,seedId:S,enabled:E=!0,isMultisig:I=!1}){this.source=void 0,this.index=void 0,this.id=void 0,this.label=void 0,this.model=void 0,this.lastConnected=void 0,this.is2FA=void 0,this.color=void 0,this.icon=void 0,this.enabled=void 0,this.seedId=void 0,this.compatibilityMode=void 0,this.isMultisig=void 0;const T=p.includes(t),A=y.includes(t);if(u()(t,'expected "source" for a wallet account'),u()(!(null==e&&!T),'expected "index" for a wallet account'),u()(n||A,'expected option "id" for a non-software wallet account'),u()(!A||!n,'unexpected option "id" for a software wallet account'),u()(!(A&&s),'unexpected option "lastConnected" for a software wallet account'),u()(!m||!T,"compatibilityMode can not be provided for custodial wallet accounts"),u()(!A||!o,'unexpected option "model" for a software wallet account'),u()(t===f||!a,"is2FA: true is only valid for an exodus walletAccount"),u()(t!==d||S,'expected option "seedId" for seed wallet account'),c=c||g[t],l=l||v[t],(r=r||w({source:t,index:e})).length>b&&(r=r.slice(0,b)),!_(c))throw new Error('expected "color" to be a hex string');if("string"!=typeof l||0===l.length)throw new Error('expected "icon" to be a non-empty string');return this.source=t,this.index=h(e)?null:e,this.id=n,this.seedId=S,this.label=r||"",this.model=o,this.lastConnected=s,this.is2FA=a,this.color=c,this.icon=l,this.enabled=E,this.compatibilityMode=null!=m?m:this.isHardware?this.source:void 0,this.isMultisig=I,i()(this)}toString(){return[this.source,this.index,...this.source===d?[this.seedId,this.compatibilityMode]:[this.id]].filter(t=>null!=t).join("_")}toJSON(){const t={source:this.source,index:this.index,label:this.label,model:this.model,lastConnected:this.lastConnected,is2FA:this.is2FA,color:this.color,icon:this.icon,enabled:this.enabled,compatibilityMode:this.compatibilityMode,seedId:this.seedId,isMultisig:this.isMultisig};return null!=this.id&&(t.id=this.id),t}equals(t){return this===t||c(this.toJSON(),t.toJSON())}update(t){t instanceof E&&(t=t.toJSON());const e=this.toJSON();return Object.keys(t).every(n=>c(e[n],t[n]))?this:(S.forEach(e=>{if(t[e]&&t[e]!==this[e])throw new Error(`property "${e}" is immutable`)}),new E(l({},e,t)))}get isSoftware(){return y.includes(this.source)}get isHardware(){return m.includes(this.source)}get isCustodial(){return p.includes(this.source)}static get DEFAULT_NAME(){return E.DEFAULT.toString()}static get DEFAULT(){return new E({source:f,index:0})}static defaultWith(t){return new E({...E.DEFAULT,...t})}}E.LABEL_MAX_LENGTH=b,E.DEFAULT_COLORS=g,E.DEFAULT_ICONS=v,E.EXODUS_SRC=f,E.SEED_SRC=d,E.TREZOR_SRC="trezor",E.LEDGER_SRC="ledger",E.FTX_SRC="ftx"},function(t,e,n){const r=n(127),i=n(33),o=n(126),{isEqual:s,pick:a,once:u,merge:c}=n(2),h=n(75),l=n(125),f=n(124),{wait:d,awaitMax:p}=n(29),m=n(49),y=n(118),g=n(117),{blobToBuffer:v,bufToHex:b,objToBase64:w}=n(74),_=n(36),{doAuthentication:S,doAuthenticationChallenge:E,fetchToken:I,authenticatedFetch:T,authenticatedPost:A,authenticatedPut:N,getCurrentAuthToken:C}=n(116),{encryptSecretJSON:O,decryptSecretJSON:D}=n(73),k=t=>(...e)=>console.debug(`[${t}]`,...e),M=t=>t.docChanges().filter(t=>"added"===t.type);class x extends r{constructor(t,e,n){if(super(),this._debug=k(`exodus:e2e:firestore-sync:channel:${e}`),this.options=n||{},!e)throw new Error("must specify channel key");this.firebase=t.firebase,this.keys=t.keys,this.uid=t.uid,this.db=t.db,this.sodium=t.sodium,this.user=t.user,this.encryptSecretJSON=this.options.unencrypted?w:t.encryptSecretJSON.bind(t),this.decryptSecretJSON=this.options.unencrypted?JSON.parse:t.decryptSecretJSON.bind(t),this.doc=t.doc.collection("channels").doc(e),this.collection=this.doc.collection("channelData"),this.key=e,this.sync=t,this.push=o(this._push.bind(this),{concurrency:1}),this.initializedPromise=new Promise((t,e)=>{this._init={resolve:t,reject:e}}),this.initializedPromise.catch(t=>console.log("failed to initialize channel",t.stack)),this._paginating=!1,this.setMaxListeners(1/0)}async initialize(){try{await this._initialize(),this._init.resolve()}catch(t){throw this._init.reject(t),t}}async _initialize(){await this.initializeChannelDoc(),this.since=this.options.getSince?await Promise.resolve(this.options.getSince(this)):this.options.since,void 0===this.since&&(this.since=this.latest),this.since=Math.min(this.since,this.latest),this.latestProcessed=this.since}async getLatest(){const t=await this.doc.get();let e;return t.exists&&(e=t.data().latestSequence),e||0}async initializeChannelDoc(){this.latest=await this.getLatest()}async _push(t){const e={value:(await this.encryptSecretJSON(t,this.keys.secret)).toString("base64")},{sequence:n}=await this.sync.authenticatedPost(`db/${this.uid}/channels/${this.key}`,e);this.latest=n,this._debug("pushed",n,t)}async get(t){const e=await this.collection.doc(t.toString()).get();this._debug("get",t);const n=v(e.data().encrypted);return this.decryptSecretJSON(n,this.keys.secret)}onData(t){this._onData=t}subscribe(t){this.paginate(t)}async paginate({pageSize:t=100,startAfter:e=this.since,retryDelay:n=1e4}={}){if("function"!=typeof this._onData)throw new Error("use onData first to specify a data handler");if(!this._paginating){for(this._paginating=!0,this._debug(`paginating after ${this.since}`);this._paginating;){try{await this._processPage({pageSize:t,startAfter:e})}catch(t){if(!this._paginating)break;this._debug("failed to process page, taking a breather",t.message),await p(this.awaitUnsubscribed(),n);continue}e=this.since}this._debug("stopped paginating")}}async _processPage({pageSize:t,startAfter:e}){const n=new Promise((n,r)=>{this._syncUnsubscribe=this.collection.orderBy("sequence","asc").startAfter(e).limit(t).onSnapshot(async t=>{if(M(t).length)try{this._unsubscribeFromPage(),await this.decryptSnapshot(t),n()}catch(t){r(t)}},r),this._syncUnsubscribe=u(this._syncUnsubscribe.bind(this))});try{await n}finally{this._unsubscribeFromPage()}}async decryptSnapshot(t){let e=await Promise.all(M(t).map(async t=>{const e=t.doc.data();try{const t=v(e.encrypted);return{data:await this.decryptSecretJSON(t,this.keys.secret),sequence:e.sequence}}catch(t){console.error("Decryption error",t)}}));e=e.filter(t=>t);for(const{data:t,sequence:n}of e)this.emit("sync",t,n),n>this.latest&&(this.latest=n),n>this.since&&(this.since=n);const n=e.length?e[e.length-1].sequence:this.since;if(e.length){this._debug("synced",n);const t=e.map(({data:t})=>t);await this._onData(t,n)}for(const{data:t,sequence:n}of e)this.latestProcessed=n,this.emit("processed",t,n)}unsubscribe(){this._debug("unsubscribed"),this._paginating=!1,this._unsubscribeFromPage(),this.emit("unsubscribe")}_unsubscribeFromPage(){this._syncUnsubscribe&&(this._syncUnsubscribe(),this._syncUnsubscribe=void 0)}async awaitUnsubscribed(){return new Promise(t=>this.once("unsubscribe",t))}async awaitSynced(){if(await this.initializedPromise,await this.getLatest()!==this.since)return new Promise(t=>{const e=async()=>{await Promise.resolve(),this.since>=this.latest&&(t(),this.removeListener("sync",e))};this.on("sync",e)})}async awaitProcessed(){if(await this.initializedPromise,await this.getLatest()!==this.latestProcessed)return new Promise(t=>{const e=()=>{this.latestProcessed===this.latest&&(t(),this.removeListener("processed",e))};this.on("processed",e)})}}t.exports=class extends r{constructor(t,e,n,{platform:r,analyticsUserId:s}={}){super(),this._debug=k("exodus:e2e:firestore-sync"),this.firebase=t,this.keys=n,this.uid=b(this.keys.box.publicKey),this.db=this.firebase.firestore(),this.doc=this.db.collection("Users").doc(this.uid),this.sodium=e,this.channels={};const a={};r&&(a["x-exodus-platform"]=r),s&&(a["x-exodus-analytics-user-id"]=s);const u=i(this.firebase.ENDPOINT);this.fetch=((t,e)=>u(t,c({},{headers:a},e))),this.updateProfile=o(this.updateProfile.bind(this),{concurrency:1}),this.mergeProfileProps=o(this.mergeProfileProps.bind(this),{concurrency:1}),this.set=o(this.set.bind(this),{concurrency:1}),this._syncUnsubscribe=void 0,this.authenticate=f(this._authenticate.bind(this)),this._authenticated=new Promise(t=>{this._resolveAuthenticated=t});const h={doAuthentication:S,doAuthenticationChallenge:E,fetchToken:I,authenticatedFetch:T,authenticatedPost:A,authenticatedPut:N,getCurrentAuthToken:C,encryptSecretJSON:O,decryptSecretJSON:D};Object.assign(this,h)}async _authenticate(){this._debug("authenticate",this.uid),this.user=await this.doAuthentication(),this._resolveAuthenticated()}async awaitAuthenticated(){return this._authenticated}async channel(t,e){let n=this.channels[t];if(n)return await n.initializedPromise,n;n=new x(this,t,e),this.channels[t]=n;try{await n.initialize()}catch(e){throw delete this.channels[t],e}return n}async set(t,e,n){let r;t=JSON.parse(h.stringify(t));const i=new Promise(t=>{r=t,this.once("profile-update",r)});await this.authenticatedPut(`db/${this.uid}`,{props:t,opts:e},n),await Promise.race([i,d(1e3)]),this.removeListener("profile-update",r)}async recordEvent(t,e){await this.authenticatedPut(`db/${this.uid}/events/${t}`,e)}async recordLogin(t){await this.recordEvent("login",t)}async logout(){this._authenticated=new Promise(t=>{this._resolveAuthenticated=t}),this.unsubscribe(),Object.keys(this.channels).forEach(t=>{this.channels[t].unsubscribe()}),await this.firebase.auth().signOut(),this._debug("logged out")}async reauthenticate(){for(;;)try{this._debug("reauthenticating");const t=!!this._syncUnsubscribe;return await this.logout(),await this.authenticate(),t&&this.subscribe(),void Object.values(this.channels).forEach(t=>t.subscribe())}catch(t){this._debug("reauthentication failed, will try again",t.message),await d(1e4)}}async _toEncryptedBuffer(t){return this.encryptSecretJSON(t,this.keys.secret)}async mergeProfileProps(t,e,n){if(t.private){const{private:n={}}=e||await this.getProfile(),r=_(n,t.private);t={...t,private:await this._toEncryptedBuffer(r)}}await this.set(t,{merge:!0},n)}async getProfile(){const t=await this.authenticatedFetch(`db/${this.uid}`,{method:"get"})||{};return t.private?t.private=await this._decryptPrivateProfile(t.private):t.private={},t}async updateProfile(t){const e=await this.getProfile(),n=await Promise.resolve(t(e)),r=Object.keys(n).filter(t=>!s(e[t],n[t]));if(r.length){const t=_(a(e,r),a(n,r));return await this.mergeProfileProps(t,e),_(e,n)}return e}async subscribe(){this._syncUnsubscribe||(this._syncUnsubscribe=this.doc.onSnapshot(this._onProfileSnapshot.bind(this),(async t=>{this._debug("onSnapshot error",t),await this.reauthenticate(),await d(15e3),this.subscribe()}).bind(this)))}unsubscribe(){this._syncUnsubscribe&&(this._syncUnsubscribe(),this._syncUnsubscribe=void 0)}async _onProfileSnapshot(t){const e=t.exists?t.data():{};e.private&&(e.private=await this._decryptPrivateProfile(e.private)),this.emit("profile-update",e)}async _decryptPrivateProfile(t){try{const e="string"==typeof t?Buffer.from(t,"base64"):v(t);return await this.decryptSecretJSON(e,this.keys.secret)}catch(t){return console.warn("failed to decrypt profile.private",t),{}}}},t.exports.createPairer=((...t)=>new m(...t)),t.exports.createPairerForSender=y,t.exports.createPairerForRecipient=g,t.exports.processChannel=l,t.exports.firestoreDocumentMerge=_},function(t,e,n){"use strict";n.d(e,"ORDER_TYPES",function(){return r}),n.d(e,"STATUS_MAP",function(){return T});const r={__proto__:null,buy:"buy",sell:"sell"},i="complete",o="failed",s="in-progress",a="blockchain",u="moonpay",c="onramper",h="paypal",l="ramp",f="sardine",d="completed",p="failed",m="COMPLETED",y="FAILED",g="EXPIRED",v="RELEASED",b="Complete",w="Expired",_="COMPLETED",S="FAILED",E="completed",I="failed",T={__proto__:null,[a]:{__proto__:null,[i]:[_],[o]:[S],[s]:["PENDING","WITHDRAWING"]},[c]:{__proto__:null,[i]:[E],[o]:[I,"canceled"],[s]:["new","paid","pending"]},[u]:{__proto__:null,[i]:[d],[o]:[p],[s]:["waitingPayment","pending","waitingAuthorization","waitingForDeposit"]},[h]:{__proto__:null,[i]:[m],[o]:[y],[s]:["PENDING"],["initiated"]:["INITIATED"]},[l]:{__proto__:null,[i]:[v],[o]:["CANCELLED",g,"PAYMENT_FAILED","REVIEW_REJECTED"],[s]:["FIAT_RECEIVED","FIAT_SENT","INITIALIZED","PAYMENT_EXECUTED","PAYMENT_IN_PROGRESS","PAYMENT_STARTED","RELEASING"]},[f]:{__proto__:null,[i]:[b],[o]:["Declined",w],[s]:["Draft","UserCustody","Processed"]}}},function(t,e,n){"use strict";n.d(e,"unitTypeToJSON",function(){return c});n(0);var r=n(2),i=n.n(r);const{mapValues:o,uniqBy:s,isEmpty:a,isArray:u}=i.a,c=t=>o(t.units,t=>t.power)},function(t,e,n){"use strict";n.d(e,"default",function(){return o});const r=["parse","equals","toJSON"],i=["units","baseUnit","defaultUnit","ZERO"];function o(t){return null!=t&&("object"==typeof t&&(i.every(e=>e in t)&&r.every(e=>"function"==typeof t[e])))}},function(t,e,n){"use strict";n.d(e,"default",function(){return m});var r=n(5),i=n(0),o=n.n(i),s=n(2),a=n.n(s),u=n(15),c=n(8);n(52);function h(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var l=0;const{isEqual:f}=a.a,d=Symbol("FiatOrder");var p="__private_"+l+++"_"+"matches";class m{constructor(t,e){Object.defineProperty(this,p,{value:y}),m.validate(t,e),Object.assign(this,t),"complete"===this.exodusStatus&&this.errorMessage&&(console.log("ignoring error given error complete"),delete this.errorMessage)}get exodusStatus(){const t=u.STATUS_MAP[this.provider],e=Object.entries(t).find(([,t])=>t.includes(this.status));return e?e[0]:"in-progress"}get error(){return!!this.errorMessage}get isBuy(){return"buy"===this.orderType}get isSell(){return"sell"===this.orderType}get cryptoAmount(){return this.isBuy?this.toAmount:this.fromAmount}get cryptoAsset(){return this.isBuy?this.toAsset:this.fromAsset}get txIds(){return this.txId?[this.txId]:[]}static fromJSON(t){const e=t.orderType===u.ORDER_TYPES.buy;return new m({...t,date:t.date instanceof Date?t.date:new Date(t.date),...e?{toAmount:Object(c.deserialize)(t.toAmount)}:{fromAmount:Object(c.deserialize)(t.fromAmount)}},d)}equals(t){const e=new Set(Object.keys(t)),n=new Set(Object.keys(this.toJSON()));return!!(n.size===e.size&&[...n].every(t=>e.has(t)))&&h(this,p)[p](t)}inspect(){return`[${this.constructor.name} ${this.orderId}]`}toJSON(){return{...this,date:this.date.toISOString(),...this.isBuy?{toAmount:Object(c.serialize)(this.toAmount)}:{fromAmount:Object(c.serialize)(this.fromAmount)}}}toString(){return this.orderId}update(t){return h(this,p)[p](t)?this:m.fromJSON({...this.toJSON(),...t})}}function y(t){return Object.keys(t).every(e=>{const n=t[e];return n instanceof Date?this[e].toISOString()===n.toISOString():Object(r.isNumberUnit)(n)?null==(i=this[e])?void 0:i.equals(n):f(this[e],t[e]);var i})}m.validate=((t,e)=>{o()(e===d,"please use Order.fromJSON()"),o()("string"==typeof t.orderId,'expected string "orderId"'),o()(["buy","sell"].includes(t.orderType),'expected "orderType" of value "buy" | "sell"'),o()("string"==typeof t.provider&&u.STATUS_MAP[t.provider],"invalid provider"),o()("string"==typeof t.status,'expected string "status"'),o()("string"==typeof t.fromAddress||null===t.fromAddress,'expected string or null "fromAddress"'),o()("string"==typeof t.fromWalletAccount||null===t.fromWalletAccount,'expected string or null "fromWalletAccount"'),o()("number"==typeof t.fromAmount||t.fromAmount instanceof r.default,'expected number or NumberUnit "fromAmount"'),o()("string"==typeof t.fromAsset,'expected string "fromAsset"'),o()("string"==typeof t.toAddress||null===t.toAddress,'expected string or null "toAddress"'),o()("string"==typeof t.toWalletAccount||null===t.toWalletAccount,'expected string or null "toWalletAccount"'),o()("number"==typeof t.toAmount||t.toAmount instanceof r.default,'expected number or NumberUnit "toAmount"'),o()("string"==typeof t.toAsset,'expected string "toAsset"'),o()("number"==typeof t.fiatValue,'expected number "fiatValue"'),o()("number"==typeof t.providerRate,'expected number "providerRate"'),o()("number"==typeof t.exodusRate,'expected number "exodusRate"'),void 0!==t.feesWereSubsidized&&o()("boolean"==typeof t.feesWereSubsidized,'expected boolean "feesWereSubsidized"'),t.errorMessage&&o()("string"==typeof t.errorMessage,'expected string "errorMessage"'),t.fees&&o()("object"==typeof t.fees,'expected object "fees"'),void 0!==t.hideInHistory&&o()("boolean"==typeof t.hideInHistory,'expected boolean "hideInHistory"'),null!=t.supportMessage&&o()("string"==typeof t.supportMessage,'expected string "supportMessage"'),void 0!==t.showedFailureBanner&&o()("boolean"==typeof t.showedFailureBanner,'expected boolean "showedFailureBanner"')})},function(t,e,n){"use strict";n.d(e,"orderFromJSONLegacy",function(){return l}),n.d(e,"orderToJSONLegacy",function(){return f});var r=n(0),i=n.n(r),o=n(2),s=n.n(o),a=n(5),u=n(12);const{isPlainObject:c,isString:h}=s.a,l=(t,{assets:e})=>{if(i()(h(t)||c(t),"fromJSONLegacy: requires a string or a plain object"),h(t)&&(t=JSON.parse(t)),t._version)return u.default.fromJSON(t);i()(e,"fromJSONLegacy(): assets is required to parse legacy Order");const{fromAsset:n,toAsset:r}=t,o=t.fromAmount?d({amount:t.fromAmount,asset:e[n]}):void 0,s=t.toAmount?d({amount:t.toAmount,asset:e[r]}):void 0;return u.default.fromJSON({...t,fromAmount:o,toAmount:s})},f=t=>{i()(t&&t instanceof u.default,"toJSONLegacy: requires an Order");const e={...t,date:t.date.toISOString()};return e.fromAmount&&(e.fromAmount=e.fromAmount.toDefaultString({unit:!0})),e.toAmount&&(e.toAmount=e.toAmount.toDefaultString({unit:!0})),delete e._version,e},d=({asset:t,amount:e})=>Object(a.isNumberUnit)(e)?e:t?t.currency.parse(e):void 0},function(t,e,n){"use strict";function r(t){return null!=t&&("object"==typeof t&&("_number"in t&&"unit"in t&&"unitType"in t&&"baseUnit"in t))}n.d(e,"default",function(){return r})},function(t,e,n){"use strict";n.d(e,"default",function(){return u});var r=n(12),i=n(0),o=n.n(i);const s=Symbol("OrderSet"),a=({items:t})=>new u({items:t,initSymbol:s});class u{constructor({items:t,initSymbol:e}){o()(e===s,"please use OrderSet.EMPTY or OrderSet.fromArray()"),o()(t instanceof Map,"items must be a Map");const n=[...t.values()];n.sort((t,e)=>e.date-t.date);const r=new Map;for(const t of n)t.txIds&&t.txIds.forEach(({txId:e})=>{h(r,e,t.orderId)}),h(r,t.fromTxId,t.orderId),h(r,t.toTxId,t.orderId);this._items=new Map(n.map(t=>[String(t),t])),this._txMap=r,this._sortOrder=n.map(t=>t.orderId)}static fromArray(t){return null==t?u.EMPTY:a({items:new Map(t.map(c).map(t=>[String(t),t]))})}add(t){return this.addBulk([t])}addBulk(t){if(!t)return this;for(const e of t)this.get(e)&&console.log("OrderSet#add() already has #{item.orderId}");return a({items:new Map([...this._items.values(),...t].map(t=>[String(t),t]))})}clone(){return a({items:new Map(this._items)})}delete(t){const e=this.get(t);if(!e)return this;const n=new Map(this._items);return n.delete(e.orderId),a({items:n})}equals(t){if(this._sortOrder.length!==t._sortOrder.length)return!1;const e=this._sortOrder.length;for(let n=0;n<e;++n)if(this._sortOrder[n]!==t._sortOrder[n])return!1;return!0}get(t){return this._items.get(String(t))}getAt(t){return this.get(this._sortOrder[t])}getByTxId(t,e=0){const n=this._txMap.get(t)||[];return this._items.get(n[e])}getAllByTxId(t){return(this._txMap.get(t)||[]).map(t=>this._items.get(t))}has(t){return this._items.has(String(t))}toJSON(){return[...this].map(t=>t.toJSON())}filter(t){return u.fromArray([...this].filter(t))}toJSONLegacy(){return console.log("OrderSet: calling deprecated function orderSet.toJSONLegacy(), use orderSetToJSONLegacy() instead"),[...this].map(t=>t.toJSONLegacy())}union(t){const e=[...[...this],...[...t]];return u.fromArray(e)}update(t){const e=new Map(this._items);for(const n of t){const t=e.get(String(n));t?e.set(String(n),t.update(n)):console.log("OrderSet#update() order does not contain an `orderId`. Skipping...")}return a({items:e})}[Symbol.iterator](){return this._items.values()}get size(){return this._items.size}}function c(t){return t instanceof r.default?t:r.default.fromJSON(t)}function h(t,e,n){if(e){const r=t.get(e)||[];if(r.includes(n))return;t.set(e,[...r,n])}}u.EMPTY=a({items:new Map})},function(t,e,n){"use strict";n.d(e,"default",function(){return b});var r=n(0),i=n.n(r),o=n(35),s=n.n(o),a=n(2),u=n.n(a),c=n(5),h=n(9),l=n(16);const{isEqual:f,isEmpty:d,isString:p,merge:m,omit:y,mapValues:g}=u.a,v=Symbol("Tx");class b{constructor({json:t,initSymbol:e}){const{txId:n,error:r,date:o,confirmations:s,dropped:a,coinAmount:u,coinName:l,feeAmount:f,feeCoinName:m,selfSend:y,from:b,to:_,meta:S,data:E,tokens:I,token:T,addresses:A,currencies:N}=t;i()(e===v,"Tx: please use Tx.fromJSON()."),i()(!d(N),"Tx: `currencies` is required"),i()(!b||Array.isArray(b),"Tx: `from` has to be an array."),i()(!_||p(_),"Tx: `to` has to be a string."),i()(!I||Array.isArray(I),"Tx: `tokens` has to be an array."),i()(!A||Array.isArray(A)||A instanceof h.default,"Tx: unknown `addresses` type"),i()(!u||l,"Tx: `coinName` is required with `coinAmount`"),i()(!f||m,"Tx: `feeCoinName` is required with `feeAmount`"),this.currencies=g(N,t=>t instanceof c.UnitType?t:c.UnitType.create(t)),this.txId=n,this.error=r||null,this.date=o?new Date(o):new Date,this.confirmations="number"==typeof s?s:-1,void 0!==a&&(this.dropped=!!a&&this.confirmations<=0),u&&(i()(this.currencies[l],`Tx: currency for ${l} missing`),this.coinAmount=w(u,this.currencies[l]),this.coinName=l),f&&(i()(this.currencies[m],`Tx: currency for ${m} missing`),this.feeAmount=w(f,this.currencies[m]),this.feeCoinName=m),this.selfSend=y||!1,this.from=b||[],_&&(this.to=_),this.tokens=I||(T?[T]:[]),this.data=E||{},this.meta=S?{...S}:{},this.addresses=Array.isArray(A)?h.default.fromArray(A):A instanceof h.default?A:h.default.EMPTY,this.version=1}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,n=new b({json:e,initSymbol:v});return s()(n)}clone(){return b.fromJSON(this)}equals(t){return this===t||f(this.toJSON(),t.toJSON())}toJSON(){const t={...this};return this.coinAmount&&(t.coinAmount=this.coinAmount.toDefaultString({unit:!0})),this.feeAmount&&(t.feeAmount=this.feeAmount.toDefaultString({unit:!0})),t.date=t.date.toISOString(),this.addresses&&(t.addresses=[...this.addresses].map(t=>t.toJSON()),0===t.addresses.length&&delete t.addresses),t.selfSend||delete t.selfSend,0===t.from.length&&delete t.from,0===Object.keys(t.data).length&&delete t.data,t.error||delete t.error,0===Object.keys(t.meta).length&&delete t.meta,0===t.tokens.length&&delete t.tokens,t.currencies=g(this.currencies,l.unitTypeToJSON),t}toString(){return String(this.txId)}update(t){const e=this.toJSON();return t=y(t,["version"]),Object.keys(t).every(n=>f(e[n],t[n]))?this:b.fromJSON(m({},e,t))}get accepted(){return(this.received||this.sent&&this.confirmations>=0)&&!this.dropped}get confirmed(){return this.confirmations>0}get pending(){return this.confirmations<=0&&!this.dropped}get failed(){return this.error||this.dropped}get sent(){return!!(this.coinAmount.isNegative||this.to||this.selfSend)}get received(){return!this.sent}get token(){return this.tokens[0]||null}}function w(t,e){return i()(e instanceof c.UnitType,"Currency must be an instance of UnitType"),Object(c.isNumberUnit)(t)?t:e.parse("string"==typeof t?t:t.value+" "+t.unit)}},function(t,e,n){"use strict";n.d(e,"CHANNEL_PREFIX",function(){return r});const r="electron-rpc-broadcast"},function(t,e,n){"use strict";
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(109);e.u8=(t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength));function i(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}e.u32=(t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)));e.createView=(t=>new DataView(t.buffer,t.byteOffset,t.byteLength));if(e.rotr=((t,e)=>t<<32-e|t>>>e),e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));e.bytesToHex=function(t){if(!i(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=o[t[n]];return e};const s={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function a(t){return t>=s._0&&t<=s._9?t-s._0:t>=s._A&&t<=s._F?t-(s._A-10):t>=s._a&&t<=s._f?t-(s._a-10):void 0}e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let e=0,i=0;e<n;e++,i+=2){const n=a(t.charCodeAt(i)),o=a(t.charCodeAt(i+1));if(void 0===n||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}r[e]=16*n+o}return r};function u(t){if("string"!=typeof t)throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array((new TextEncoder).encode(t))}function c(t){if("string"==typeof t&&(t=u(t)),!i(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}e.nextTick=(async()=>{}),e.asyncLoop=async function(t,n,r){let i=Date.now();for(let o=0;o<t;o++){r(o);const t=Date.now()-i;t>=0&&t<n||(await(0,e.nextTick)(),i+=t)}},e.utf8ToBytes=u,e.toBytes=c,e.concatBytes=function(...t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];if(!i(r))throw new Error("Uint8Array expected");e+=r.length}const n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n};e.Hash=class{clone(){return this._cloneInto()}};const h={}.toString;e.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==h.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(c(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(()=>t()),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(c(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(e=>t(e)),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(c(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=(e=>t(e)),e},e.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}},function(t,e,n){"use strict";n.d(e,"serialize",function(){return l}),n.d(e,"deserialize",function(){return f});var r=n(2),i=n.n(r),o=n(5),s=n(27),a=n(34);const{mapValues:u}=i.a,c=t=>u(t.units,t=>t.power),h=[{type:"numberunit",test:t=>t instanceof o.default,serialize:t=>({v:t.toString(),u:c(t.unitType)}),deserialize:t=>o.UnitType.create(t.u).parse(t.v)},{type:"utxocollection",test:t=>t instanceof s.default,serialize:t=>({v:t.toJSON(),u:c(t.currency)}),deserialize:t=>s.default.fromJSON(t.v,{currency:o.UnitType.create(t.u)})}],{serialize:l,deserialize:f}=Object(a.default)(h)},function(t,e,n){"use strict";n.d(e,"default",function(){return c});var r=n(0),i=n.n(r),o=n(2),s=n.n(o);const{isEqual:a,set:u}=s.a;class c{constructor(t={}){i()("string"==typeof t.txId,`expected "txId", received: ${t.txId}`),Object.assign(this,t),this.txId=t.txId,this.message=t.message||""}static fromJSON(t){return"string"==typeof t&&(t=JSON.parse(t)),new c(t)}toJSON(){const t={...this};if(this.sends){t.sends={};for(const[e,n]of Object.entries(this.sends))t.sends[e]={...n}}return t}toString(){return String(this.txId)}equals(t){return!!t&&(this===t||a(this.toJSON(),t.toJSON()))}update(t){if((t=h(t)).txId&&t.txId!==this.txId)throw new Error('"txId" cannot be changed once it is set');const e=this.toJSON();return Object.keys(t).every(n=>a(e[n],t[n]))?this:c.fromJSON({...e,...t})}getMessage({to:t}={}){if(t&&this.sends){const e=Object.entries(this.sends);for(const[n,{message:r}]of e)if(n.toLowerCase()===t.toLowerCase()&&r)return r}return this.message||""}setMessage({to:t,message:e}){if(i()("string"==typeof e,'expected string "message"'),!t)return this.update({message:e});const n=this.toJSON();l({personalNote:n,to:t});const r=u(n,["sends",t,"message"],e);return this.update(r)}}const h=t=>t instanceof c?t.toJSON():t,l=({personalNote:t,to:e})=>{delete t.message,t.sends&&Object.keys(t.sends||{}).forEach(n=>{const r=n.toLowerCase();n!==r&&r===e&&u(t,["sends",n,"message"],null)})}},function(t,e,n){"use strict";n.d(e,"default",function(){return g});var r=n(0),i=n.n(r),o=n(11),s=n(9),a=n(5),u=n(2),c=n.n(u);const{differenceBy:h,groupBy:l,isEqual:f,sortBy:d,uniq:p,uniqBy:m}=c.a;var y=Symbol.iterator;class g{constructor({currency:t}={}){this[y]=function*(){const t=this.toArray();for(const e of t)yield e},this.currency=t,this._data=null}static createEmpty(t){return g.fromArray([],t)}static fromArray(t,{addressMap:e,...n}={}){const r=n.currency||function(t){if(!Array.isArray(t))return;for(const e of t)if("object"==typeof e.value&&e.value.unitType)return e.value.unitType}(t);null==r&&null==t?console.warn("UtxoCollection.fromArray(): both currency and utxoArray are null."):null==r&&0===t.length&&console.warn("UtxoCollection.fromArray(): currency is null and utxoArray has zero items.");const s=(t=m(t,t=>`${t.txId}:${t.vout}`)).map(t=>(i()(t.address,"utxo.address must be provided"),i()(t.address instanceof o.default||e,"Must pass addressMap if utxo.address is not of type Address"),t.address=t.address instanceof o.default?t.address:e[t.address],{...t,value:Object(a.isNumberUnit)(t.value)?t.value:r.parse(t.value)}));var u=new g({currency:r});return u._data=Object.freeze(l(s,t=>t.address.toString())),u}static fromJSON(t,{currency:e}){"string"==typeof t&&(t=JSON.parse(t));const n={};Object.keys(t).forEach(r=>{const i=new o.default(t[r].address,{path:t[r].path}),s=d(t[r].utxos,t=>e.parse(t.value).toDefaultNumber());n[r]=s.map(t=>({...t,address:i,value:e.parse(t.value)}))});const r=new g({currency:e});return r._data=Object.freeze(n),r}clone(){return g.fromArray(this.toArray(),{...this})}equals(t){return f(this.toJSON(),t.toJSON())}difference(t){const e=t=>{const e={};return t.toArray().forEach(t=>{const n=`${t.txId}/${t.vout}`;e[n]=t}),e},n=e(this),r=e(t),i=[];return Object.keys(n).forEach(t=>{r[t]||i.push(n[t])}),g.fromArray(i,{...this})}getAddressUtxos(t){return i()(t.toString()in this._data,`${t} is not present in this UTXO collection`),g.fromArray(this._data[t],{...this})}getTxIdUtxos(t){var e=this.toArray().filter(e=>e.txId===t);return g.fromArray(e,{...this})}getAddressesForTxId(t){const e=this.toArray().filter(e=>e.txId===t).map(t=>t.address);return s.default.fromArray(e)}getAddressPathsMap(){return[...this.addresses].reduce((t,e)=>Object.assign(t,{[e.toString()]:e.meta.path}),{})}hasAddressUtxos(t){return String(t)in this._data}inspect(){return`<UtxoCollection size: ${this.size}, value: ${this.value.toString()}>`}isEmpty(){return null==this._data||0===Object.keys(this._data).length}merge(t){let e=this;for(const n of t.addresses)e=e.setAddressUtxos(n,t.getAddressUtxos(n));return e}removeAddressUtxos(t){const e={...this._data};delete e[t.toString()];const n=new g({...this});return n._data=Object.freeze(e),n}select(t,e){const n=g.createEmpty({currency:this.currency});if(t.gt(this.value))return[n,this.clone()];const r=(t,e)=>{let r=n,i=n;if(0===t.size)return[r,i];const o="BTC"===e.defaultUnit.unitName?d(t.toArray(),t=>!t.confirmations,t=>t.value.toDefaultNumber()):d(t.toArray(),t=>t.value.toDefaultNumber()),s=[];let a=o[0].value.unitType.ZERO;for(const n of o)if(s.push(n),(a=a.add(n.value)).gte(e))return[r=g.fromArray(s,{...this}),i=t.difference(r)];return[r=g.fromArray(s,{...this}),i=t.difference(r)]};let[i,o]=r(this,t);const s=e({inputs:i}),a=t.add(s);if(a.gt(i.value)){if(!a.lte(this.value))return[n,this];{const t=e({inputs:o});if(a.add(t).gte(this.value))return[this,n];const[u,c]=r(o,s.add(t));o=c,i=i.union(u)}}return[i,o]}updateConfirmations(t){return g.fromArray(this.toArray().map(e=>{const n=t.find(t=>t.txId===e.txId);return n&&(e.confirmations=n.confirmations),e}),{...this})}addUtxo(t,e){return g.fromArray([...this.toArray(),t],{addressMap:e})}setAddressUtxos(t,e,{addressMap:n}={}){if(Array.isArray(e))return 0===e.length?this.removeAddressUtxos(t):g.fromArray(e,{...this,addressMap:n});if(i()(e instanceof g,"utxos must be an Array or UtxoCollection"),0===e.size)return this.removeAddressUtxos(t);const r={...this._data,[t.toString()]:e.toArray()},o=new g({...this});return o._data=Object.freeze(r),o}toArray(){return Object.values(this._data).flat()}toPriorityOrderedArray(t=!1){return d(this.toArray(),t=>!t.confirmations&&t.rbfEnabled,t=>!t.confirmations,e=>e.value.toDefaultNumber()*(t?-1:1))}toJSON(){const t={};return[...this.addresses].forEach(e=>{const n=e.toString(),r=d(this._data[n],t=>t.value.toDefaultNumber());t[n]={address:n,path:e.meta.path,utxos:r.map(t=>(delete(t={...t,value:t.value.toString()}).address,t))}}),t}union(t){const e=this.toArray(),n=t.toArray();return g.fromArray([...e,...n],{...this})}filter(t){return g.fromArray(this.toArray().filter(t),{...this})}unionOverwrite(t){const e=this.toArray(),n=t.toArray(),r=[...h(e,n,t=>`${t.txId}:${t.vout}`),...n];return g.fromArray(r,{...this})}get addresses(){if(this._addresses)return this._addresses;const t=[];return Object.entries(this._data).forEach(([e,n])=>{Array.isArray(n)&&0!==n.length&&t.push(n[0].address||o.default.create(e))}),0===t.length?(this._addresses=s.default.EMPTY,this._addresses):(t.sort(s.default.PATH_SORTER),this._addresses=s.default.fromArray(t),this._addresses)}get empty(){return null==this._data||0===Object.keys(this._data).length}get size(){return"number"==typeof this._size?this._size:(this._size=this.toArray().length,this._size)}get txIds(){return p(this.toArray().map(t=>t.txId))}get value(){return this._value?this._value:(this._value=this.toArray().reduce((t,e)=>t.add(e.value),this.currency.ZERO),this._value)}}},function(t,e,n){"use strict";let r;r=n(115),e.default=r},function(t,e){const n=t=>{let e,n;const r=new Promise(r=>{n=r,e=setTimeout(n,t)});return r.cancel=(()=>{clearTimeout(e),n()}),r};t.exports={wait:n,awaitMax:async(t,e)=>{const r=n(e);try{return await Promise.race([r,t])}finally{r.cancel()}}}},function(t,e,n){"use strict";n.d(e,"default",function(){return i});var r=n(17);function i(t,e,n,i={}){if(!Object(r.default)(t)||!Object(r.default)(e))throw new Error("Must pass in an instance of UnitType for ut1 and ut2.");const{unit1:o,unit2:s}={unit1:t.defaultUnit,unit2:e.defaultUnit,...i};if(!t[o])throw new Error(`unit1 (${o}) is not from ut1`);if(!e[s])throw new Error(`unit2 (${s}) is not from ut2`);return function(r){const i=r.unitType;if(i.equals(t)){const i=e.baseUnit(r._number).mul(e[s].multiplier).mul(n);return i._number=i._number.div(t[o].multiplier),i.to(s)}if(i.equals(e)){let i=t.baseUnit(r._number).mul(t[o].multiplier);try{i=i.div(n)}catch(e){if("Invalid division by 0"!==String(e.message))throw e;i=t.baseUnit(0)}return i._number=i._number.div(e[s].multiplier),i.to(o)}throw new Error("Conversion error")}}},function(t,e,n){"use strict";n.d(e,"default",function(){return h});var r=n(20),i=n(30),o=n(6),s=n(17),a=n(4),u=n(44);const c=a.default.wrap(10);class h{static create(t,e){return new h(t,e)}constructor(t,e){this._number=void 0,this.unit=void 0,this.unitType=void 0,this.baseUnit=void 0,this.defaultUnit=void 0,this.unitName=void 0,this.unit=e,this.unitType=e.unitType,this.baseUnit=e.unitType.baseUnit,this.defaultUnit=e.unitType.defaultUnit,this.unitName=this.unit.unitName,this._number=Object(u.createNumber)(t,e.power),Object.defineProperty(this,"_numberStringMap",{enumerable:!1,value:new Map,writable:!0})}abs(){return new h(this._number.abs(),this.unit)}add(t){return t=this._coerceToNumberUnit(t),Object(o.maybeReportDifferentTypesDeprecated)(this,t,"add"),t.isZero?this:this.isZero?new h(t._number,this.unit):new h(this._number.add(t._number),this.unit)}clampLowerZero(){const t=new h(0,this.unit);return this.gte(t)?this:t}clone(){return new h(this._number,this.unit)}equals(t){return Object(o.maybeReportDifferentTypesDeprecated)(this,t,"equals"),this._number.eq(t._number)}gt(t){return Object(o.maybeReportDifferentTypesDeprecated)(this,t,"gt"),this._number.gt(t._number)}gte(t){return Object(o.maybeReportDifferentTypesDeprecated)(this,t,"gte"),this._number.gte(t._number)}lt(t){return Object(o.maybeReportDifferentTypesDeprecated)(this,t,"lt"),this._number.lt(t._number)}lte(t){return Object(o.maybeReportDifferentTypesDeprecated)(this,t,"lte"),this._number.lte(t._number)}mul(t){if(h.isNumberUnit(t))throw new TypeError("NumberUnit.mul does not support NumberUnit as argument.");if(a.default.isUnderlyingInstance(t)&&(t=a.default.wrap(t)),null==t.isBigIntWrapper?void 0:t.isBigIntWrapper())return new h(this._number.mul(t),this.unit);const{number:e,fraction:n,fractionLength:r}=Object(u.stringToNumberFraction)(t,0),i="0"!==e&&"-0"!==e?this._number.mul(a.default.wrap(e)):a.default.wrap(0);if("0"!==n&&"-0"!==n){const t=a.default.wrap(n).mutateMul(this._number).div(c.pow(a.default.wrap(r)));i.mutateAdd(t)}return new h(i,this.unit)}div(t){if(h.isNumberUnit(t))throw new TypeError("NumberUnit.div does not support NumberUnit as argument.");if(a.default.isUnderlyingInstance(t))return new h(this._number.div(t),this.unit);const{number:e,fraction:n,fractionLength:r}=Object(u.stringToNumberFraction)(t,0),i=c.pow(a.default.wrap(r)),o=a.default.wrap(e).mutateMul(i).mutateAdd(a.default.wrap(n));if(o.isZero())throw new Error("Invalid division by 0");const s=this._number.mul(i).div(o);return new h(s,this.unit)}floor(){if(0===this.unit.power)return this;const t=this._toNumberString(),[e]=t.split(".");return new h(e,this.unit)}round(){if(0===this.unit.power)return this;const t=this._toNumberString(),[e,n]=t.split(".");let r=new h(e,this.unit);return n&&Math.round(Number.parseFloat(`0.${n}`))>0&&(r=r.add(new h(1,this.unit))),r}ceil(){if(0===this.unit.power)return this;const t=this._toNumberString(),[e,n]=t.split(".");let r=new h(e,this.unit);return n&&Math.ceil(Number.parseFloat(`0.${n}`))>0&&(r=r.add(new h(1,this.unit))),r}toFixed(t,e){const n=a.default.wrap(10).pow(a.default.wrap(t));let r=new h(this._number.mul(n),this.unit);switch(e){case"floor":r=r.floor();break;case"ceil":r=r.ceil();break;default:r=r.round()}return r=new h(r._number.div(n),this.unit)}negate(){return new h(this._number.negate(),this.unit)}sub(t){return t=this._coerceToNumberUnit(t),Object(o.maybeReportDifferentTypesDeprecated)(this,t,"sub"),t.isZero?this:this.isZero?new h(t._number.negate(),this.unit):new h(this._number.sub(t._number),this.unit)}cast(t){if(!Object(s.default)(t))throw new Error("unitType needs to be a UnitType instance");if(this.unitType.equals(t))return this.toBase();const e=t.baseUnit;let n=this._number;const r=this.unitType.defaultUnit.power,i=t.defaultUnit.power;if(n.isZero()||r===i)return new h(n,e);const o=c.pow(a.default.wrap(Math.abs(i-r),10));return r<i?n=n.mul(o):r>i&&(n=n.div(o)),new h(n,e)}toBase(){return 0===this.unit.power?this:new h(this._number,this.baseUnit)}toDefault(){return this.defaultUnit===this.unit?this:this.to(this.defaultUnit)}to(t,e){if(t===this.unit)return this;if("string"==typeof t&&(t=this.unitType.units[t]),this.unit.unitType.equals(t.unitType))return new h(this._number,t);if(!e)throw new Error("Incompatible unit types. Must specify a conversion.");if("function"==typeof e)return e(this);if(!this.unitType.equals(e.from.unitType))throw new Error("Conversion unit from is of different type.");const n=Number.parseFloat(e.toValue)/Number.parseFloat(e.fromValue);return Object(i.default)(e.from.unitType,e.to.unitType,n,{unit1:e.fromUnit,unit2:e.toUnit})(this)}toJSON(){return{value:this._toNumberString(),unit:this.unitName,unitType:this.unitType.toString(),type:"NumberUnit"}}toNumber(t){return Number.parseFloat(this._toNumberString(t))}toDefaultNumber(){return this.toNumber(this.defaultUnit)}toBaseNumber(){return this.toNumber(this.baseUnit)}toBaseBufferLE(t){return this._number.toBaseBufferLE(t)}toBaseBufferBE(t){return this._number.toBaseBufferBE(t)}toNumberString(t){return Object(o.default)("DEPRECATION WARNING: number-unit.toNumberString usage will be removed soon. Use number-unit.toString({unit: false}) instead"),this._toNumberString(t)}_toNumberString(t=this.unit){const e="WARNING: number-unit was cloned improperly and is no longer a NumberUnit instance",n=t.toString();if(this._numberStringMap&&this._numberStringMap.get(n))return this._numberStringMap.get(n);let r;this._numberStringMap||Object(o.default)(e);let i=(r=t===this.unit?this:this.to(t))._number.toString(10);if(0===r.unit.power)return this._numberStringMap?this._numberStringMap.set(n,i):Object(o.default)(e),i;const s="-"===i[0];s&&(i=i.slice(1)),i.length<r.unit.power+1&&(i=i.padStart(r.unit.power+1,"0"));const a=(i=i.slice(0,-r.unit.power)+"."+i.slice(-r.unit.power)).indexOf(".");if(-1!==a){let t=i.length-1;for(;"0"===i[t]&&t>a;)t-=1;t!==i.length-1&&("."===i[t]&&t--,i=i.slice(0,t+1))}return s&&(i="-"+i),this._numberStringMap?this._numberStringMap.set(n,i):Object(o.default)(e),i}toString({unit:t=!0,format:e,unitInstance:n=this.unit}={}){return n&&(n=this.unitType.units[n.toString()]),e?e(this._toNumberString(n),n):this._toNumberString(n)+(t?" "+n.unitName:"")}toDefaultString({unit:t=!1}={}){return this.toString({unitInstance:this.defaultUnit,unit:t})}toBaseString({unit:t=!1}={}){return this.toString({unitInstance:this.baseUnit,unit:t})}valueOf(){return this.toDefaultNumber()}get value(){return this.toString()}get isNegative(){return this._number.isNegative()}get isPositive(){return this._number.isPositive()}get isZero(){return this._number.isZero()}_coerceToNumberUnit(t){return h.isNumberUnit(t)?t:(Object(o.default)("DEPRECATION WARNING: number-unit.add/sub usage with int or string param will be removed soon"),new h(t,this.unit))}}h.isNumberUnit=r.default},function(t,e,n){"use strict";n.d(e,"default",function(){return y});var r=n(0),i=n.n(r),o=n(2),s=n.n(o),a=n(88),u=n(17),c=0;function h(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}const{isEmpty:l,mapValues:f,memoize:d}=s.a,p=Symbol("UnitType"),m=t=>t;class y{static equals(t,e){return i()(t instanceof y,"argument must be a UnitType"),t===e||t.equals(e)}constructor(t,e){this.units=void 0,this.baseUnit=void 0,this.defaultUnit=void 0,Object.defineProperty(this,g,{writable:!0,value:void 0}),i()(e===p,"please use UnitType.create()"),this.units={},Object.keys(t).forEach(e=>{this.units[e]=Object(a.create)(this,e,t[e]),this[e]=this.units[e]});const n=Object.keys(this.units).filter(t=>0===this.units[t].power);if(0===n.length)throw new Error("Must specify at least one unit with a power of 0.");this.baseUnit=this.units[n[0]],this.defaultUnit=Object.values(this.units).reduce((t,e)=>Math.trunc(t.power)>e.power?t:e,{}),h(this,g)[g]=this.defaultUnit(0)}equals(t){return i()(Object(u.default)(t),"argument must be a UnitType"),this===t||this.toString()===t.toString()}parse(t){const[e,n]=t.split(" ");if(void 0===this.units[n])throw new Error(`Unit "${n}" not found from parsing "${t}"`);return this.units[n](e)}toString(){return String(this.defaultUnit)}toJSON(){return f(this.units,t=>t.power)}get ZERO(){return h(this,g)[g]}}y.create=d(t=>(i()(!l(t),"definitions must have at least one item"),new y(m(t),p)),t=>JSON.stringify(m(t)));var g="__private_"+c+++"_"+"zero"},function(t,e,n){!function(e){function n(t,e){for(var n in e)t[n]=t[n]||e[n]}function r(t,e,r,o,s){return r.method=t,r.headers=r.headers||{},r.responseAs=r.responseAs&&["json","text","response"].indexOf(r.responseAs)>=0?r.responseAs:"json",n(r.headers,{Accept:"application/json","Content-Type":"application/json"}),s&&(e+=function(t){return"?"+Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&")}(s)),o?r.body=JSON.stringify(o):delete r.body,i.fetch(e,r).then(function(t){if(t.status>=200&&t.status<300)return"response"==r.responseAs?t:204==t.status?null:t[r.responseAs]();var e=new Error(t.statusText);throw e.response=t,e})}function i(t,e){e=e||{};var o=function(r,o){return r=t+"/"+r,n(o=o||{},e),i(r,o)};return o.get=function(n){return r("GET",t,e,null,n)},o.post=function(n){return r("POST",t,e,n)},o.put=function(n){return r("PUT",t,e,n)},o.patch=function(n){return r("PATCH",t,e,n)},o.delete=function(){return r("DELETE",t,e)},o}i.fetch=fetch.bind(e),t.exports=i}(window)},function(t,e,n){"use strict";n.d(e,"default",function(){return i});var r=n(2);function i(t=[]){const e=[...t,{type:"date",test:t=>t instanceof Date,serialize:t=>t.toJSON(),deserialize:t=>new Date(t)},{type:"buffer",test:t=>t instanceof Buffer,serialize:t=>t.toString("base64"),deserialize:t=>Buffer.from(t,"base64")},{type:"uint8array",test:t=>t instanceof Uint8Array,serialize:t=>Buffer.from(t).toString("base64"),deserialize:t=>{const e=Buffer.from(t,"base64"),n=new Uint8Array(e.length);return n.set(e),n}},{type:"array",test:r.isArray,serialize:t=>t.map(t=>i(t)),deserialize:t=>t.map(t=>o(t))},{type:"object",test:r.isObject,serialize:t=>Object(r.mapValues)(t,t=>i(t)),deserialize:t=>Object(r.mapValues)(t,t=>o(t))}],n=new Set(e.map(t=>t.type)),i=t=>{const n=e.find(e=>e.test(t));return n?{t:n.type,v:n.serialize(t)}:t},o=t=>Object(r.isObject)(t)&&2===Object.keys(t).length&&"v"in t&&n.has(t.t)?e.find(e=>e.type===t.t).deserialize(t.v):t;return{serialize:i,deserialize:o}}},function(t,e,n){const r={construct:(t,e)=>new Proxy(new t(...e),r),set:(t,e,n)=>{const r=`Trying to set value of property (${e}) of frozen object.`;(console.warn.bind(console)||console.error.bind(console)||console.log.bind(console))(r)}};t.exports=function(t){if("function"!=typeof t&&"object"!=typeof t)throw new Error("proxyFreeze only supports constructor functions or objects.");return new Proxy(t,r)}},function(t,e,n){"use strict";t.exports=function t(e,n){if(typeof e!=typeof n)return n;const r=Object.getPrototypeOf(n);if(r!==Object.getPrototypeOf(e))return n;if(r!==Object.prototype)return n;const i=Object.entries(n);if(0===i.length)return n;const o=new Map(Object.entries(e));for(const[e,n]of i)o.set(e,o.has(e)?t(o.get(e),n):n);return Object.fromEntries(o)}},function(t,e,n){"use strict";var r=n(96);const i=Object(r.default)(),o=t=>t.map(({data:t})=>t),s=[{type:"order",channelName:"orders",syncStateKey:"sync:syncstate:orders",processBatch:t=>i.monitors.e2eSync.processOrdersBatch(o(t)),batchInterval:1e3},{type:"order",channelName:"v1_orders",syncStateKey:"sync:syncstate:v1_orders",processBatch:t=>i.monitors.e2eSync.processOrdersBatch(o(t)),batchInterval:1e3},{type:"personalNote",channelName:"personalNotes",syncStateKey:"sync:syncstate:personalnotes",processBatch:t=>i.monitors.e2eSync.processPersonalNotesBatch(o(t)),batchInterval:1e3}];e.default=s},function(t,e,n){"use strict";n.d(e,"waitForInitialize",function(){return c});var r=n(7),i=n(3),o=n(37),s=n(95),a=n(94);const u=(...t)=>console.debug("[exodus:network:firestore-client]",...t);async function c({onReinitialize:t}={}){let e;return new Promise((n,c)=>{const h=async(i,h)=>{if(r.ENV_DEV&&e)return t&&t(),void await e;e=async function(t,e){const n=await s.default.getAction();return n&&r.RESTORE_ACTIONS.includes(n)&&(u("clearing existing channel sync state"),o.default.forEach(({syncStateKey:t})=>window.localStorage.removeItem(t))),Object(a.createFirestoreSync)(t,e)}(i,h);try{const t=await e;n(t)}catch(t){throw u("initialize error",t),c(t),t}};i.rpcRenderer.on("network:e2e-sync:initialize",async(t,{payload:{keys:e,analyticsUserId:n}})=>{try{u("initializing fusion client"),await h(e,n),Object(i.targeted)("ui","network:e2e-sync:resolve")}catch(t){Object(i.targeted)("ui","network:e2e-sync:reject",t)}}),Object(i.targeted)("ui","network:e2e-sync:ready")})}},function(t,e){var n=1e3,r=60*n,i=60*r,o=24*i,s=365.25*o;function a(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var u,c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>1e4)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===c&&!1===isNaN(t))return e.long?a(u=t,o,"day")||a(u,i,"hour")||a(u,r,"minute")||a(u,n,"second")||u+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";n.d(e,"default",function(){return a});var r=n(99),i=n.n(r),o=0;function s(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}class a{constructor({sendMessage:t,attachListener:e}){this.isDone=!1,Object.defineProperty(this,u,{writable:!0,value:i()()}),this.awaitDone=(()=>s(this,u)[u].promise),e(e=>{switch(e){case"reach":t("grasp"),this.isDone=!0;break;case"grasp":this.isDone=!0}this.isDone&&s(this,u)[u].resolve()}),t("reach")}}var u="__private_"+o+++"_"+"deferred"},function(t,e,n){"use strict";var r=n(100),i=n.n(r);e.default=(t=>(i()(t).forEach(function(t){t instanceof Uint8Array&&this.update(globalThis.Buffer.from(t))}),t))},function(t,e,n){"use strict";n.d(e,"fromObject",function(){return a});class r extends Error{constructor(...t){super(...t),this.name="UnknownError"}}const i=globalThis,o=[...[Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError],...[i.RTCError,i.OverconstrainedError,i.DOMError,i.MediaError],r,class extends Error{constructor(...t){super(...t),this.name="AssertionError"}}],s=new Map;for(const t of o)t&&(t===Error||t.prototype instanceof Error)&&s.set(t.name,t);function a(t){const e=new(s.get(t.name)||r)(t.message);for(const n of Object.keys(t))n in e||["__proto__","name","message"].includes(n)||(e[n]=t[n]);return t.stack&&(e.stack=t.stack),e}},function(t,e,n){"use strict";const r=globalThis.crypto;e.randomUUID=r.randomUUID.bind(r)},function(t,e,n){"use strict";n.d(e,"createNumber",function(){return s}),n.d(e,"stringToNumberFraction",function(){return a});var r=n(6),i=n(4);function o(t){return null!==t&&"object"==typeof t&&26===t.constructor.wordSize&&Array.isArray(t.words)}function s(t,e){if(null==t.isBigIntWrapper?void 0:t.isBigIntWrapper())return t;if(o(t)&&e>0)throw new Error(`You are creating a NU providing a BN.js number ${t} with a power of ${e}. Please use base units, string or decimal numbers!`);if("bigint"==typeof t&&e>0&&Object(r.default)(`You are creating a NU providing a bigint number ${t} with a power of ${e}. Please use base unit, string or decimal numbers!`),i.default.isUnderlyingInstance(t)){const n=i.default.wrap(t);return e?n.mutateMul(i.default.wrap(10).pow(i.default.wrap(e))):n}const n=a(t,e,{numberOnly:!0});return i.default.wrap(n)}function a(t,e,{numberOnly:n=!1}={}){if("number"==typeof t){if(t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)throw new Error("Infinity is not supported");t=t.toString()}else if("string"==typeof t)t=t.toLowerCase();else if(o(t))t=t.toString();else{if("bigint"!=typeof t)throw new TypeError(`Invalid number type '${typeof t}'`);t=t.toString()}if(t.length>2&&"0"===t[0]&&"x"===t[1]){if(t=t.slice(2),!/^[\d.a-f]*$/.test(t))throw new Error(`Invalid hex number: 0x${t}`);t=i.default.wrap(t,16).toString(10)}const r="-"===t[0];r&&(t=t.slice(1));const s=r?"-":"";"+"!==t[0]||r||(t=t.slice(1));const a=t.indexOf("e");if(-1!==a){if(e+=Number.parseInt(t.slice(a+1),10),Number.isNaN(e))throw new TypeError(`Invalid exponential in number: ${t}`);t=t.slice(0,a)}if(!/^\d*(\.\d*)?$/.test(t))throw new Error(`Not allowed symbol in number: ${t}`);switch(t.indexOf(".")){case-1:t+=".0";break;case 0:t="0"+t;break;case t.length-1:t+="0"}if(0===e){const e=t.indexOf("."),r=s+t.slice(0,e);if(n)return r;const i=t.slice(e+1);return{number:r,fraction:s+i,fractionLength:i.length}}const u=(t=e>0?t.padEnd(t.length+e,"0"):t.padStart(t.length-e,"0")).indexOf("."),c=s+(t=t.slice(0,u)+t.slice(u+1)).slice(0,u+e);if(n)return c;let h=t.slice(u+e),l=h.length-1;for(;"0"===h[l]&&l>0;)l-=1;return l!==h.length-1&&(h=h.slice(0,l+1)),{number:c,fraction:s+h,fractionLength:h.length}}},function(t,e,n){"use strict";{const{ipcRenderer:e}=globalThis.exodusPreload;t.exports={ipcRenderer:e}}},function(t,e,n){"use strict";n(0),n(19),n(12),n(21)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(66),i=n(24);e.SHA2=class extends i.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,i.createView)(this.buffer)}update(t){(0,r.exists)(this);const{view:e,buffer:n,blockLen:o}=this,s=(t=(0,i.toBytes)(t)).length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a!==o)n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(e,0),this.pos=0);else{const e=(0,i.createView)(t);for(;o<=s-r;r+=o)this.process(e,r)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,r.exists)(this),(0,r.output)(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:o,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(n,0),a=0);for(let t=a;t<o;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),u=r?4:0,c=r?0:4;t.setUint32(e+u,s,r),t.setUint32(e+c,a,r)}(n,o-8,BigInt(8*this.length),s),this.process(n,0);const u=(0,i.createView)(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,l=this.get();if(h>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)u.setUint32(4*t,l[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return t.length=r,t.pos=s,t.finished=i,t.destroyed=o,r%e&&t.buffer.set(n),t}}},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return s}),n.d(e,"__decorate",function(){return a}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return h}),n.d(e,"__generator",function(){return l}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return m}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return v}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return _}),n.d(e,"__importDefault",function(){return S});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function a(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}u((r=r.apply(t,e||[])).next())})}function l(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return(o={next:a(0),throw:a(1),return:a(2)})[Symbol.iterator]=function(){return this},o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e=t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n=t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||a(t,e)})})}function a(t,e){try{(n=i[t](e)).value instanceof y?Promise.resolve(n.value.v).then(u,c):h(o[0][2],n)}catch(t){h(o[0][3],t)}var n}function u(t){a("next",t)}function c(t){a("throw",t)}function h(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function v(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(e=t[n](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){const r=n(33),i=n(75),{bufToHex:o}=n(74),{decodePairingData:s,encodePairingData:a}=n(123),{encryptSecretJSON:u,decryptSecretJSON:c,encryptBoxJSON:h,decryptBoxJSON:l}=n(73),{pollingFetch:f}=n(121),{version:d}=n(119),p=t=>(function(...e){try{return t.apply(this,e)}catch(t){const e=Promise.reject(t);return e.cancel=(()=>{}),e}});t.exports=class{constructor({sodium:t,endpoint:e,createHash:n,hash:i}){this.sodium=t;const o=r(e);this.fetch=((t,e)=>o(`${t}?clientVersion=${d}`,e)),this.sha256HashHex=i?async t=>i("sha256",t,"hex"):async function(t){return n("sha256").update(t).digest("hex")};const s={encryptSecretJSON:u,decryptSecretJSON:c,encryptBoxJSON:h,decryptBoxJSON:l};Object.assign(this,s),this._poller=null,this.pollingFetch=((...t)=>(this.cancelPolling(),this._poller=f.apply(this,t),this._poller)),this.senderGetDeviceRequest=p(this.senderGetDeviceRequest.bind(this)),this.recipientGetEncryptedSecret=p(this.recipientGetEncryptedSecret.bind(this))}cancelPolling(){this._poller&&(this._poller.cancel(),delete this._poller)}async senderEncryptAndEncodePhrase({phrase:t,secretKey:e,senderPublicKey:n}){Buffer.isBuffer(n)||(n=Buffer.from(n));const r=await this.encryptSecretJSON(t,e);return a({ciphertext:r,pub:n})}async recipientDecodePhrase(t){const{ciphertext:e,pub:n}=s(t);return{encryptedPhrase:e,senderPublicKey:n}}async recipientMakeDeviceRequest({confirmationPhrase:t,senderPublicKey:e,recipientPublicKey:n,recipientPrivateKey:r,unencryptedMetadata:s,metadata:a}){const u=await this.sha256HashHex(e),c=await this.encryptBoxJSON(t,{toPublic:e,fromPrivate:r}),h={confirmationPhrase:o(c),recipientPublicKey:o(n)};if(s&&(h.unencryptedMetadata=s),a){const t=i.stringify(a),n=await this.encryptBoxJSON(t,{toPublic:e,fromPrivate:r});h.encryptedMetadata=o(n)}return this.fetch(`pairing-v2/${u}/pairingRequest`).post(h)}async senderGetDeviceRequest({senderPublicKey:t,senderPrivateKey:e,maxTries:n,retryDelay:r}){const o=await this.sha256HashHex(t),s=await this.pollingFetch(`pairing-v2/${o}/pairingRequest`,n,r);if(!s.confirmationPhrase||!s.recipientPublicKey)throw new Error("received invalid data");const a=Buffer.from(s.confirmationPhrase,"hex"),u={toPrivate:e,fromPublic:s.recipientPublicKey},c=await this.decryptBoxJSON(a,u);let h={};if(s.encryptedMetadata){const t=Buffer.from(s.encryptedMetadata,"hex"),e=await this.decryptBoxJSON(t,u);h=i.parse(e)}return{confirmationPhrase:c,recipientPublicKey:s.recipientPublicKey,metadata:h}}async senderEncryptSecret({secretKey:t,recipientPublicKey:e,senderPrivateKey:n,metadata:r={}}){const s=o(t);return r=i.stringify(r),this.encryptBoxJSON({secretKey:s,metadata:r},{toPublic:e,fromPrivate:n})}async senderUploadSecretKey({encryptedSecretKey:t,senderPublicKey:e,unencryptedMetadata:n}){const r=await this.sha256HashHex(e),i={encryptedSecretKey:o(t)};return n&&(i.unencryptedMetadata=n),this.fetch(`pairing-v2/${r}/pairingResponse`).post(i)}async recipientGetEncryptedSecret({senderPublicKey:t,maxTries:e,retryDelay:n}){const r=await this.sha256HashHex(t),i=await this.pollingFetch(`pairing-v2/${r}/pairingResponse`,e,n);return Buffer.from(i.encryptedSecretKey,"hex")}async recipientMakeCancelRequest({senderPublicKey:t,unencryptedMetadata:e}){const n=await this.sha256HashHex(t);return this.fetch(`pairing-v2/${n}/cancel`).post({unencryptedMetadata:e})}async recipientDecryptPhrase({encryptedPhrase:t,encryptedSecretKey:e,recipientPrivateKey:n,senderPublicKey:r}){let{secretKey:o,metadata:s}=await this.decryptBoxJSON(e,{toPrivate:n,fromPublic:r});return s&&(s=i.parse(s)),{phrase:await this.decryptSecretJSON(t,Buffer.from(o,"hex")),metadata:s}}async recipientEncryptWalletMetadata({recipientPrivateKey:t,senderPublicKey:e,metadata:n}){return n=i.stringify(n),this.encryptBoxJSON(n,{toPublic:e,fromPrivate:t})}async recipientUploadWalletMetadata({encryptedMetadata:t,senderPublicKey:e}){const n=await this.sha256HashHex(e);return this.fetch(`pairing-v2/${n}/walletMetadata`).post({encryptedMetadata:o(t)})}async senderGetWalletMetadata({senderPublicKey:t,maxTries:e,retryDelay:n}){const r=await this.sha256HashHex(t),i=await this.pollingFetch(`pairing-v2/${r}/walletMetadata`,e,n);return Buffer.from(i.encryptedMetadata,"hex")}async senderDecryptWalletMetadata({recipientPublicKey:t,senderPrivateKey:e,encryptedMetadata:n}){const r=await this.decryptBoxJSON(n,{toPrivate:e,fromPublic:t});return i.parse(r)}}},function(t,e,n){"use strict";var r,i=Reflect,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise(function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}y(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&y(t,"error",e,n)}(t,i,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function l(t,e,n,r){var i,o,s,a;if(c(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=h(t))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return t}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):m(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function y(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return h(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)o(u,this,e);else{var c=u.length,h=m(u,c);for(n=0;n<c;++n)o(h[n],this,e)}return!0},a.prototype.addListener=function(t,e){return l(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return l(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,f(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,f(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,i,o,s;if(c(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){!function(t,e){"use strict";function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function r(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function i(t,e,n){if(i.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(n=e,e=10),this._init(t||0,e||10,n||"be"))}var Buffer;t.exports=i,i.BN=i,i.wordSize=26;try{Buffer=window.Buffer}catch(t){}function o(t,e){var n=t.charCodeAt(e);return n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:n-48&15}function s(t,e,n){var r=o(t,n);return n-1>=e&&(r|=o(t,n-1)<<4),r}function a(t,e,n,r){for(var i=0,o=Math.min(t.length,n),s=e;s<o;s++){var a=t.charCodeAt(s)-48;i*=r,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}i.isBN=function(t){return t instanceof i||null!==t&&"object"==typeof t&&t.constructor.wordSize===i.wordSize&&Array.isArray(t.words)},i.max=function(t,e){return t.cmp(e)>0?t:e},i.min=function(t,e){return t.cmp(e)<0?t:e},i.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var i=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<t.length&&(16===e?this._parseHex(t,i,r):(this._parseBase(t,e,i),"le"===r&&this._initArray(this.toArray(),e,r)))},i.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},i.prototype._initArray=function(t,e,r){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=t.length-1,o=0;i>=0;i-=3)s=t[i]|t[i-1]<<8|t[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<t.length;i+=3)s=t[i]|t[i+1]<<8|t[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},i.prototype._parseHex=function(t,e,n){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,o=0,a=0;if("be"===n)for(r=t.length-1;r>=e;r-=2)i=s(t,e,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;else for(r=(t.length-e)%2==0?e+1:e;r<t.length;r+=2)i=s(t,e,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;this.strip()},i.prototype._parseBase=function(t,e,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=e)r++;r--,i=i/e|0;for(var o=t.length-n,s=o%r,u=Math.min(o,o-s)+n,c=0,h=n;h<u;h+=r)c=a(t,h,h+r,e),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=a(t,h,t.length,e),h=0;h<s;h++)l*=e;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},i.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},i.prototype.clone=function(){var t=new i(null);return this.copy(t),t},i.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function l(t,e,n){n.negative=e.negative^t.negative;var r=t.length+e.length|0;n.length=r,r=r-1|0;var i=0|t.words[0],o=0|e.words[0],s=i*o,a=67108863&s,u=s/67108864|0;n.words[0]=a;for(var c=1;c<r;c++){for(var h=u>>>26,l=67108863&u,f=Math.min(c,e.length-1),d=Math.max(0,c-t.length+1);d<=f;d++){var p=c-d|0;h+=(s=(i=0|t.words[p])*(o=0|e.words[d])+l)/67108864|0,l=67108863&s}n.words[c]=0|l,u=0|h}return 0!==u?n.words[c]=0|u:n.length--,n.strip()}i.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],l=(16777215&(a<<i|o)).toString(16);r=0!==(o=a>>>24-i&16777215)||s!==this.length-1?u[6-l.length]+l+r:l+r,(i+=2)>=26&&(i-=26,s--)}for(0!==o&&(r=o.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var f=c[t],d=h[t];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(d).toString(t);r=(p=p.idivn(d)).isZero()?m+r:u[f-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(t,e){return n(void 0!==Buffer),this.toArrayLike(Buffer,t,e)},i.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},i.prototype.toArrayLike=function(t,e,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,u="le"===e,c=new t(o),h=this.clone();if(u){for(a=0;!h.isZero();a++)s=h.andln(255),h.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-i;a++)c[a]=0;for(a=0;!h.isZero();a++)s=h.andln(255),h.iushrn(8),c[o-a-1]=s}return c},Math.clz32?i.prototype._countBits=function(t){return 32-Math.clz32(t)}:i.prototype._countBits=function(t){var e=t,n=0;return e>=4096&&(n+=13,e>>>=13),e>=64&&(n+=7,e>>>=7),e>=8&&(n+=4,e>>>=4),e>=2&&(n+=2,e>>>=2),n+e},i.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,n=0;return 0==(8191&e)&&(n+=13,e>>>=13),0==(127&e)&&(n+=7,e>>>=7),0==(15&e)&&(n+=4,e>>>=4),0==(3&e)&&(n+=2,e>>>=2),0==(1&e)&&n++,n},i.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var n=this._zeroBits(this.words[e]);if(t+=n,26!==n)break}return t},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},i.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},i.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},i.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},i.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},i.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var n=0;n<e.length;n++)this.words[n]=this.words[n]&t.words[n];return this.length=e.length,this.strip()},i.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},i.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},i.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},i.prototype.iuxor=function(t){var e,n;this.length>t.length?(e=this,n=t):(e=t,n=this);for(var r=0;r<n.length;r++)this.words[r]=e.words[r]^n.words[r];if(this!==e)for(;r<e.length;r++)this.words[r]=e.words[r];return this.length=e.length,this.strip()},i.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},i.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},i.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},i.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var i=0;i<e;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},i.prototype.notn=function(t){return this.clone().inotn(t)},i.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var r=t/26|0,i=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},i.prototype.iadd=function(t){var e,n,r;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(n=this,r=t):(n=t,r=this);for(var i=0,o=0;o<r.length;o++)e=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&e,i=e>>>26;for(;0!==i&&o<n.length;o++)e=(0|n.words[o])+i,this.words[o]=67108863&e,i=e>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},i.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},i.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var n,r,i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=t):(n=t,r=this);for(var o=0,s=0;s<r.length;s++)o=(e=(0|n.words[s])-(0|r.words[s])+o)>>26,this.words[s]=67108863&e;for(;0!==o&&s<n.length;s++)o=(e=(0|n.words[s])+o)>>26,this.words[s]=67108863&e;if(0===o&&s<n.length&&n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this.length=Math.max(this.length,s),n!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(t){return this.clone().isub(t)};var f=function(t,e,n){var r,i,o,s=t.words,a=e.words,u=n.words,c=0,h=0|s[0],l=8191&h,f=h>>>13,d=0|s[1],p=8191&d,m=d>>>13,y=0|s[2],g=8191&y,v=y>>>13,b=0|s[3],w=8191&b,_=b>>>13,S=0|s[4],E=8191&S,I=S>>>13,T=0|s[5],A=8191&T,N=T>>>13,C=0|s[6],O=8191&C,D=C>>>13,k=0|s[7],M=8191&k,x=k>>>13,P=0|s[8],R=8191&P,L=P>>>13,B=0|s[9],U=8191&B,F=B>>>13,j=0|a[0],q=8191&j,V=j>>>13,K=0|a[1],z=8191&K,W=K>>>13,G=0|a[2],H=8191&G,Q=G>>>13,J=0|a[3],$=8191&J,Y=J>>>13,X=0|a[4],Z=8191&X,tt=X>>>13,et=0|a[5],nt=8191&et,rt=et>>>13,it=0|a[6],ot=8191&it,st=it>>>13,at=0|a[7],ut=8191&at,ct=at>>>13,ht=0|a[8],lt=8191&ht,ft=ht>>>13,dt=0|a[9],pt=8191&dt,mt=dt>>>13;n.negative=t.negative^e.negative,n.length=19;var yt=(c+(r=Math.imul(l,q))|0)+((8191&(i=(i=Math.imul(l,V))+Math.imul(f,q)|0))<<13)|0;c=((o=Math.imul(f,V))+(i>>>13)|0)+(yt>>>26)|0,yt&=67108863,r=Math.imul(p,q),i=(i=Math.imul(p,V))+Math.imul(m,q)|0,o=Math.imul(m,V);var gt=(c+(r=r+Math.imul(l,z)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(f,z)|0))<<13)|0;c=((o=o+Math.imul(f,W)|0)+(i>>>13)|0)+(gt>>>26)|0,gt&=67108863,r=Math.imul(g,q),i=(i=Math.imul(g,V))+Math.imul(v,q)|0,o=Math.imul(v,V),r=r+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,W)|0;var vt=(c+(r=r+Math.imul(l,H)|0)|0)+((8191&(i=(i=i+Math.imul(l,Q)|0)+Math.imul(f,H)|0))<<13)|0;c=((o=o+Math.imul(f,Q)|0)+(i>>>13)|0)+(vt>>>26)|0,vt&=67108863,r=Math.imul(w,q),i=(i=Math.imul(w,V))+Math.imul(_,q)|0,o=Math.imul(_,V),r=r+Math.imul(g,z)|0,i=(i=i+Math.imul(g,W)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,W)|0,r=r+Math.imul(p,H)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,Q)|0;var bt=(c+(r=r+Math.imul(l,$)|0)|0)+((8191&(i=(i=i+Math.imul(l,Y)|0)+Math.imul(f,$)|0))<<13)|0;c=((o=o+Math.imul(f,Y)|0)+(i>>>13)|0)+(bt>>>26)|0,bt&=67108863,r=Math.imul(E,q),i=(i=Math.imul(E,V))+Math.imul(I,q)|0,o=Math.imul(I,V),r=r+Math.imul(w,z)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,z)|0,o=o+Math.imul(_,W)|0,r=r+Math.imul(g,H)|0,i=(i=i+Math.imul(g,Q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,Q)|0,r=r+Math.imul(p,$)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,Y)|0;var wt=(c+(r=r+Math.imul(l,Z)|0)|0)+((8191&(i=(i=i+Math.imul(l,tt)|0)+Math.imul(f,Z)|0))<<13)|0;c=((o=o+Math.imul(f,tt)|0)+(i>>>13)|0)+(wt>>>26)|0,wt&=67108863,r=Math.imul(A,q),i=(i=Math.imul(A,V))+Math.imul(N,q)|0,o=Math.imul(N,V),r=r+Math.imul(E,z)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,W)|0,r=r+Math.imul(w,H)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(_,H)|0,o=o+Math.imul(_,Q)|0,r=r+Math.imul(g,$)|0,i=(i=i+Math.imul(g,Y)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,Y)|0,r=r+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,tt)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,tt)|0;var _t=(c+(r=r+Math.imul(l,nt)|0)|0)+((8191&(i=(i=i+Math.imul(l,rt)|0)+Math.imul(f,nt)|0))<<13)|0;c=((o=o+Math.imul(f,rt)|0)+(i>>>13)|0)+(_t>>>26)|0,_t&=67108863,r=Math.imul(O,q),i=(i=Math.imul(O,V))+Math.imul(D,q)|0,o=Math.imul(D,V),r=r+Math.imul(A,z)|0,i=(i=i+Math.imul(A,W)|0)+Math.imul(N,z)|0,o=o+Math.imul(N,W)|0,r=r+Math.imul(E,H)|0,i=(i=i+Math.imul(E,Q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,Q)|0,r=r+Math.imul(w,$)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(_,$)|0,o=o+Math.imul(_,Y)|0,r=r+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,tt)|0)+Math.imul(v,Z)|0,o=o+Math.imul(v,tt)|0,r=r+Math.imul(p,nt)|0,i=(i=i+Math.imul(p,rt)|0)+Math.imul(m,nt)|0,o=o+Math.imul(m,rt)|0;var St=(c+(r=r+Math.imul(l,ot)|0)|0)+((8191&(i=(i=i+Math.imul(l,st)|0)+Math.imul(f,ot)|0))<<13)|0;c=((o=o+Math.imul(f,st)|0)+(i>>>13)|0)+(St>>>26)|0,St&=67108863,r=Math.imul(M,q),i=(i=Math.imul(M,V))+Math.imul(x,q)|0,o=Math.imul(x,V),r=r+Math.imul(O,z)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(D,z)|0,o=o+Math.imul(D,W)|0,r=r+Math.imul(A,H)|0,i=(i=i+Math.imul(A,Q)|0)+Math.imul(N,H)|0,o=o+Math.imul(N,Q)|0,r=r+Math.imul(E,$)|0,i=(i=i+Math.imul(E,Y)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,Y)|0,r=r+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,tt)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,tt)|0,r=r+Math.imul(g,nt)|0,i=(i=i+Math.imul(g,rt)|0)+Math.imul(v,nt)|0,o=o+Math.imul(v,rt)|0,r=r+Math.imul(p,ot)|0,i=(i=i+Math.imul(p,st)|0)+Math.imul(m,ot)|0,o=o+Math.imul(m,st)|0;var Et=(c+(r=r+Math.imul(l,ut)|0)|0)+((8191&(i=(i=i+Math.imul(l,ct)|0)+Math.imul(f,ut)|0))<<13)|0;c=((o=o+Math.imul(f,ct)|0)+(i>>>13)|0)+(Et>>>26)|0,Et&=67108863,r=Math.imul(R,q),i=(i=Math.imul(R,V))+Math.imul(L,q)|0,o=Math.imul(L,V),r=r+Math.imul(M,z)|0,i=(i=i+Math.imul(M,W)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,W)|0,r=r+Math.imul(O,H)|0,i=(i=i+Math.imul(O,Q)|0)+Math.imul(D,H)|0,o=o+Math.imul(D,Q)|0,r=r+Math.imul(A,$)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(N,$)|0,o=o+Math.imul(N,Y)|0,r=r+Math.imul(E,Z)|0,i=(i=i+Math.imul(E,tt)|0)+Math.imul(I,Z)|0,o=o+Math.imul(I,tt)|0,r=r+Math.imul(w,nt)|0,i=(i=i+Math.imul(w,rt)|0)+Math.imul(_,nt)|0,o=o+Math.imul(_,rt)|0,r=r+Math.imul(g,ot)|0,i=(i=i+Math.imul(g,st)|0)+Math.imul(v,ot)|0,o=o+Math.imul(v,st)|0,r=r+Math.imul(p,ut)|0,i=(i=i+Math.imul(p,ct)|0)+Math.imul(m,ut)|0,o=o+Math.imul(m,ct)|0;var It=(c+(r=r+Math.imul(l,lt)|0)|0)+((8191&(i=(i=i+Math.imul(l,ft)|0)+Math.imul(f,lt)|0))<<13)|0;c=((o=o+Math.imul(f,ft)|0)+(i>>>13)|0)+(It>>>26)|0,It&=67108863,r=Math.imul(U,q),i=(i=Math.imul(U,V))+Math.imul(F,q)|0,o=Math.imul(F,V),r=r+Math.imul(R,z)|0,i=(i=i+Math.imul(R,W)|0)+Math.imul(L,z)|0,o=o+Math.imul(L,W)|0,r=r+Math.imul(M,H)|0,i=(i=i+Math.imul(M,Q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,Q)|0,r=r+Math.imul(O,$)|0,i=(i=i+Math.imul(O,Y)|0)+Math.imul(D,$)|0,o=o+Math.imul(D,Y)|0,r=r+Math.imul(A,Z)|0,i=(i=i+Math.imul(A,tt)|0)+Math.imul(N,Z)|0,o=o+Math.imul(N,tt)|0,r=r+Math.imul(E,nt)|0,i=(i=i+Math.imul(E,rt)|0)+Math.imul(I,nt)|0,o=o+Math.imul(I,rt)|0,r=r+Math.imul(w,ot)|0,i=(i=i+Math.imul(w,st)|0)+Math.imul(_,ot)|0,o=o+Math.imul(_,st)|0,r=r+Math.imul(g,ut)|0,i=(i=i+Math.imul(g,ct)|0)+Math.imul(v,ut)|0,o=o+Math.imul(v,ct)|0,r=r+Math.imul(p,lt)|0,i=(i=i+Math.imul(p,ft)|0)+Math.imul(m,lt)|0,o=o+Math.imul(m,ft)|0;var Tt=(c+(r=r+Math.imul(l,pt)|0)|0)+((8191&(i=(i=i+Math.imul(l,mt)|0)+Math.imul(f,pt)|0))<<13)|0;c=((o=o+Math.imul(f,mt)|0)+(i>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,r=Math.imul(U,z),i=(i=Math.imul(U,W))+Math.imul(F,z)|0,o=Math.imul(F,W),r=r+Math.imul(R,H)|0,i=(i=i+Math.imul(R,Q)|0)+Math.imul(L,H)|0,o=o+Math.imul(L,Q)|0,r=r+Math.imul(M,$)|0,i=(i=i+Math.imul(M,Y)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,Y)|0,r=r+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,tt)|0)+Math.imul(D,Z)|0,o=o+Math.imul(D,tt)|0,r=r+Math.imul(A,nt)|0,i=(i=i+Math.imul(A,rt)|0)+Math.imul(N,nt)|0,o=o+Math.imul(N,rt)|0,r=r+Math.imul(E,ot)|0,i=(i=i+Math.imul(E,st)|0)+Math.imul(I,ot)|0,o=o+Math.imul(I,st)|0,r=r+Math.imul(w,ut)|0,i=(i=i+Math.imul(w,ct)|0)+Math.imul(_,ut)|0,o=o+Math.imul(_,ct)|0,r=r+Math.imul(g,lt)|0,i=(i=i+Math.imul(g,ft)|0)+Math.imul(v,lt)|0,o=o+Math.imul(v,ft)|0;var At=(c+(r=r+Math.imul(p,pt)|0)|0)+((8191&(i=(i=i+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;c=((o=o+Math.imul(m,mt)|0)+(i>>>13)|0)+(At>>>26)|0,At&=67108863,r=Math.imul(U,H),i=(i=Math.imul(U,Q))+Math.imul(F,H)|0,o=Math.imul(F,Q),r=r+Math.imul(R,$)|0,i=(i=i+Math.imul(R,Y)|0)+Math.imul(L,$)|0,o=o+Math.imul(L,Y)|0,r=r+Math.imul(M,Z)|0,i=(i=i+Math.imul(M,tt)|0)+Math.imul(x,Z)|0,o=o+Math.imul(x,tt)|0,r=r+Math.imul(O,nt)|0,i=(i=i+Math.imul(O,rt)|0)+Math.imul(D,nt)|0,o=o+Math.imul(D,rt)|0,r=r+Math.imul(A,ot)|0,i=(i=i+Math.imul(A,st)|0)+Math.imul(N,ot)|0,o=o+Math.imul(N,st)|0,r=r+Math.imul(E,ut)|0,i=(i=i+Math.imul(E,ct)|0)+Math.imul(I,ut)|0,o=o+Math.imul(I,ct)|0,r=r+Math.imul(w,lt)|0,i=(i=i+Math.imul(w,ft)|0)+Math.imul(_,lt)|0,o=o+Math.imul(_,ft)|0;var Nt=(c+(r=r+Math.imul(g,pt)|0)|0)+((8191&(i=(i=i+Math.imul(g,mt)|0)+Math.imul(v,pt)|0))<<13)|0;c=((o=o+Math.imul(v,mt)|0)+(i>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,r=Math.imul(U,$),i=(i=Math.imul(U,Y))+Math.imul(F,$)|0,o=Math.imul(F,Y),r=r+Math.imul(R,Z)|0,i=(i=i+Math.imul(R,tt)|0)+Math.imul(L,Z)|0,o=o+Math.imul(L,tt)|0,r=r+Math.imul(M,nt)|0,i=(i=i+Math.imul(M,rt)|0)+Math.imul(x,nt)|0,o=o+Math.imul(x,rt)|0,r=r+Math.imul(O,ot)|0,i=(i=i+Math.imul(O,st)|0)+Math.imul(D,ot)|0,o=o+Math.imul(D,st)|0,r=r+Math.imul(A,ut)|0,i=(i=i+Math.imul(A,ct)|0)+Math.imul(N,ut)|0,o=o+Math.imul(N,ct)|0,r=r+Math.imul(E,lt)|0,i=(i=i+Math.imul(E,ft)|0)+Math.imul(I,lt)|0,o=o+Math.imul(I,ft)|0;var Ct=(c+(r=r+Math.imul(w,pt)|0)|0)+((8191&(i=(i=i+Math.imul(w,mt)|0)+Math.imul(_,pt)|0))<<13)|0;c=((o=o+Math.imul(_,mt)|0)+(i>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,r=Math.imul(U,Z),i=(i=Math.imul(U,tt))+Math.imul(F,Z)|0,o=Math.imul(F,tt),r=r+Math.imul(R,nt)|0,i=(i=i+Math.imul(R,rt)|0)+Math.imul(L,nt)|0,o=o+Math.imul(L,rt)|0,r=r+Math.imul(M,ot)|0,i=(i=i+Math.imul(M,st)|0)+Math.imul(x,ot)|0,o=o+Math.imul(x,st)|0,r=r+Math.imul(O,ut)|0,i=(i=i+Math.imul(O,ct)|0)+Math.imul(D,ut)|0,o=o+Math.imul(D,ct)|0,r=r+Math.imul(A,lt)|0,i=(i=i+Math.imul(A,ft)|0)+Math.imul(N,lt)|0,o=o+Math.imul(N,ft)|0;var Ot=(c+(r=r+Math.imul(E,pt)|0)|0)+((8191&(i=(i=i+Math.imul(E,mt)|0)+Math.imul(I,pt)|0))<<13)|0;c=((o=o+Math.imul(I,mt)|0)+(i>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,r=Math.imul(U,nt),i=(i=Math.imul(U,rt))+Math.imul(F,nt)|0,o=Math.imul(F,rt),r=r+Math.imul(R,ot)|0,i=(i=i+Math.imul(R,st)|0)+Math.imul(L,ot)|0,o=o+Math.imul(L,st)|0,r=r+Math.imul(M,ut)|0,i=(i=i+Math.imul(M,ct)|0)+Math.imul(x,ut)|0,o=o+Math.imul(x,ct)|0,r=r+Math.imul(O,lt)|0,i=(i=i+Math.imul(O,ft)|0)+Math.imul(D,lt)|0,o=o+Math.imul(D,ft)|0;var Dt=(c+(r=r+Math.imul(A,pt)|0)|0)+((8191&(i=(i=i+Math.imul(A,mt)|0)+Math.imul(N,pt)|0))<<13)|0;c=((o=o+Math.imul(N,mt)|0)+(i>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,r=Math.imul(U,ot),i=(i=Math.imul(U,st))+Math.imul(F,ot)|0,o=Math.imul(F,st),r=r+Math.imul(R,ut)|0,i=(i=i+Math.imul(R,ct)|0)+Math.imul(L,ut)|0,o=o+Math.imul(L,ct)|0,r=r+Math.imul(M,lt)|0,i=(i=i+Math.imul(M,ft)|0)+Math.imul(x,lt)|0,o=o+Math.imul(x,ft)|0;var kt=(c+(r=r+Math.imul(O,pt)|0)|0)+((8191&(i=(i=i+Math.imul(O,mt)|0)+Math.imul(D,pt)|0))<<13)|0;c=((o=o+Math.imul(D,mt)|0)+(i>>>13)|0)+(kt>>>26)|0,kt&=67108863,r=Math.imul(U,ut),i=(i=Math.imul(U,ct))+Math.imul(F,ut)|0,o=Math.imul(F,ct),r=r+Math.imul(R,lt)|0,i=(i=i+Math.imul(R,ft)|0)+Math.imul(L,lt)|0,o=o+Math.imul(L,ft)|0;var Mt=(c+(r=r+Math.imul(M,pt)|0)|0)+((8191&(i=(i=i+Math.imul(M,mt)|0)+Math.imul(x,pt)|0))<<13)|0;c=((o=o+Math.imul(x,mt)|0)+(i>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,r=Math.imul(U,lt),i=(i=Math.imul(U,ft))+Math.imul(F,lt)|0,o=Math.imul(F,ft);var xt=(c+(r=r+Math.imul(R,pt)|0)|0)+((8191&(i=(i=i+Math.imul(R,mt)|0)+Math.imul(L,pt)|0))<<13)|0;c=((o=o+Math.imul(L,mt)|0)+(i>>>13)|0)+(xt>>>26)|0,xt&=67108863;var Pt=(c+(r=Math.imul(U,pt))|0)+((8191&(i=(i=Math.imul(U,mt))+Math.imul(F,pt)|0))<<13)|0;return c=((o=Math.imul(F,mt))+(i>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,u[0]=yt,u[1]=gt,u[2]=vt,u[3]=bt,u[4]=wt,u[5]=_t,u[6]=St,u[7]=Et,u[8]=It,u[9]=Tt,u[10]=At,u[11]=Nt,u[12]=Ct,u[13]=Ot,u[14]=Dt,u[15]=kt,u[16]=Mt,u[17]=xt,u[18]=Pt,0!==c&&(u[19]=c,n.length++),n};function d(t,e,n){return(new p).mulp(t,e,n)}function p(t,e){this.x=t,this.y=e}Math.imul||(f=l),i.prototype.mulTo=function(t,e){var n=this.length+t.length;return 10===this.length&&10===t.length?f(this,t,e):n<63?l(this,t,e):n<1024?function(t,e,n){n.negative=e.negative^t.negative,n.length=t.length+e.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var s=i;i=0;for(var a=67108863&r,u=Math.min(o,e.length-1),c=Math.max(0,o-t.length+1);c<=u;c++){var h=o-c,l=(0|t.words[h])*(0|e.words[c]),f=67108863&l;a=67108863&(f=f+a|0),i+=(s=(s=s+(l/67108864|0)|0)+(f>>>26)|0)>>>26,s&=67108863}n.words[o]=a,r=s,s=i}return 0!==r?n.words[o]=r:n.length--,n.strip()}(this,t,e):d(this,t,e)},p.prototype.makeRBT=function(t){for(var e=new Array(t),n=i.prototype._countBits(t)-1,r=0;r<t;r++)e[r]=this.revBin(r,n,t);return e},p.prototype.revBin=function(t,e,n){if(0===t||t===n-1)return t;for(var r=0,i=0;i<e;i++)r|=(1&t)<<e-i-1,t>>=1;return r},p.prototype.permute=function(t,e,n,r,i,o){for(var s=0;s<o;s++)r[s]=e[t[s]],i[s]=n[t[s]]},p.prototype.transform=function(t,e,n,r,i,o){this.permute(o,t,e,n,r,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var l=u,f=c,d=0;d<s;d++){var p=n[h+d],m=r[h+d],y=n[h+d+s],g=r[h+d+s],v=l*y-f*g;g=l*g+f*y,y=v,n[h+d]=p+y,r[h+d]=m+g,n[h+d+s]=p-y,r[h+d+s]=m-g,d!==a&&(v=u*l-c*f,f=u*f+c*l,l=v)}},p.prototype.guessLen13b=function(t,e){var n=1|Math.max(e,t),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},p.prototype.conjugate=function(t,e,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=t[r];t[r]=t[n-r-1],t[n-r-1]=i,i=e[r],e[r]=-e[n-r-1],e[n-r-1]=-i}},p.prototype.normalize13b=function(t,e){for(var n=0,r=0;r<e/2;r++){var i=8192*Math.round(t[2*r+1]/e)+Math.round(t[2*r]/e)+n;t[r]=67108863&i,n=i<67108864?0:i/67108864|0}return t},p.prototype.convert13b=function(t,e,r,i){for(var o=0,s=0;s<e;s++)o+=0|t[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*e;s<i;++s)r[s]=0;n(0===o),n(0==(-8192&o))},p.prototype.stub=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=0;return e},p.prototype.mulp=function(t,e,n){var r=2*this.guessLen13b(t.length,e.length),i=this.makeRBT(r),o=this.stub(r),s=new Array(r),a=new Array(r),u=new Array(r),c=new Array(r),h=new Array(r),l=new Array(r),f=n.words;f.length=r,this.convert13b(t.words,t.length,s,r),this.convert13b(e.words,e.length,c,r),this.transform(s,o,a,u,r,i),this.transform(c,o,h,l,r,i);for(var d=0;d<r;d++){var p=a[d]*h[d]-u[d]*l[d];u[d]=a[d]*l[d]+u[d]*h[d],a[d]=p}return this.conjugate(a,u,r),this.transform(a,u,f,o,r,i),this.conjugate(f,o,r),this.normalize13b(f,r),n.negative=t.negative^e.negative,n.length=t.length+e.length,n.strip()},i.prototype.mul=function(t){var e=new i(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},i.prototype.mulf=function(t){var e=new i(null);return e.words=new Array(this.length+t.length),d(this,t,e)},i.prototype.imul=function(t){return this.clone().mulTo(t,this)},i.prototype.imuln=function(t){n("number"==typeof t),n(t<67108864);for(var e=0,r=0;r<this.length;r++){var i=(0|this.words[r])*t,o=(67108863&i)+(67108863&e);e>>=26,e+=i/67108864|0,e+=o>>>26,this.words[r]=67108863&o}return 0!==e&&(this.words[r]=e,this.length++),this},i.prototype.muln=function(t){return this.clone().imuln(t)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),n=0;n<e.length;n++){var r=n/26|0,i=n%26;e[n]=(t.words[r]&1<<i)>>>i}return e}(t);if(0===e.length)return new i(1);for(var n=this,r=0;r<e.length&&0===e[r];r++,n=n.sqr());if(++r<e.length)for(var o=n.sqr();r<e.length;r++,o=o.sqr())0!==e[r]&&(n=n.mul(o));return n},i.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,r=t%26,i=(t-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(e=0;e<this.length;e++){var a=this.words[e]&o,u=(0|this.words[e])-a<<r;this.words[e]=u|s,s=a>>>26-r}s&&(this.words[e]=s,this.length++)}if(0!==i){for(e=this.length-1;e>=0;e--)this.words[e+i]=this.words[e];for(e=0;e<i;e++)this.words[e]=0;this.length+=i}return this.strip()},i.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},i.prototype.iushrn=function(t,e,r){var i;n("number"==typeof t&&t>=0),i=e?(e-e%26)/26:0;var o=t%26,s=Math.min((t-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var l=0|this.words[c];this.words[c]=h<<26-o|l>>>o,h=l&a}return u&&0!==h&&(u.words[u.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(t,e,r){return n(0===this.negative),this.iushrn(t,e,r)},i.prototype.shln=function(t){return this.clone().ishln(t)},i.prototype.ushln=function(t){return this.clone().iushln(t)},i.prototype.shrn=function(t){return this.clone().ishrn(t)},i.prototype.ushrn=function(t){return this.clone().iushrn(t)},i.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,i=1<<e;return!(this.length<=r)&&!!(this.words[r]&i)},i.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var i=67108863^67108863>>>e<<e;this.words[this.length-1]&=i}return this.strip()},i.prototype.maskn=function(t){return this.clone().imaskn(t)},i.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},i.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},i.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},i.prototype.addn=function(t){return this.clone().iaddn(t)},i.prototype.subn=function(t){return this.clone().isubn(t)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(t,e,r){var i,o,s=t.length+r;this._expand(s);var a=0;for(i=0;i<t.length;i++){o=(0|this.words[i+r])+a;var u=(0|t.words[i])*e;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},i.prototype._wordDiv=function(t,e){var n=(this.length,t.length),r=this.clone(),o=t,s=0|o.words[o.length-1];0!==(n=26-this._countBits(s))&&(o=o.ushln(n),r.iushln(n),s=0|o.words[o.length-1]);var a,u=r.length-o.length;if("mod"!==e){(a=new i(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=r.clone()._ishlnsubmul(o,1,u);0===h.negative&&(r=h,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var f=67108864*(0|r.words[o.length+l])+(0|r.words[o.length+l-1]);for(f=Math.min(f/s|0,67108863),r._ishlnsubmul(o,f,l);0!==r.negative;)f--,r.negative=0,r._ishlnsubmul(o,1,l),r.isZero()||(r.negative^=1);a&&(a.words[l]=f)}return a&&a.strip(),r.strip(),"div"!==e&&0!==n&&r.iushrn(n),{div:a||null,mod:r}},i.prototype.divmod=function(t,e,r){return n(!t.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(o=a.div.neg()),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(t)),{div:o,mod:s}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(o=a.div.neg()),{div:o,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(t)),{div:a.div,mod:s}):t.length>this.length||this.cmp(t)<0?{div:new i(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new i(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new i(this.modn(t.words[0]))}:this._wordDiv(t,e);var o,s,a},i.prototype.div=function(t){return this.divmod(t,"div",!1).div},i.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},i.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},i.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var n=0!==e.div.negative?e.mod.isub(t):e.mod,r=t.ushrn(1),i=t.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},i.prototype.modn=function(t){n(t<=67108863);for(var e=(1<<26)%t,r=0,i=this.length-1;i>=0;i--)r=(e*r+(0|this.words[i]))%t;return r},i.prototype.idivn=function(t){n(t<=67108863);for(var e=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*e;this.words[r]=i/t|0,e=i%t}return this.strip()},i.prototype.divn=function(t){return this.clone().idivn(t)},i.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var o=new i(1),s=new i(0),a=new i(0),u=new i(1),c=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),l=e.clone();!e.isZero();){for(var f=0,d=1;0==(e.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(o.isOdd()||s.isOdd())&&(o.iadd(h),s.isub(l)),o.iushrn(1),s.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(h),u.isub(l)),a.iushrn(1),u.iushrn(1);e.cmp(r)>=0?(e.isub(r),o.isub(a),s.isub(u)):(r.isub(e),a.isub(o),u.isub(s))}return{a:a,b:u,gcd:r.iushln(c)}},i.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var o,s=new i(1),a=new i(0),u=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(e.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(e.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var l=0,f=1;0==(r.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);e.cmp(r)>=0?(e.isub(r),s.isub(a)):(r.isub(e),a.isub(s))}return(o=0===e.cmpn(1)?s:a).cmpn(0)<0&&o.iadd(t),o},i.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),n=t.clone();e.negative=0,n.negative=0;for(var r=0;e.isEven()&&n.isEven();r++)e.iushrn(1),n.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=e.cmp(n);if(i<0){var o=e;e=n,n=o}else if(0===i||0===n.cmpn(1))break;e.isub(n)}return n.iushln(r)},i.prototype.invm=function(t){return this.egcd(t).a.umod(t)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(t){return this.words[0]&t},i.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,r=(t-e)/26,i=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)e=1;else{r&&(t=-t),n(t<=67108863,"Number is too big");var i=0|this.words[0];e=i===t?0:i<t?-1:1}return 0!==this.negative?0|-e:e},i.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},i.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|t.words[n];if(r!==i){r<i?e=-1:r>i&&(e=1);break}}return e},i.prototype.gtn=function(t){return 1===this.cmpn(t)},i.prototype.gt=function(t){return 1===this.cmp(t)},i.prototype.gten=function(t){return this.cmpn(t)>=0},i.prototype.gte=function(t){return this.cmp(t)>=0},i.prototype.ltn=function(t){return-1===this.cmpn(t)},i.prototype.lt=function(t){return-1===this.cmp(t)},i.prototype.lten=function(t){return this.cmpn(t)<=0},i.prototype.lte=function(t){return this.cmp(t)<=0},i.prototype.eqn=function(t){return 0===this.cmpn(t)},i.prototype.eq=function(t){return 0===this.cmp(t)},i.red=function(t){return new _(t)},i.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(t){return this.red=t,this},i.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},i.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},i.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},i.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},i.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},i.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},i.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},i.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var m={k256:null,p224:null,p192:null,p25519:null};function y(t,e){this.name=t,this.p=new i(e,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function g(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(t){if("string"==typeof t){var e=i._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function S(t){_.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var t=new i(null);return t.words=new Array(Math.ceil(this.n/13)),t},y.prototype.ireduce=function(t){var e,n=t;do{this.split(n,this.tmp),e=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(e>this.n);var r=e<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},y.prototype.split=function(t,e){t.iushrn(this.n,0,e)},y.prototype.imulK=function(t){return t.imul(this.k)},r(g,y),g.prototype.split=function(t,e){for(var n=Math.min(t.length,9),r=0;r<n;r++)e.words[r]=t.words[r];if(e.length=n,t.length<=9)return t.words[0]=0,void(t.length=1);var i=t.words[9];for(e.words[e.length++]=4194303&i,r=10;r<t.length;r++){var o=0|t.words[r];t.words[r-10]=(4194303&o)<<4|i>>>22,i=o}i>>>=22,t.words[r-10]=i,0===i&&t.length>10?t.length-=10:t.length-=9},g.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,n=0;n<t.length;n++){var r=0|t.words[n];e+=977*r,t.words[n]=67108863&e,e=64*r+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},r(v,y),r(b,y),r(w,y),w.prototype.imulK=function(t){for(var e=0,n=0;n<t.length;n++){var r=19*(0|t.words[n])+e,i=67108863&r;r>>>=26,t.words[n]=i,e=r}return 0!==e&&(t.words[t.length++]=e),t},i._prime=function(t){if(m[t])return m[t];var e;if("k256"===t)e=new g;else if("p224"===t)e=new v;else if("p192"===t)e=new b;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new w}return m[t]=e,e},_.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},_.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},_.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},_.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},_.prototype.add=function(t,e){this._verify2(t,e);var n=t.add(e);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},_.prototype.iadd=function(t,e){this._verify2(t,e);var n=t.iadd(e);return n.cmp(this.m)>=0&&n.isub(this.m),n},_.prototype.sub=function(t,e){this._verify2(t,e);var n=t.sub(e);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},_.prototype.isub=function(t,e){this._verify2(t,e);var n=t.isub(e);return n.cmpn(0)<0&&n.iadd(this.m),n},_.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},_.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},_.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},_.prototype.isqr=function(t){return this.imul(t,t.clone())},_.prototype.sqr=function(t){return this.mul(t,t)},_.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var r=this.m.add(new i(1)).iushrn(2);return this.pow(t,r)}for(var o=this.m.subn(1),s=0;!o.isZero()&&0===o.andln(1);)s++,o.iushrn(1);n(!o.isZero());var a=new i(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new i(2*h*h).toRed(this);0!==this.pow(h,c).cmp(u);)h.redIAdd(u);for(var l=this.pow(h,o),f=this.pow(t,o.addn(1).iushrn(1)),d=this.pow(t,o),p=s;0!==d.cmp(a);){for(var m=d,y=0;0!==m.cmp(a);y++)m=m.redSqr();n(y<p);var g=this.pow(l,new i(1).iushln(p-y-1));f=f.redMul(g),l=g.redSqr(),d=d.redMul(l),p=y}return f},_.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},_.prototype.pow=function(t,e){if(e.isZero())return new i(1).toRed(this);if(0===e.cmpn(1))return t.clone();var n=new Array(16);n[0]=new i(1).toRed(this),n[1]=t;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],t);var o=n[0],s=0,a=0,u=e.bitLength()%26;for(0===u&&(u=26),r=e.length-1;r>=0;r--){for(var c=e.words[r],h=u-1;h>=0;h--){var l=c>>h&1;o!==n[0]&&(o=this.sqr(o)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===r&&0===h)&&(o=this.mul(o,n[s]),a=0,s=0)):a=0}u=26}return o},_.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},_.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},i.mont=function(t){return new S(t)},r(S,_),S.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},S.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},S.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var n=t.imul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},S.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new i(0)._forceRed(this);var n=t.mul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(r).iushrn(this.shift),s=o;return o.cmp(this.m)>=0?s=o.isub(this.m):o.cmpn(0)<0&&(s=o.iadd(this.m)),s._forceRed(this)},S.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t)},function(t,e,n){"use strict";n.d(e,"isOrderAmountLegacyNumber",function(){return r}),n.d(e,"isOrderAmountLegacyDefaultUnitString",function(){return i});const r=t=>"number"==typeof t||"string"==typeof t&&!isNaN(Number(t)),i=(t,e)=>"string"==typeof t&&/^(\d+\.?\d*)\s+(\w+)$/.test(t)},function(t,e,n){"use strict";n(11),n(22),n(9);var r=n(27);n.d(e,"UtxoCollection",function(){return r.default});n(61),n(60),n(26),n(59),n(13),n(12),n(21),n(18),n(15),n(58),n(8),n(16),n(19),n(46)},function(t,e,n){"use strict";const{assertSize:r}=n(105),i=globalThis.crypto;t.exports={randomBytes:function(t){r(t);const e=Buffer.alloc(t);return i.getRandomValues(e),e}}},function(t,e,n){"use strict";const{assertHash:r,P2SH_OP_0:i}=n(68),{toUint8Arr:o,toWebCryptoDigestType:s}=n(113),{fromArrayBuffer:a}=n(67),{hashSync:u}=n(112),c=globalThis.crypto;t.exports={hash:async function t(e,n,h){if(r(e,n,h),"hash160"===e)return u("ripemd160",await t("sha256",n),h);if("p2sh-hash160"===e)return t("hash160",[i,await t("hash160",n)],h);const l=s(e);if(!l)return u(e,n,h);const f=await c.subtle.digest(l,o(n));return a(f,h)},hashSync:u}},function(t,e,n){"use strict";n.d(e,"pairerForSender",function(){return c}),n.d(e,"pairerForRecipient",function(){return h});var r=n(55),i=n(54),o=n(14),s=n.n(o),a=n(7),u=n(28);const c={...s.a.createPairerForSender({randomBytes:i.randomBytes,hash:r.hash,sodium:u.default,firebaseApiUrl:a.FIREBASE_API_URL}),getMobileWalletMetadata:async({recipientPublicKey:t})=>{((...t)=>console.debug("[exodus:e2e:pair-as-sender]",...t))("getMobileWalletMetadata start");const e=await c.getTmpKeys(),n=await c.senderGetWalletMetadata({senderPublicKey:e.publicKey,maxTries:60});return c.senderDecryptWalletMetadata({recipientPublicKey:t,senderPrivateKey:e.privateKey,encryptedMetadata:n})}},h=s.a.createPairerForRecipient({randomBytes:i.randomBytes,hash:r.hash,sodium:u.default,firebaseApiUrl:a.FIREBASE_API_URL})},function(t,e,n){"use strict";n.d(e,"createClientImplementation",function(){return s}),n.d(e,"createClientMethodImplementation",function(){return a});var r=n(43),i=n(42),o=n(23);function s(t,e,n,r,i={}){return new Proxy({},{get:(o,s,u)=>"string"==typeof s?a(t,e,n,r,s,i):void 0})}function a(t,e,n,s,a,{wrap:u,unwrap:c}={}){if("main"===n)throw new Error("Use 'ui' as the target instead of 'main'");return function(...h){const l=Object(r.randomUUID)(),f=`${o.CHANNEL_PREFIX}:${s}:response:${l}`;return new Promise((r,d)=>{const p=`${o.CHANNEL_PREFIX}:${s}:call`;u&&(h=u(a,h));const m={func:a,args:h,token:l};t.once(f,(t,{payload:e})=>{const[n,o]=e;n?d(Object(i.fromObject)(n)):r(c?c(a,o):o)}),setTimeout(()=>{try{e(n,p,m)}catch(t){d(t)}},0)})}}},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(18);let s;function a(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var u=0;function c(t){return"__private_"+u+++"_"+t}const h=Symbol("FiatOrderSet");var l=Symbol.iterator,f=c("getIdsByTx"),d=c("getSortedIdAt");s=l;class p{constructor({items:t,initSymbol:e}){Object.defineProperty(this,d,{value:y}),Object.defineProperty(this,f,{value:m}),i()(e===h,"please use FiatOrderSet.EMPTY or FiatOrderSet.fromArray()");const n=[...t.values()];n.sort((t,e)=>e.date-t.date),this._items=t,this._sortOrder=n.map(t=>t.orderId),this._txMap=new Map;for(const t of n){if(!t.txId)continue;const e=a(this,f)[f](t.txId);e.includes(String(t))||this._txMap.set(t.txId,[...e,String(t)])}}static fromArray(t){if(!t||Array.isArray(t)&&0===t.length)return p.EMPTY;const e=[],n=new Map;for(const i of t)try{const t=(r=i)instanceof p?r:o.default.fromJSON(r);n.set(String(t),t)}catch(t){e.push([t,i])}var r;return e.length>0&&console.warn("FiatOrderSet failed to convert object to FiatOrder",e),new p({items:n,initSymbol:h})}add(t){if(!this.has(t))return p.fromArray([...this,t])}clone(){return p.fromArray(this.toJSON())}delete(t){if(this.has(t))return p.fromArray(this.toJSON().filter(({orderId:e})=>e!==String(t)))}equals(t){if(this.size!==t.size)return!1;for(let e=0;e<this.size;++e)if(a(this,d)[d](e)!==a(t,d)[d](e))return!1;return!0}has(t){return this._items.has(String(t))}get(t){return this._items.get(String(t))}getAt(t){return this.get(a(this,d)[d](t))}getByTxId(t,e=0){const n=a(this,f)[f](t);return this.get(n[e])}getAllByTxId(t){return a(this,f)[f](t).map(t=>this.get(t))}toJSON(){return[...this].map(t=>t.toJSON())}[s](){return this._items.values()}get size(){return this._items.size}union(t){const e=[...[...this],...[...t]];return p.fromArray(e)}update(t){const e=[];for(const n of t){const t=this.get(n);if(t){const r=t.update({...n});t!==r&&e.push(r)}}return 0===e.length?this:p.fromArray([...this.toJSON(),...e])}}function m(t){return this._txMap.get(t)||[]}function y(t){return this._sortOrder[t]}p.EMPTY=new p({items:new Map,initSymbol:h})},function(t,e,n){"use strict";var r=n(2),i=n.n(r),o=n(13);const{mapValues:s,mergeWith:a}=i.a,u=t=>t instanceof o.default?t:new o.default(t);class c{constructor(t={}){this._byName=s(t,u)}toJSON(){return s(this._byName,t=>t.toJSON())}get(t){if(t instanceof o.default&&(t=t.toString()),this._byName.hasOwnProperty(t))return this._byName[t]}names(){return Object.keys(this._byName)}update(t){t instanceof c&&(t=t.toJSON());const e=a({...this._byName},t,(t,e)=>t?t.update(e):u(e));return new c(e)}equals(t){if(this===t)return!0;const e=Object.keys(t.toJSON()).sort(),n=this.names().sort();return e.length===n.length&&n.every(e=>{const n=this.get(e),r=t.get(e);return r&&n.equals(r)})}}c.EMPTY=new c},function(t,e,n){"use strict";var r=n(26);class i{constructor(t){if(this._items=new Map,t)for(const e of t){const t=o(e);this._items.set(String(t),t)}}static fromArray(t){return null==t?i.EMPTY:new i(t)}add(t){if(0===(t=s(t)).length)return this;const e=i.fromArray(t),n=new Set,r=[];if([...e].forEach(t=>{const e=this.get(t);e?e.equals(t)||(r.push(t),n.add(e)):r.push(t)}),0===r.length)return this;const o=[...[...this].filter(t=>!n.has(t)),...r];return i.fromArray(o)}clone(){return i.fromArray([...this])}equals(t){return this===t||this.size===t.size&&[...this].every(e=>{const n=t.get(e);return n&&n.equals(e)})}get(t){const e="string"==typeof t?t:t.txId;if(!e)throw new Error("expected txId or Object/PersonalNote with property txId");return this._items.get(e)}has(t){return this._items.has(String(t))}toJSON(){return[...this].map(t=>t.toJSON())}update(t){const e=t.map(t=>{const e=this.get(t);return e?e.update(t):o(t)});return this.add(e)}[Symbol.iterator](){return this._items.values()}get size(){return this._items.size}}i.EMPTY=new i;const o=t=>t instanceof r.default?t:r.default.fromJSON(t),s=t=>Array.isArray(t)?t:[t].flat()},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(22),s=n(9),a=n(85);const u=Symbol("TxSet"),c=({txs:t})=>new f({txs:t,initSymbol:u}),h={};var l=Symbol.iterator;class f{constructor({txs:t,initSymbol:e}){i()(e===u,"please use TxSet.EMPTY or TxSet.fromArray()"),i()(t,"txs are required when constructing TxSet"),i()(t instanceof Map,"txs must be a Map");const n=[...t.values()];n.sort(d),this._txs=new Map(n.map(t=>[t.txId,t])),this._order=n.map(t=>t.txId),this.addresses=s.default.fromArray(n.flatMap(t=>[...t.addresses]))}static fromArray(t=[]){if(!Array.isArray(t))return console.warn("Unexpected non-array value:",t),f.EMPTY;t=t.map(t=>t instanceof o.default?t:o.default.fromJSON(t));const e=new Map(t.map(t=>[t.txId,t]));return c({txs:e})}add(t){const e=this.get(t.txId);if(e&&d(e,t)>0)return this;const n=new Map(this._txs);return n.set(t.txId,t),c({txs:n})}clone(){return c({txs:new Map(this._txs)})}delete(t){const e=this.get(t);if(!e)return this;const n=new Map(this._txs);return n.delete(e.txId),c({txs:n})}equals(t){return this._order.length===t._order.length&&this._order.every((e,n)=>e===t._order[n])}deepEquals(t){return this===t||this.size===t.size&&[...this].every(e=>{const n=t.get(e);if(n)return e===n||e.equals(n)})}get(t){return this._txs.get(String(t))}getAt(t){return this.get(this._order[t])}has(t){return this._txs.has(String(t))}toJSON(){return[...this].map(t=>t.toJSON())}union(t){const e=[...[...this],...[...t]],n=f.fromArray(e);return this.deepEquals(n)?this:n}update(t){if(t instanceof f&&t.deepEquals(this))return this;const e=new Map([...t].map(t=>{const e=this.get(t.txId),n={...e,...t};e&&(Math.sign(n.coinAmount.toNumber())!==Math.sign(e.coinAmount.toNumber())||n.feeAmount||(n.coinAmount=e.coinAmount),e.meta&&(n.meta={...e.meta}));const r=o.default.fromJSON(n);return[r.txId,r]}));return c({txs:e})}updateTxsProperties(t){const e=new Map(this._txs);let n=!1;for(const r of t){const t=e.get(r.txId);if(t){const i=t.update(r);t.equals(i)||(e.set(r.txId,i),n=!0)}}return n?c({txs:e}):this}getMutations(){if(this._mutations)return this._mutations;let t;return this._mutations=[...this].map(e=>{try{return void 0===t&&(t=e.coinAmount.unitType.ZERO),e.dropped||e.data.replacedBy||(e.error||(t=t.add(e.coinAmount)),e.feeAmount&&e.feeAmount.unitType.equals(e.coinAmount.unitType)&&(t=t.sub(e.feeAmount))),t.isNegative&&!h[e.txId]&&(console.warn("negative balance in mutations calculation",{tx:e,balance:t}),h[e.txId]=e.txId),{tx:e,balance:t}}catch(t){throw e&&(console.warn("failed to calculate mutation for tx",e.toJSON()),Object.assign(t,{asset:e.coinName,extraInfo:JSON.stringify(e.toJSON())})),t}}),this._mutations}[l](){return this._txs.values()}get size(){return this._txs.size}}function d(t,e){let n=t.date-e.date;return 0===n&&(n=t.txId.localeCompare(e.txId)),n}f.util=a,f.EMPTY=c({txs:new Map})},function(t,e,n){"use strict"},function(t,e,n){"use strict";n.d(e,"default",function(){return l});var r=n(0),i=n.n(r);function o(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var s=0;const a=Symbol("bigint-wrapper"),u=t=>t instanceof l?t.unwrap():t,c=BigInt(0);var h="__private_"+s+++"_"+"getWidth";class l{static wrap(t,e=10){if("bigint"==typeof t)return new l(a,t);if("number"==typeof t)return new l(a,BigInt(t));if("string"!=typeof t)throw new Error(`Unsupported type: ${typeof t}`);switch(e){case 10:return new l(a,BigInt(t));case 16:return new l(a,BigInt("0x"+t));default:throw new Error(`Unsupported base: ${e}`)}}static isUnderlyingInstance(t){return"bigint"==typeof t}constructor(t,e){if(Object.defineProperty(this,h,{value:f}),this.__value__=void 0,t!==a)throw new Error("use wrap() instead");this.__value__=e}unwrap(){return this.__value__}add(t){return l.wrap(this.__value__+u(t))}mutateAdd(t){return this.__value__+=u(t),this}sub(t){return l.wrap(this.__value__-u(t))}mutateSub(t){return this.__value__-=u(t),this}mul(t){return l.wrap(this.__value__*u(t))}mutateMul(t){return this.__value__*=u(t),this}div(t){return l.wrap(this.__value__/u(t))}mutateDiv(t){return this.__value__/=u(t),this}mod(t){return l.wrap(this.__value__%u(t))}pow(t){return l.wrap(this.__value__**u(t))}negate(){return l.wrap(-this.__value__)}mutateNegate(){return this.__value__=-this.__value__,this}abs(){return this.__value__<c?l.wrap(-this.__value__):this}mutateAbs(){return this.__value__<c&&(this.__value__=-this.__value__),this}gte(t){return this.__value__>=u(t)}gt(t){return this.__value__>u(t)}lte(t){return this.__value__<=u(t)}lt(t){return this.__value__<u(t)}eq(t){return this.__value__===u(t)}isZero(){return this.__value__===c}isNegative(){return this.__value__<c}isPositive(){return this.__value__>c}toString(t){return i()("number"==typeof t,'expected number "base"'),this.__value__.toString(t)}toNumber(){return Number(this.__value__)}toBaseBufferLE(t=o(this,h)[h]()){const e=this.__value__.toString(16),n=Buffer.from(e.padStart(2*t,"0").slice(0,2*t),"hex");return n.reverse(),n}toBaseBufferBE(t=o(this,h)[h]()){const e=this.__value__.toString(16);return Buffer.from(e.padStart(2*t,"0").slice(0,2*t),"hex")}isBigIntWrapper(){return!0}}function f(){const t=this.__value__.toString(2).length;return Math.ceil(t/8)}l.wrapperName="native-bigint"},function(t,e,n){"use strict";n(32)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.add5L=e.add5H=e.add4H=e.add4L=e.add3H=e.add3L=e.add=e.rotlBL=e.rotlBH=e.rotlSL=e.rotlSH=e.rotr32L=e.rotr32H=e.rotrBL=e.rotrBH=e.rotrSL=e.rotrSH=e.shrSL=e.shrSH=e.toBig=e.split=e.fromBig=void 0;const r=BigInt(2**32-1),i=BigInt(32);function o(t,e=!1){return e?{h:Number(t&r),l:Number(t>>i&r)}:{h:0|Number(t>>i&r),l:0|Number(t&r)}}function s(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:a}=o(t[i],e);[n[i],r[i]]=[s,a]}return[n,r]}e.fromBig=o,e.split=s;const a=(t,e)=>BigInt(t>>>0)<<i|BigInt(e>>>0);e.toBig=a;const u=(t,e,n)=>t>>>n;e.shrSH=u;const c=(t,e,n)=>t<<32-n|e>>>n;e.shrSL=c;const h=(t,e,n)=>t>>>n|e<<32-n;e.rotrSH=h;const l=(t,e,n)=>t<<32-n|e>>>n;e.rotrSL=l;const f=(t,e,n)=>t<<64-n|e>>>n-32;e.rotrBH=f;const d=(t,e,n)=>t>>>n-32|e<<64-n;e.rotrBL=d;const p=(t,e)=>e;e.rotr32H=p;const m=(t,e)=>t;e.rotr32L=m;const y=(t,e,n)=>t<<n|e>>>32-n;e.rotlSH=y;const g=(t,e,n)=>e<<n|t>>>32-n;e.rotlSL=g;const v=(t,e,n)=>e<<n-32|t>>>64-n;e.rotlBH=v;const b=(t,e,n)=>t<<n-32|e>>>64-n;function w(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}}e.rotlBL=b,e.add=w;const _=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0);e.add3L=_;const S=(t,e,n,r)=>e+n+r+(t/2**32|0)|0;e.add3H=S;const E=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0);e.add4L=E;const I=(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0;e.add4H=I;const T=(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0);e.add5L=T;const A=(t,e,n,r,i,o)=>e+n+r+i+o+(t/2**32|0)|0;e.add5H=A;const N={fromBig:o,split:s,toBig:a,shrSH:u,shrSL:c,rotrSH:h,rotrSL:l,rotrBH:f,rotrBL:d,rotr32H:p,rotr32L:m,rotlSH:y,rotlSL:g,rotlBH:v,rotlBL:b,add:w,add3L:_,add3H:S,add4L:E,add4H:I,add5H:A,add5L:T};e.default=N},function(t,e,n){"use strict";function r(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function i(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!((n=t)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Expected Uint8Array");var n;if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function s(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");r(t.outputLen),r(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function u(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=r,e.bool=i,e.bytes=o,e.hash=s,e.exists=a,e.output=u;const c={number:r,bool:i,bytes:o,hash:s,exists:a,output:u};e.default=c},function(t,e,n){"use strict";function r(t,e="buffer"){if(!["hex","buffer","uint8"].includes(e))throw new Error("Unsupported output format");if(!(t instanceof Uint8Array&&t.constructor===Uint8Array))throw new Error("Unreachable");if("uint8"===e)return t;const n=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return"buffer"===e?n:n.toString(e)}t.exports={fromUint8Array:r,fromUint8Super:function(t,e="uint8"){if(!["hex","buffer","uint8"].includes(e))throw new Error("Unsupported output format");if(!(t instanceof Uint8Array))throw new Error("Unreachable");switch(e){case"uint8":return t.constructor===Uint8Array?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);case"buffer":return t.constructor===Buffer&&Buffer.isBuffer(t)?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength);case"hex":return t.constructor===Buffer&&Buffer.isBuffer(t)?t.toString("hex"):Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("hex")}throw new Error("Unreachable")},fromArrayBuffer:function(t,e){if(!(t instanceof ArrayBuffer&&t.constructor===ArrayBuffer))throw new Error("Unreachable");return r(new Uint8Array(t),e)},fromHash:function(t,e="buffer"){if("hex"===e)return t.digest(e);const n=t.digest();if("buffer"===e)return n;if("uint8"===e)return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unsupported output format")}}},function(t,e,n){"use strict";const r=[...["sha256","sha384","sha512","sha512-256"],...["sha3-256","sha3-384","sha3-512"],"ripemd160"],i=[...r,"hash160","p2sh-hash160"];const o=Buffer.from("0014","hex");t.exports={assertHash:function(t,e,n,r=i){if(!r.includes(t))throw new Error("Unsupported hash type");if(!("string"==typeof e||e instanceof Uint8Array)){if(!Array.isArray(e))throw new Error("Unsupported hash argument");if(!(e.length>0))throw new Error("An array in hash argument must not be empty");for(const t of e)if(!(t instanceof Uint8Array))throw new Error("Unsupported entry in hash argument")}if(![void 0,"hex","buffer","uint8"].includes(n))throw new Error("Unsupported hash format")},SUPPORTED_HMAC:r,SUPPORTED_HASH:i,P2SH_OP_0:o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=(r=n(1))&&"object"==typeof r&&"default"in r?r.default:r,s=n(71),a=n(48),u=n(114),c=n(72),h=o.SDK_VERSION,l=new s.Logger("@firebase/firestore");function f(){return l.logLevel===s.LogLevel.DEBUG?i.DEBUG:l.logLevel===s.LogLevel.SILENT?i.SILENT:i.ERROR}function d(t){switch(t){case i.DEBUG:l.logLevel=s.LogLevel.DEBUG;break;case i.ERROR:l.logLevel=s.LogLevel.ERROR;break;case i.SILENT:l.logLevel=s.LogLevel.SILENT;break;default:l.error("Firestore ("+h+"): Invalid value passed to `setLogLevel`")}}function p(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=s.LogLevel.DEBUG){var i=n.map(y);l.debug.apply(l,["Firestore ("+h+") ["+t+"]: "+e].concat(i))}}function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(l.logLevel<=s.LogLevel.ERROR){var r=e.map(y);l.error.apply(l,["Firestore ("+h+"): "+t].concat(r))}}function y(t){if("string"==typeof t)return t;var e=b.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t){var e="FIRESTORE ("+h+") INTERNAL ASSERTION FAILED: "+t;throw m(e),new Error(e)}function v(t,e){t||g(e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(i||(i={}));var b=function(){function t(){}return t.setPlatform=function(e){t.platform&&g("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||g("Platform not set"),t.platform},t}();function w(){return b.getPlatform().emptyByteString}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},S=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return a.__extends(e,t),e}(Error);
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function E(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new S(_.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function T(t,e){return void 0!==t?t:e}function A(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function N(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function C(t){for(var e in v(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function O(t,e){if(0!==e.length)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+G(e.length,"argument")+".")}function D(t,e,n){if(e.length!==n)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires "+G(n,"argument")+", but was called with "+G(e.length,"argument")+".")}function k(t,e,n){if(e.length<n)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires at least "+G(n,"argument")+", but was called with "+G(e.length,"argument")+".")}function M(t,e,n,r){if(e.length<n||e.length>r)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+G(e.length,"argument")+".")}function x(t,e,n,r){F(t,e,W(n)+" argument",r)}function P(t,e,n,r){void 0!==r&&x(t,e,n,r)}function R(t,e,n,r){F(t,e,n+" option",r)}function L(t,e,n,r){void 0!==r&&R(t,e,n,r)}function B(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+q(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+q(r[o]))}(t,e,n,r,i)}function U(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s];if(u===r)return;o.push(q(u))}var c=q(r);throw new S(_.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function F(t,e,n,r){if(!("object"===e?j(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=q(r);throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function j(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function q(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":g("Unknown wrong type: "+typeof t)}function V(t,e,n){if(void 0===n)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+W(e)+" argument, but it was undefined.")}function K(t,e,n){N(e,function(e,r){if(n.indexOf(e)<0)throw new S(_.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function z(t,e,n,r){var i=q(r);return new S(_.INVALID_ARGUMENT,"Function "+t+"() requires its "+W(n)+" argument to be a "+e+", but it was: "+i)}function W(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function G(t,e){return t+" "+e+(1===t?"":"s")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var H=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return v(20===e.length,"Invalid auto ID: "+e),e},t}();function Q(t,e){return t<e?-1:t>e?1:0}function J(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function $(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(){0}function X(){if(!b.getPlatform().base64Available)throw new S(_.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Z,tt,et=function(){function t(t){X(),this._binaryString=t}return t.fromBase64String=function(e){D("Blob.fromBase64String",arguments,1),x("Blob.fromBase64String","string",1,e),X();try{return new t(b.getPlatform().atob(e))}catch(t){throw new S(_.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(D("Blob.fromUint8Array",arguments,1),Y(),!(e instanceof Uint8Array))throw z("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return D("Blob.toBase64",arguments,0),X(),b.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){D("Blob.toUint8Array",arguments,0),Y();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return Q(this._binaryString,t._binaryString)},t}(),nt=E(et,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),rt=function(){function t(t,e){if(D("GeoPoint",arguments,2),x("GeoPoint","number",1,t),x("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new S(_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new S(_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return Q(this._lat,t._lat)||Q(this._long,t._long)},t}(),it=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new S(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new S(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new S(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new S(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Q(this.nanoseconds,t.nanoseconds):Q(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),ot=function(){return function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}(),st="(default)",at=function(){function t(t,e){this.projectId=t,this.database=e||st}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===st},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return Q(this.projectId,t.projectId)||Q(this.database,t.database)},t}(),ut=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&g("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&g("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):g("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,v(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return v(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return v(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return v(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new S(_.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(ut),ht=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(e,t),e.isValidIdentifier=function(t){return ht.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new S(_.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new S(_.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new S(_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new S(_.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(ut),ft=function(){function t(e){this.path=e,v(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ct.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ct.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ct(e.slice()))},t.fromPathString=function(e){return new t(ct.fromString(e))},t.EMPTY=new t(new ct([])),t}(),dt=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)},t}(),pt=function(t){function e(e,n,r,i,o){var s=t.call(this,e,n)||this;return s.data=r,s.proto=o,s.hasLocalMutations=!!i.hasLocalMutations,s.hasCommittedMutations=!!i.hasCommittedMutations,s}return a.__extends(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):g("Trying to compare documents on fields that don't exist")},e}(dt),mt=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return a.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(dt),yt=function(t){function e(e,n){return t.call(this,e,n)||this}return a.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(dt),gt=function(){function t(t,e){this.comparator=t,this.root=e||bt.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new vt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new vt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new vt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new vt(this.root,t,this.comparator,!0)},t}(),vt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){v(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),bt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw g("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw g("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw g("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),wt=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new bt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();bt.EMPTY=new wt,function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(Z||(Z={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(tt||(tt={}));var _t=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(tt.Estimate,n);case"previous":return new t(tt.Previous,n);case"none":case void 0:return new t(tt.Default,n);default:return g("fromSnapshotOptions() called with invalid options.")}},t}(),St=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return v(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),Q(this.typeOrder,t.typeOrder)},t}(),Et=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Z.NullValue,e.internalValue=null,e}return a.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(St),It=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.BooleanValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Q(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(St),Tt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.NumberValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue,r=t.internalValue,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.defaultCompareTo(t);var n,r},e}(St);function At(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Nt=function(t){function e(e){return t.call(this,e)||this}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&At(this.internalValue,t.internalValue)},e}(Tt),Ct=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return a.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&At(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Tt),Ot=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.StringValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?Q(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(St),Dt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.TimestampValue,n}return a.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof kt?-1:this.defaultCompareTo(t)},e}(St),kt=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Z.TimestampValue,r}return a.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===tt.Estimate?new Dt(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===tt.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Dt?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(St),Mt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.BlobValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(St),xt=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Z.RefValue,r}return a.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ft.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(St),Pt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.GeoPointValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(St),Rt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.ObjectValue,n}return a.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),s=Q(i.key,o.key)||i.value.compareTo(o.value);if(s)return s}return Q(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(v(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(v(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){v(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e&&n.internalValue.get(t)||void 0}),n},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new gt(Q)),e}(St),Lt=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Z.ArrayValue,n}return a.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return Q(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map(function(t){return t.toString()}).join(",")+"]"},e}(St),Bt=Number,Ut=Bt.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Ft=Bt.MAX_SAFE_INTEGER||Math.pow(2,53)-1,jt=Bt.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function qt(t){return null==t}function Vt(t){return jt(t)&&t<=Ft&&t>=Ut}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,zt=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[Zt]:this.memoizedOrderBy=[new Xt(t),Zt];else{v(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var s=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:$t.ASCENDING;this.memoizedOrderBy.push(s===$t.ASCENDING?Zt:te)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){v(null==this.getInequalityFilterField()||!(e instanceof Ht)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),v(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){v(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();this.isCollectionGroupQuery()&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}qt(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),qt(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.isKeyField()}return v(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!qt(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ht&&n.isInequality())return n.field}return null},t.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(t){return t instanceof Ht&&t.op===Gt.ARRAY_CONTAINS})},t.prototype.isDocumentQuery=function(){return ft.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):ft.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){v(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Wt=function(){function t(){}return t.create=function(t,e,n){if(n.isEqual(Et.INSTANCE)){if(e!==Gt.EQUAL)throw new S(_.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new Qt(t)}if(n.isEqual(Ct.NAN)){if(e!==Gt.EQUAL)throw new S(_.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new Jt(t)}return new Ht(t,e,n)},t}(),Gt=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;default:return g("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t}(),Ht=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return a.__extends(e,t),e.prototype.matches=function(t){if(this.field.isKeyField()){v(this.value instanceof xt,"Comparing on key, but filter value not a RefValue"),v(this.op!==Gt.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var e=this.value,n=ft.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},e.prototype.matchesValue=function(t){var e=this;return this.op===Gt.ARRAY_CONTAINS?t instanceof Lt&&void 0!==t.internalValue.find(function(t){return t.isEqual(e.value)}):this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case Gt.LESS_THAN:return t<0;case Gt.LESS_THAN_OR_EQUAL:return t<=0;case Gt.EQUAL:return 0===t;case Gt.GREATER_THAN:return t>0;case Gt.GREATER_THAN_OR_EQUAL:return t>=0;default:return g("Unknown relation op"+this.op)}},e.prototype.isInequality=function(){return this.op!==Gt.EQUAL&&this.op!==Gt.ARRAY_CONTAINS},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(Wt),Qt=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return a.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},e.prototype.toString=function(){return this.field.canonicalString()+" IS null"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}(Wt),Jt=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return a.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field),n=e&&e.value();return"number"==typeof n&&isNaN(n)},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}(Wt),$t=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),Yt=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){v(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())v(o instanceof xt,"Bound has a non-key value where the key path is being used."),n=ft.comparator(o.key,e.key);else{var s=e.field(i.field);v(void 0!==s,"Field should exist since document matched the orderBy already."),n=o.compareTo(s)}if(i.dir===$t.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),Xt=function(){function t(t,e){this.field=t,void 0===e&&(e=$t.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?pt.compareByKey(t,e):pt.compareByField(this.field,t,e);switch(this.dir){case $t.ASCENDING:return n;case $t.DESCENDING:return-1*n;default:return g("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Zt=new Xt(lt.keyField(),$t.ASCENDING),te=new Xt(lt.keyField(),$t.DESCENDING),ee=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new it(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new it(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(Kt||(Kt={}));var ne,re=function(){function t(t,e,n,r,i,o){void 0===i&&(i=ee.MIN),void 0===o&&(o=w()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),ie=function(){function t(t){this.comparator=t,this.data=new gt(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new oe(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new oe(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),oe=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),se=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new ie(lt.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.applyTo=function(t){var e=Rt.EMPTY;return this.fields.forEach(function(n){if(n.isEmpty())return t;var r=t.field(n);void 0!==r&&(e=e.set(n,r))}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),ae=function(){function t(t,e){this.field=t,this.transform=e}return Object.defineProperty(t.prototype,"isIdempotent",{get:function(){return this.transform.isIdempotent},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ue=function(){return function(t,e){this.version=t,this.transformResults=e}}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(ne||(ne={}));var ce=function(){function t(t,e){this.updateTime=t,this.exists=e,v(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof pt&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof pt:(v(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),he=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&v(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof pt?t.version:ee.MIN},t}(),le=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=ne.Set,i}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new pt(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=he.getPostMutationVersion(t);return new pt(this.key,r,this.value,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(he),fe=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=ne.Patch,o}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new yt(this.key,e.version);var n=this.patchDocument(t);return new pt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=he.getPostMutationVersion(t),i=this.patchDocument(t);return new pt(this.key,r,i,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof pt?t.data:Rt.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=void 0!==r?t.set(n,r):t.delete(n)}}),t},e}(he),de=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=ne.Transform,r.precondition=ce.exists(!0),r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),v(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new yt(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new pt(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new pt(this.key,r.version,o,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){for(var t=0,e=this.fieldTransforms;t<e.length;t++){if(!e[t].isIdempotent)return!1}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){var t=new ie(lt.comparator);return this.fieldTransforms.forEach(function(e){return t=t.add(e.field)}),new se(t)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&J(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){v(t instanceof pt,"Unknown MaybeDocument type "+t);var e=t;return v(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];v(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof pt&&(s=t.field(i.field)||null),n.push(o.applyToRemoteDocument(s,e[r]))}return n},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],s=o.transform,a=null;e instanceof pt&&(a=e.field(o.field)||null),n.push(s.applyToLocalView(a,t))}return n},e.prototype.transformObject=function(t,e){v(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(he),pe=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=ne.Delete,r}return a.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),v(null==e.transformResults,"Transform results received by DeleteMutation."),new mt(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&v(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new mt(this.key,ee.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){return null},enumerable:!0,configurable:!0}),e}(he),me=function(){function t(){this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return new kt(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),ye=function(){function t(t){this.elements=t,this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=be(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new Lt(e)},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),ge=function(){function t(t){this.elements=t,this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=be(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new Lt(e)},t.prototype.isEqual=function(e){return e instanceof t&&J(e.elements,this.elements)},t}(),ve=function(){function t(t){this.operand=t,this.isIdempotent=!1}return t.prototype.applyToLocalView=function(t,e){if(t instanceof Nt&&this.operand instanceof Nt){var n=t.internalValue+this.operand.internalValue;return new Nt(n)}if(t instanceof Tt){n=t.internalValue+this.operand.internalValue;return new Ct(n)}return this.operand},t.prototype.applyToRemoteDocument=function(t,e){return v(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function be(t){return t instanceof Lt?t.internalValue.slice():[]}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we,_e=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t){switch(t){case _.OK:return g("Treated status OK as error");case _.CANCELLED:case _.UNKNOWN:case _.DEADLINE_EXCEEDED:case _.RESOURCE_EXHAUSTED:case _.INTERNAL:case _.UNAVAILABLE:case _.UNAUTHENTICATED:return!1;case _.INVALID_ARGUMENT:case _.NOT_FOUND:case _.ALREADY_EXISTS:case _.PERMISSION_DENIED:case _.FAILED_PRECONDITION:case _.ABORTED:case _.OUT_OF_RANGE:case _.UNIMPLEMENTED:case _.DATA_LOSS:return!0;default:return g("Unknown status code: "+t)}}function Ee(t){if(void 0===t)return m("GRPC error has no .code"),_.UNKNOWN;switch(t){case we.OK:return _.OK;case we.CANCELLED:return _.CANCELLED;case we.UNKNOWN:return _.UNKNOWN;case we.DEADLINE_EXCEEDED:return _.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return _.RESOURCE_EXHAUSTED;case we.INTERNAL:return _.INTERNAL;case we.UNAVAILABLE:return _.UNAVAILABLE;case we.UNAUTHENTICATED:return _.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return _.INVALID_ARGUMENT;case we.NOT_FOUND:return _.NOT_FOUND;case we.ALREADY_EXISTS:return _.ALREADY_EXISTS;case we.PERMISSION_DENIED:return _.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return _.FAILED_PRECONDITION;case we.ABORTED:return _.ABORTED;case we.OUT_OF_RANGE:return _.OUT_OF_RANGE;case we.UNIMPLEMENTED:return _.UNIMPLEMENTED;case we.DATA_LOSS:return _.DATA_LOSS;default:return g("Unknown status code: "+t)}}function Ie(t){if(void 0===t)return we.OK;switch(t){case _.OK:return we.OK;case _.CANCELLED:return we.CANCELLED;case _.UNKNOWN:return we.UNKNOWN;case _.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case _.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case _.INTERNAL:return we.INTERNAL;case _.UNAVAILABLE:return we.UNAVAILABLE;case _.UNAUTHENTICATED:return we.UNAUTHENTICATED;case _.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case _.NOT_FOUND:return we.NOT_FOUND;case _.ALREADY_EXISTS:return we.ALREADY_EXISTS;case _.PERMISSION_DENIED:return we.PERMISSION_DENIED;case _.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case _.ABORTED:return we.ABORTED;case _.OUT_OF_RANGE:return we.OUT_OF_RANGE;case _.UNIMPLEMENTED:return we.UNIMPLEMENTED;case _.DATA_LOSS:return we.DATA_LOSS;default:return g("Unknown status code: "+t)}}!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(we||(we={}));
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Te=new gt(ft.comparator);function Ae(){return Te}function Ne(){return Ae()}var Ce=new gt(ft.comparator);function Oe(){return Ce}var De=new gt(ft.comparator);function ke(){return De}var Me=new ie(ft.comparator);function xe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Me,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Pe=new ie(Q);function Re(){return Pe}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le,Be,Ue=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ft.comparator(e.key,n.key)}:function(t,e){return ft.comparator(t.key,e.key)},this.keyedMap=Oe(),this.sortedSet=new gt(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Le||(Le={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(Be||(Be={}));var Fe,je=function(){function t(){this.changeMap=new gt(ft.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Le.Added&&n.type===Le.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Le.Metadata&&n.type!==Le.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Le.Modified&&n.type===Le.Modified?this.changeMap=this.changeMap.insert(e,{type:Le.Modified,doc:t.doc}):t.type===Le.Modified&&n.type===Le.Added?this.changeMap=this.changeMap.insert(e,{type:Le.Added,doc:t.doc}):t.type===Le.Removed&&n.type===Le.Added?this.changeMap=this.changeMap.remove(e):t.type===Le.Removed&&n.type===Le.Modified?this.changeMap=this.changeMap.insert(e,{type:Le.Removed,doc:n.doc}):t.type===Le.Added&&n.type===Le.Removed?this.changeMap=this.changeMap.insert(e,{type:Le.Modified,doc:t.doc}):g("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),qe=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Le.Added,doc:t})}),new t(e,n,Ue.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ve=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=Ke.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(ee.MIN,i,Re(),Ae(),xe())},t}(),Ke=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(w(),n,xe(),xe(),xe())},t}(),ze=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),We=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Fe||(Fe={}));var Ge=function(){return function(t,e,n,r){void 0===n&&(n=w()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),He=function(){function t(){this.pendingResponses=0,this.documentChanges=$e(),this._resumeToken=w(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=xe(),e=xe(),n=xe();return this.documentChanges.forEach(function(r,i){switch(i){case Le.Added:t=t.add(r);break;case Le.Modified:e=e.add(r);break;case Le.Removed:n=n.add(r);break;default:g("Encountered invalid change type: "+i)}}),new Ke(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=$e()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),Qe=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Ae(),this.pendingDocumentTargetMapping=Je(),this.pendingTargetResets=new ie(Q)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof pt?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof mt&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.removeDocumentFromTarget(r,t.key,t.newDoc)}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case Fe.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Fe.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Fe.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),v(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Fe.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Fe.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:g("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):A(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new ft(i.path);this.removeDocumentFromTarget(e,o,new mt(o,ee.forDeletedDoc()))}else v(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};A(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var s=new ft(o.query.path);null!==e.pendingDocumentUpdates.get(s)||e.targetContainsDocument(r,s)||e.removeDocumentFromTarget(r,s,new mt(s,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=xe();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===Kt.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Ve(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Ae(),this.pendingDocumentTargetMapping=Je(),this.pendingTargetResets=new ie(Q),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Le.Modified:Le.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Le.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new He),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new ie(Q),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;v(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new He,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function Je(){return new gt(ft.comparator)}function $e(){return new gt(ft.comparator)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye,Xe,Ze=((Ye={})[$t.ASCENDING.name]="ASCENDING",Ye[$t.DESCENDING.name]="DESCENDING",Ye),tn=((Xe={})[Gt.LESS_THAN.name]="LESS_THAN",Xe[Gt.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Xe[Gt.GREATER_THAN.name]="GREATER_THAN",Xe[Gt.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Xe[Gt.EQUAL.name]="EQUAL",Xe[Gt.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Xe),en=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nn(t,e){v(!qt(t),e+" is missing")}function rn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):g("can't parse "+t)}var on=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?_.UNKNOWN:Ee(t.code);return new S(e,t.message||"")},t.prototype.toInt32Value=function(t){return qt(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return qt(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);v(!!t,"Cannot deserialize null or undefined timestamp.");var e=rn(t.seconds||"0"),n=t.nanos||0;return new it(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=en.exec(t);if(v(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new it(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(v(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),et.fromBase64String(t)):(v(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),et.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return v(!!t,"Trying to deserialize version that isn't set"),ee.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=ct.fromString(t);return v(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return v(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),v(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ft(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?ct.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new ct(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new ct(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return v(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Et)return{nullValue:"NULL_VALUE"};if(t instanceof It)return{booleanValue:t.value()};if(t instanceof Nt)return{integerValue:""+t.value()};if(t instanceof Ct){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Ot?{stringValue:t.value()}:t instanceof Rt?{mapValue:this.toMapValue(t)}:t instanceof Lt?{arrayValue:this.toArrayValue(t)}:t instanceof Dt?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Pt?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Mt?{bytesValue:this.toBytes(t.value())}:t instanceof xt?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:g("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Et.INSTANCE;if("booleanValue"in t)return It.of(t.booleanValue);if("integerValue"in t)return new Nt(rn(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Ct.NAN;if("Infinity"===t.doubleValue)return Ct.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Ct.NEGATIVE_INFINITY}return new Ct(t.doubleValue)}if("stringValue"in t)return new Ot(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){nn(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new Lt(n.map(function(t){return e.fromValue(t)}))}if("timestampValue"in t)return nn(t.timestampValue,"timestampValue"),new Dt(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){nn(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Pt(new rt(r,i))}if("bytesValue"in t){nn(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Mt(o)}if("referenceValue"in t){nn(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),a=new at(s.get(1),s.get(3)),u=new ft(this.extractLocalPathFromResourceName(s));return new xt(a,u)}return g("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return v(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new pt(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Rt.EMPTY;return N(n,function(t,n){r=r.set(new lt([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){v(!!t.found,"Tried to deserialize a found document from a missing document."),nn(t.found.name,"doc.found.name"),nn(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new pt(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){v(!!t.missing,"Tried to deserialize a missing document from a found document."),v(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new mt(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):g("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Fe.Added:return"ADD";case Fe.Current:return"CURRENT";case Fe.NoChange:return"NO_CHANGE";case Fe.Removed:return"REMOVE";case Fe.Reset:return"RESET";default:return g("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof We)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof ze){if(t.newDoc instanceof pt){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof mt){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Ge){var n=void 0;return t.cause&&(n={code:Ie(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return g("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e;if("targetChange"in t){nn(t.targetChange,"targetChange");var n=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=t.targetChange.resumeToken||this.emptyByteString(),o=t.targetChange.cause,s=o&&this.fromRpcStatus(o);e=new Ge(n,r,i,s||null)}else if("documentChange"in t){nn(t.documentChange,"documentChange"),nn(t.documentChange.document,"documentChange.name"),nn(t.documentChange.document.name,"documentChange.document.name"),nn(t.documentChange.document.updateTime,"documentChange.document.updateTime");var a=t.documentChange,u=this.fromName(a.document.name),c=this.fromVersion(a.document.updateTime),h=this.fromFields(a.document.fields||{}),l=new pt(u,c,h,{},a.document),f=a.targetIds||[],d=a.removedTargetIds||[];e=new ze(f,d,l.key,l)}else if("documentDelete"in t){nn(t.documentDelete,"documentDelete"),nn(t.documentDelete.document,"documentDelete.document");var p=t.documentDelete;u=this.fromName(p.document),c=p.readTime?this.fromVersion(p.readTime):ee.forDeletedDoc(),l=new mt(u,c),d=p.removedTargetIds||[];e=new ze([],d,l.key,l)}else if("documentRemove"in t){nn(t.documentRemove,"documentRemove"),nn(t.documentRemove.document,"documentRemove");var m=t.documentRemove;u=this.fromName(m.document),d=m.removedTargetIds||[];e=new ze([],d,u,null)}else{if(!("filter"in t))return g("Unknown change type "+JSON.stringify(t));nn(t.filter,"filter"),nn(t.filter.targetId,"filter.targetId");var y=t.filter,v=y.count||0,b=new _e(v),w=y.targetId;e=new We(w,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Fe.NoChange:"ADD"===t?Fe.Added:"REMOVE"===t?Fe.Removed:"CURRENT"===t?Fe.Current:"RESET"===t?Fe.Reset:g("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return ee.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?ee.MIN:e.readTime?this.fromVersion(e.readTime):ee.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof le)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof pe)e={delete:this.toName(t.key)};else if(t instanceof fe)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof de))return g("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):ce.NONE;if(t.update){nn(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new fe(r,i,o,n)}return new le(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new pe(r,n)}if(t.transform){r=this.fromName(t.transform.document);var s=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return v(!0===n.exists,'Transforms only support precondition "exists == true"'),new de(r,s)}return g("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return v(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?ce.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ce.exists(t.exists):ce.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new ue(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(v(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof me)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ye)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof ge)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof ve)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw g("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=me.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new ye(r.map(function(t){return e.fromValue(t)}))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new ge(r.map(function(t){return e.fromValue(t)}))}else if("increment"in t){var i=this.fromValue(t.increment);v(i instanceof Tt,"NUMERIC_ADD transform requires a NumberValue"),n=new ve(i)}else g("Unknown transform proto: "+JSON.stringify(t));var o=lt.fromServerFormat(t.fieldPath);return new ae(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;v(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return zt.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(v(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(v(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){v(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new zt(e,i,a,s,u,c,h)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Kt.Listen:return null;case Kt.ExistenceFilterMismatch:return"existence-filter-mismatch";case Kt.LimboResolution:return"limbo-document";default:return g("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ht?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):g("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new Yt(r,n)},t.prototype.toDirection=function(t){return Ze[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return $t.ASCENDING;case"DESCENDING":return $t.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return tn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Gt.EQUAL;case"GREATER_THAN":return Gt.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Gt.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Gt.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Gt.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Gt.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return g("Unspecified relation");default:return g("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return lt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new Xt(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof Ht?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:g("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new Ht(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof Jt?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof Qt?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:g("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new Jt(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new Qt(n);case"OPERATOR_UNSPECIFIED":return g("Unspecified filter");default:return g("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return lt.fromServerFormat(t)});return se.fromArray(e)},t}(),sn=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),an=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(0)}},t.prototype.onNetworkUnavailable=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++){(0,e[t])(1)}},t}(),un=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){v(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){v(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){v(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){v(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){v(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){v(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),cn="Connection",hn={BatchGetDocuments:"batchGet",Commit:"commit"},ln="gl-js/ fire/"+h,fn=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=ln},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,s){var a=new u.XhrIo;a.listenOnce(u.EventType.COMPLETE,function(){try{switch(a.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var e=a.getResponseJson();p(cn,"XHR received:",JSON.stringify(e)),o(e);break;case u.ErrorCode.TIMEOUT:p(cn,'RPC "'+t+'" timed out'),s(new S(_.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=a.getStatus();p(cn,'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0?s(new S(function(t){switch(t){case 200:return _.OK;case 400:return _.INVALID_ARGUMENT;case 401:return _.UNAUTHENTICATED;case 403:return _.PERMISSION_DENIED;case 404:return _.NOT_FOUND;case 409:return _.ABORTED;case 416:return _.OUT_OF_RANGE;case 429:return _.RESOURCE_EXHAUSTED;case 499:return _.CANCELLED;case 500:return _.UNKNOWN;case 501:return _.UNIMPLEMENTED;case 503:return _.UNAVAILABLE;case 504:return _.DEADLINE_EXCEEDED;default:return t>=200&&t<300?_.OK:t>=400&&t<500?_.FAILED_PRECONDITION:t>=500&&t<600?_.INTERNAL:_.UNKNOWN}}(n),"Server responded with status "+a.getStatusText())):(p(cn,'RPC "'+t+'" failed'),s(new S(_.UNAVAILABLE,"Connection failed.")));break;default:g('RPC "'+t+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{p(cn,'RPC "'+t+'" completed.')}});var c=JSON.stringify(e);p(cn,"XHR sending: ",i+" "+c);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),a.send(i,"POST",c,h,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=u.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),c.isReactNative()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");p(cn,"Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),a=!1,h=!1,l=new un({sendFn:function(t){h?p(cn,"Not sending because WebChannel is closed:",t):(a||(p(cn,"Opening WebChannel transport."),s.open(),a=!0),p(cn,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u.WebChannel.EventType.OPEN,function(){h||p(cn,"WebChannel transport opened.")}),f(u.WebChannel.EventType.CLOSE,function(){h||(h=!0,p(cn,"WebChannel transport closed"),l.callOnClose())}),f(u.WebChannel.EventType.ERROR,function(t){h||(h=!0,p(cn,"WebChannel transport errored:",t),l.callOnClose(new S(_.UNAVAILABLE,"The operation could not be completed")))}),f(u.WebChannel.EventType.MESSAGE,function(t){if(!h){var e=t.data[0];v(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){p(cn,"WebChannel received error:",n);var r=n.status,i=function(t){var e=we[t];if(void 0!==e)return Ee(e)}(r),o=n.message;void 0===i&&(i=_.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),h=!0,l.callOnClose(new S(i,o)),s.close()}else p(cn,"WebChannel received:",e),l.callOnMessage(e)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=hn[t];v(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),dn=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return window},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new fn(t))},t.prototype.newConnectivityMonitor=function(){return void 0!==this.window?new an:new sn},t.prototype.newSerializer=function(t){return new on(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
b.setPlatform(new dn);
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pn,mn=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),yn=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection"}(pn||(pn={}));var gn=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new yn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S(_.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),vn=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw m("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),v(e>=0,"Attempted to schedule an operation with a negative delay of "+e),v(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=gn.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&g("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){v(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++){if(n[e].timerId===t)return!0}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){v(t===pn.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==pn.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);v(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),bn="",wn="",_n="",Sn="";function En(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Tn(e)),e=In(t.get(n),e);return Tn(e)}function In(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=bn+_n;break;case bn:n+=bn+Sn;break;default:n+=o}}return n}function Tn(t){return t+bn+wn}function An(t){var e=t.length;if(v(e>=2,"Invalid path "+t),2===e)return v(t.charAt(0)===bn&&t.charAt(1)===wn,"Non-empty path "+t+" had length 2"),ct.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf(bn,o);switch((s<0||s>n)&&g('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case wn:var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case _n:i+=t.substring(o,s),i+="\0";break;case Sn:i+=t.substring(o,s+1);break;default:g('Invalid encoded resource path: "'+t+'"')}o=s+2}return new ct(r)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nn=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r,v(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&v(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;v(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.applyToRemoteDocument(e,s)}}return e},t.prototype.applyToLocalView=function(t,e){e&&v(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(a=r[n]).key.isEqual(t)&&(e=a.applyToLocalView(e,e,this.localWriteTime))}for(var i=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},xe())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&J(this.mutations,t.mutations)&&J(this.baseMutations,t.baseMutations)},t}(),Cn=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){v(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=ke(),s=e.mutations,a=0;a<s.length;a++)o=o.insert(s[a].key,r[a].version);return new t(e,n,r,i,o)},t}(),On=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&g("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Dn=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return v(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pn(t).iterate({index:dr.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=xn(n),Ln(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=xn(e),Ln(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Rn(t),s=Pn(t);return s.add({}).next(function(a){v("number"==typeof a,"Auto-generated key is not a number");var u=new Nn(a,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u);i.documentKeysByBatchId[a]=u.keys();for(var h=[],l=0,f=r;l<f.length;l++){var d=f[l],p=pr.key(i.userId,d.key.path,a);h.push(s.put(c)),h.push(o.put(p,pr.PLACEHOLDER)),h.push(i.indexManager.addToCollectionParentIndex(t,d.key.path.popLast()))}return On.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Pn(t).get(e).next(function(t){return t?(v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?On.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this;return this.getMutationQueueMetadata(t).next(function(r){var i=e+1,o=IDBKeyRange.lowerBound([n.userId,i]),s=null;return Pn(t).iterate({index:dr.userMutationsIndex,range:o},function(t,e,r){e.userId===n.userId&&(v(e.batchId>=i,"Should have found mutation after "+i),s=n.serializer.fromDbMutationBatch(e)),r.done()}).next(function(){return s})})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pn(t).loadAll(dr.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=pr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Rn(t).iterate({range:i},function(r,i,s){var a=r[0],u=r[1],c=r[2],h=An(u);if(a===n.userId&&e.path.isEqual(h))return Pn(t).get(c).next(function(t){if(!t)throw g("Dangling document-mutation reference found: "+r+" which points to "+c);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ie(Q),i=[];return e.forEach(function(e){var o=pr.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Rn(t).iterate({range:s},function(t,i,o){var s=t[0],a=t[1],u=t[2],c=An(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(a)}),On.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;v(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=pr.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ie(Q);return Rn(t).iterate({range:s},function(t,e,o){var s=t[0],u=t[1],c=t[2],h=An(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,a)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Pn(t).get(e).next(function(t){if(null===t)throw g("Dangling document-mutation reference found, which points to "+e);v(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),On.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return Mn(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),On.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return On.resolve();var r=IDBKeyRange.lowerBound(pr.prefixForUser(e.userId)),i=[];return Rn(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=An(t[1]);i.push(o)}else r.done()}).next(function(){v(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return kn(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return Ln(t).get(this.userId).next(function(t){return t||new fr(e.userId,-1,"")})},t}();function kn(t,e,n){var r=pr.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Rn(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],a=t[1];t[2];o===e&&a===i&&(s=!0),r.done()}).next(function(){return s})}function Mn(t,e,n){var r=t.store(dr.store),i=t.store(pr.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.iterate({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){v(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=pr.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return On.waitFor(o).next(function(){return c})}function xn(t){return t instanceof Uint8Array?(v(!1,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function Pn(t){return Vr.getStore(t,dr.store)}function Rn(t){return Vr.getStore(t,pr.store)}function Ln(t){return Vr.getStore(t,fr.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bn,Un=1;!function(t){t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine"}(Bn||(Bn={}));var Fn=function(){function t(t,e){this.generatorId=t,v((t&Un)===t,"Generator ID "+t+" contains more than "+Un+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<Un,t},t.prototype.after=function(t){return this.seek(t+(1<<Un)),this.next()},t.prototype.seek=function(t){v((t&Un)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){return new t(Bn.QueryCache,2)},t.forSyncEngine=function(){return new t(Bn.SyncEngine)},t}(),jn=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return v(t.isAvailable(),"IndexedDB not supported in current environment."),p("SimpleDb","Opening database:",e),new On(function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onblocked=function(){o(new S(_.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new S(_.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},s.onupgradeneeded=function(t){p("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new Vn(s.transaction);r.createOrUpgrade(n,i,t.oldVersion,ur).next(function(){p("SimpleDb","Database upgrade to version "+ur+" complete")})}}).toPromise()},t.delete=function(t){return p("SimpleDb","Removing database:",t),zn(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if(null==window.indexedDB)return!1;if(void 0===window.navigator)return!1;var e=window.navigator.userAgent,n=t.getIOSVersion(e),r=0<n&&n<10,i=t.getAndroidVersion(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.getStore=function(t,e){return t.store(e)},t.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_")[0]:"-1";return Number(n)},t.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){var r=Vn.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),On.reject(t)}).toPromise();return i.catch(function(){}),r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),qn=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return zn(this.dbCursor.delete())},t}(),Vn=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new yn,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){e.completionDeferred.reject(t.target.error)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(p("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return v(!!e,"Object store not part of transaction: "+t),new Kn(e)},t}(),Kn=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(p("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(p("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),zn(n)},t.prototype.add=function(t){return p("SimpleDb","ADD",this.store.name,t,t),zn(this.store.add(t))},t.prototype.get=function(t){var e=this;return zn(this.store.get(t)).next(function(n){return void 0===n&&(n=null),p("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return p("SimpleDb","DELETE",this.store.name,t),zn(this.store.delete(t))},t.prototype.count=function(){return p("SimpleDb","COUNT",this.store.name),zn(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){p("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new On(function(n,r){e.onerror=function(t){r(t.target.error)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new On(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new qn(i),s=e(i.primaryKey,i.value,o);if(s instanceof On){var a=s.catch(function(t){return o.done(),On.reject(t)});n.push(a)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return On.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(v(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t){return new On(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wn=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=Fn.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return ee.fromTimestamp(new it(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return Qn(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Gn(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return v(e.targetCount>0,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Gn(t).iterate(function(s,a){var u=r.serializer.fromDbTarget(a);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return On.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return Gn(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return Hn(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Vr.getStore(n,_r.store)).put(_r.key,e);var n},t.prototype.saveQueryData=function(t,e){return Gn(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Gn(t).iterate({range:i,index:br.queryTargetsIndexName},function(t,r,i){var s=n.serializer.fromDbTarget(r);e.isEqual(s.query)&&(o=s,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Jn(t);return e.forEach(function(e){var s=En(e.path);i.push(o.put(new wr(n,s))),i.push(r.referenceDelegate.addReference(t,e))}),On.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Jn(t);return On.forEach(e,function(e){var o=En(e.path);return On.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Jn(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Jn(t),i=xe();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=An(t[1]),o=new ft(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=En(e.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),i=0;return Jn(t).iterate({index:wr.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return Gn(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function Gn(t){return Vr.getStore(t,br.store)}function Hn(t){return jn.getStore(t,_r.store).get(_r.key).next(function(t){return v(null!==t,"Missing metadata row."),t})}function Qn(t){return Hn(t).next(function(t){return t.highestListenSequenceNumber})}function Jn(t){return Vr.getStore(t,wr.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $n=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(s.isEqual(t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){N(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}})},t.prototype.isEmpty=function(){return C(this.inner)},t}(),Yn=function(){function t(){this.changes=Ae(),this.documentSizes=new $n(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges().get(e);return r?On.resolve(r):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return v(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Xn="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",Zn=function(){function t(t,e,n){this.serializer=t,this.indexManager=e,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=jn.getStore(t,Ir.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r=[];if(e.length>0){for(var i=nr(t),o=xe(),s=0,a=e;s<a.length;s++){var u=a[s],c=u.key,h=u.doc;r.push(i.put(ir(c),h)),o=o.add(c),r.push(this.indexManager.addToCollectionParentIndex(t,c.path.popLast()))}this.keepDocumentChangeLog&&r.push(rr(t).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(t,n))}return On.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=nr(t),r=ir(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return or(t)}):On.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return nr(t).get(ir(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return nr(t).get(ir(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:or(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Ne();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Ne(),i=new gt(ft.comparator);return this.forEachDbEntry(t,e,function(t,e){e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i=i.insert(t,or(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return On.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return nr(t).iterate({range:r},function(t,e,r){for(var s=ft.fromSegments(t);o&&ft.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this;v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=Oe(),i=e.path.length+1,o=e.path.toArray(),s=IDBKeyRange.lowerBound(o);return nr(t).iterate({range:s},function(t,o,s){if(t.length===i){var a=n.serializer.fromDbRemoteDocument(o);e.path.isPrefixOf(a.key.path)?a instanceof pt&&e.matches(a)&&(r=r.insert(a.key,a)):s.done()}}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;v(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=xe(),r=Ae(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,s=rr(t);return s.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(s).next(function(){return On.reject(new S(_.DATA_LOSS,Xn))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new mt(n,ee.forDeletedDoc());r=r.insert(n,e)}))}),On.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return rr(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new er(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return tr(t).get(vr.key).next(function(t){return v(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return tr(t).put(vr.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t){return Vr.getStore(t,vr.store)}var er=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentCache.serializer.toDbRemoteDocument(n),s=e.documentSizes.get(t);v(void 0!==s,"Attempting to change document "+t.toString()+" without having read it first");var a=or(o);r+=a-s,i.push({key:t,doc:o})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(Yn);function nr(t){return Vr.getStore(t,gr.store)}function rr(t){return Vr.getStore(t,Ir.store)}function ir(t){return t.path.toArray()}function or(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw g("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sr=function(){function t(){this.collectionParentIndex=new ar}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),On.resolve()},t.prototype.getCollectionParents=function(t,e){return On.resolve(this.collectionParentIndex.getEntries(e))},t}(),ar=function(){function t(){this.index={}}return t.prototype.add=function(t){v(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ie(ct.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.getEntries=function(t){return(this.index[t]||new ie(ct.comparator)).toArray()},t}(),ur=8,cr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;v(n<r&&n>=0&&r<=ur,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(function(t){t.createObjectStore(lr.store)}(t),function(t){t.createObjectStore(fr.store,{keyPath:fr.keyPath}),t.createObjectStore(dr.store,{keyPath:dr.keyPath,autoIncrement:!0}).createIndex(dr.userMutationsIndex,dr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(pr.store)}(t),Er(t),function(t){t.createObjectStore(gr.store)}(t));var o=On.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(wr.store),t.deleteObjectStore(br.store),t.deleteObjectStore(_r.store)}(t),Er(t)),o=o.next(function(){return function(t){var e=t.store(_r.store),n=new _r(0,0,ee.MIN.toTimestamp(),0);return e.put(_r.key,n)}(e)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return function(t,e){return e.store(dr.store).loadAll().next(function(n){t.deleteObjectStore(dr.store);var r=t.createObjectStore(dr.store,{keyPath:dr.keyPath,autoIncrement:!0});r.createIndex(dr.userMutationsIndex,dr.userMutationsKeyPath,{unique:!0});var i=e.store(dr.store),o=n.map(function(t){return i.put(t)});return On.waitFor(o)})}(t,e)})),o=o.next(function(){!function(t){t.createObjectStore(Tr.store,{keyPath:Tr.keyPath})}(t),function(t){t.createObjectStore(Ir.store,{keyPath:"id",autoIncrement:!0})}(t)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(e)})),n<6&&r>=6&&(o=o.next(function(){return function(t){t.createObjectStore(vr.store)}(t),i.addDocumentGlobal(e)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(e)})),n<8&&r>=8&&(o=o.next(function(){return i.createCollectionParentIndex(t,e)})),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(gr.store).iterate(function(t,n){e+=or(n)}).next(function(){var n=new vr(e);return t.store(vr.store).put(vr.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(fr.store),r=t.store(dr.store);return n.loadAll().next(function(n){return On.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(dr.userMutationsIndex,i).next(function(r){return On.forEach(r,function(r){v(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return Mn(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(wr.store),n=t.store(gr.store);return Qn(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new ct(n),s=function(t){return[0,En(t)]}(o);r.push(e.get(s).next(function(n){return n?On.resolve():function(n){return e.put(new wr(0,En(n),t))}(o)}))}).next(function(){return On.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Sr.store,{keyPath:Sr.keyPath});var n=e.store(Sr.store),r=new ar,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:En(i)})}};return e.store(gr.store).iterate({keysOnly:!0},function(t,e){var n=new ct(t);return i(n.popLast())}).next(function(){return e.store(pr.store).iterate({keysOnly:!0},function(t,e){t[0];var n=t[1],r=(t[2],An(n));return i(r.popLast())})})},t}();var hr=function(){return function(t,e){this.seconds=t,this.nanoseconds=e}}(),lr=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();var fr=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),dr=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();var pr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,En(e)]},t.key=function(t,e,n){return[t,En(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();var mr=function(){return function(t,e){this.path=t,this.readTime=e}}(),yr=function(){return function(t,e){this.path=t,this.version=e}}(),gr=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),vr=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();var br=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),wr=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,v(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),_r=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Sr=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function Er(t){t.createObjectStore(wr.store,{keyPath:wr.keyPath}).createIndex(wr.documentTargetsIndex,wr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(br.store,{keyPath:br.keyPath}).createIndex(br.queryTargetsIndexName,br.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_r.store)}var Ir=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}();var Tr=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}();var Ar=[fr.store,dr.store,pr.store,gr.store,br.store,lr.store,_r.store,wr.store].concat([Tr.store,Ir.store]).concat([vr.store]).concat([Sr.store]),Nr=function(){function t(){this.collectionParentsCache=new ar}return t.prototype.addToCollectionParentIndex=function(t,e){if(v(e.length%2==1,"Expected a collection path."),this.collectionParentsCache.add(e)){v(e.length>=1,"Invalid collection path.");var n=e.lastSegment(),r=e.popLast();return Cr(t).put({collectionId:n,parent:En(r)})}return On.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[$(e),""],!1,!0);return Cr(t).loadAll(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(An(o.parent))}return n})},t}();function Cr(t){return Vr.getStore(t,Sr.store)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Or=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=ft.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new mt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=ft.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version);return new yt(e,n)}return g("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof pt){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new gr(null,null,e,n)}if(t instanceof mt){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);n=t.hasCommittedMutations;return new gr(null,new mr(r,i),null,n)}if(t instanceof yt){r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return new gr(new yr(r,i),null,null,!0)}return g("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new hr(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new it(t.seconds,t.nanoseconds);return ee.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new dr(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=it.fromMillis(t.localWriteTimeMs);return new Nn(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(En(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=xe(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new ft(An(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new re(e,t.targetId,Kt.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){v(Kt.Listen===t.purpose,"Only queries with purpose "+Kt.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),t.resumeToken instanceof Uint8Array?(v(!1,"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new br(t.targetId,t.query.canonicalId(),r,n,t.sequenceNumber,e)},t}();
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Dr(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Q(n,i);return 0===s?Q(r,o):s}var kr=function(){function t(t){this.maxElements=t,this.buffer=new ie(Dr),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Dr(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Mr={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xr=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),Pr=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){v(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==xr.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;v(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(pn.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Kr)})},t}(),Rr=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return On.resolve(mn.INVALID);var r=new kr(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===xr.COLLECTION_DISABLED?(p("LruGarbageCollector","Garbage collection skipped; disabled"),On.resolve(Mr)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Mr):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,o,s,a,u,c,h,l=this;return s=Date.now(),this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>l.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)}).next(function(r){return n=r,u=Date.now(),l.removeTargets(t,n,e)}).next(function(e){return o=e,c=Date.now(),l.removeOrphanedDocuments(t,n)}).next(function(t){(h=Date.now(),f()<=i.DEBUG)&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-s)+"ms\n\tDetermined least recently used "+r+" in "+(u-a)+"ms\n\tRemoved "+o+" targets in "+(c-u)+"ms\n\tRemoved "+t+" documents in "+(h-c)+"ms\nTotal Duration: "+(h-s)+"ms");return On.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:t})})},t}(),Lr=function(){return function(){}}(),Br="IndexedDbPersistence",Ur="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fr="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",jr="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",qr=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return a.__extends(e,t),e}(Lr),Vr=function(){function t(e,n,r,i,o,s,a){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=a,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new S(_.UNIMPLEMENTED,jr);if(this.referenceDelegate=new Gr(this,s),this.dbName=e+t.MAIN_DATABASE,this.serializer=new Or(o),this.document=r.document,this.allowTabSynchronization=void 0!==a,this.queryCache=new Wn(this.referenceDelegate,this.serializer),this.indexManager=new Nr,this.remoteDocumentCache=new Zn(this.serializer,this.indexManager,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new S(_.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof qr)return jn.getStore(t.simpleDbTransaction,e);throw g("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,s){return a.__awaiter(this,void 0,void 0,function(){var u;return a.__generator(this,function(a){switch(a.label){case 0:return[4,(u=new t(e,n,r,i,o,s)).start()];case 1:return a.sent(),[2,u]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,s,u){return a.__awaiter(this,void 0,void 0,function(){var c;return a.__generator(this,function(a){switch(a.label){case 0:return[4,(c=new t(e,n,r,i,o,s,u)).start()];case 1:return a.sent(),[2,c]}})})},t.prototype.start=function(){var t=this;return v(!this.started,"IndexedDbPersistence double-started!"),v(null!==this.window,"Expected 'window' to be defined"),jn.openOrCreate(this.dbName,ur,new cr(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.startRemoteDocumentCache()}).then(function(){return t.simpleDb.runTransaction("readonly",[_r.store],function(e){return Qn(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new mn(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",Ar,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",Ar,function(e){return Wr(e).put(new Tr(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return zr(t).get(lr.key).next(function(t){return On.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return Wr(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return a.__awaiter(this,void 0,void 0,function(){var e,n,r=this;return a.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,Tr.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return On.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if((e=e.filter(function(t){return t.clientId!==r.clientId})).length>0){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(pn.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return zr(t).get(lr.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new S(_.FAILED_PRECONDITION,Fr);return!1}}return!(!e.networkEnabled||!e.inForeground)||Wr(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&p(Br,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,function(){var t=this;return a.__generator(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[lr.store,Tr.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[Tr.store],function(e){return Wr(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,jn.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return v(this.started,"Cannot initialize MutationQueue before persistence is started."),Dn.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getQueryCache=function(){return v(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return v(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return v(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;return p(Br,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",Ar,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw m("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new S(_.FAILED_PRECONDITION,Ur);return n(new qr(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new qr(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return zr(t).get(lr.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new S(_.FAILED_PRECONDITION,Fr)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new lr(this.clientId,this.allowTabSynchronization,Date.now());return zr(t).put(lr.key,e)},t.isAvailable=function(){return jn.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=zr(t);return n.get(lr.key).next(function(t){return e.isLocalClient(t)?(p(Br,"Releasing primary lease."),n.delete(lr.key)):On.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(m("Detected an update time that is in the future: "+t+" > "+n),!1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(v(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(v("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return p(Br,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return m(Br,"Failed to get zombied client id.",t),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){m("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Kr(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){if(!function(t){return t.code===_.FAILED_PRECONDITION&&t.message===Ur}(t))throw t;return p(Br,"Unexpectedly lost primary lease"),[2]})})}function zr(t){return t.store(lr.store)}function Wr(t){return t.store(Tr.store)}var Gr=function(){function t(t,e){this.db=t,this.garbageCollector=new Rr(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Hr(t,e)},t.prototype.removeReference=function(t,e){return Hr(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Hr(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?On.resolve(!0):function(t,e){var n=!1;return Ln(t).iterateSerial(function(r){return kn(t,r,e).next(function(t){return t&&(n=!0),On.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(t,function(s,a){if(a<=e){var u=n.isPinned(t,s).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,s).next(function(t){i+=t})});o.push(u)}}).next(function(){return On.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n,r=0,i=this.db.getRemoteDocumentCache();return On.waitFor([Jn(t).delete((n=e,[0,En(n.path)])),i.removeEntry(t,e).next(function(t){r+=t})]).next(function(){return r})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Hr(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=Jn(t),i=mn.INVALID;return r.iterate({index:wr.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==mn.INVALID&&e(new ft(An(n)),i),i=a,n=s):i=mn.INVALID}).next(function(){i!==mn.INVALID&&e(new ft(An(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Hr(t,e){return Jn(t).put(function(t,e){return new wr(0,En(t.path),e)}(e,t.currentSequenceNumber))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qr=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].applyToLocalView(e,t)}return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Ne();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].applyToLocalView(t,e)}r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Ae();return i.forEach(function(t,e){e||(e=new mt(t,ee.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ft(e)).next(function(t){var e=Oe();return t instanceof pt&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e){var n=this;v(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var r=e.collectionGroup,i=Oe();return this.indexManager.getCollectionParents(t,r).next(function(o){return On.forEach(o,function(o){var s=e.asCollectionQueryAtPath(o.child(r));return n.getDocumentsMatchingCollectionQuery(t,s).next(function(t){t.forEach(function(t,e){i=i.insert(t,e)})})}).next(function(){return i})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(t){for(var r=0,i=t;r<i.length;r++)for(var o=i[r],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key;if(e.path.isImmediateParentOf(c.path)){var h=n.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);n=l instanceof pt?n.insert(c,l):n.remove(c)}}}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t}(),Jr=function(){function t(){this.refsByKey=new ie($r.compareByKey),this.refsByTarget=new ie($r.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new $r(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new $r(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ft.EMPTY,r=new $r(n,t),i=new $r(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=ft.EMPTY,n=new $r(e,t),r=new $r(e,t+1),i=xe();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new $r(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),$r=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ft.comparator(t.key,e.key)||Q(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return Q(t.targetOrBatchId,e.targetOrBatchId)||ft.comparator(t.key,e.key)},t}(),Yr=function(){function t(t,e){this.persistence=t,this.localViewReferences=new Jr,this.queryDataByTarget={},v(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Qr(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new Qr(e.remoteDocuments,e.mutationQueue,e.persistence.getIndexManager()),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],s=xe(),a=0,u=r;a<u.length;a++){var c=u[a];i.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var d=0,p=t;d<p.length;d++){c=p[d];o.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){f=y[m];s=s.add(f.key)}}return e.localDocuments.getDocuments(n,s).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this,n=it.now(),r=t.reduce(function(t,e){return t.add(e.key)},xe());return this.persistence.runTransaction("Locally write mutations","readwrite",function(i){return e.localDocuments.getDocuments(i,r).next(function(r){for(var o=[],s=0,a=t;s<a.length;s++){var u=a[s],c=r.get(u.key);if(!u.isIdempotent){var h=u.fieldMask;if(h){var l=c instanceof pt?h.applyTo(c.data):Rt.EMPTY;o.push(new fe(u.key,l,h,ce.exists(!0)))}}}return e.mutationQueue.addMutationBatch(i,n,o,t).next(function(t){var e=t.applyToLocalDocumentSet(r);return{batchId:t.batchId,changes:e}})})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):On.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return v(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],s=xe();A(e.targetChanges,function(r,a){var u=n.queryDataByTarget[r];if(u){a.addedDocuments.forEach(function(t){s=s.add(t)}),a.modifiedDocuments.forEach(function(t){s=s.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,a.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,a.addedDocuments,r)}));var c=a.resumeToken;if(c.length>0){var h=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(h,u,a)&&o.push(n.queryCache.updateQueryData(i,u))}}});var a=Ae(),u=xe();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var h=t.get(u);null==h||c.version.isEqual(ee.MIN)||s.has(c.key)&&!h.hasPendingWrites||c.version.compareTo(h.version)>=0?(r.addEntry(c),a=a.insert(u,c)):p("LocalStore","Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(ee.MIN)){var h=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return v(c.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+c+" < "+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(h)}return On.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,a)})})},t.shouldPersistQueryData=function(t,e,n){return 0!==e.resumeToken.length&&(0===t.resumeToken.length||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0))},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return On.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),On.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,On.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new re(t,i,Kt.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return v(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){v(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,s=n.queryDataByTarget[o],a=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?On.resolve():On.forEach(a,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,s)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=On.resolve();return o.forEach(function(r){s=s.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,s=e.docVersions.get(r);v(null!==s,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(s)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):v(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),s.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),Xr=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=w(),this.batchesByDocumentKey=new ie($r.compareByKey)}return t.prototype.checkEmpty=function(t){return On.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");v(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return v(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,On.resolve()},t.prototype.getLastStreamToken=function(t){return On.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,On.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){v(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&v(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Nn(i,e,n,r);this.mutationQueue.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new $r(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return On.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return On.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return v(null!=n,"Failed to find local mutation batch."),On.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return On.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return On.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new $r(e,0),i=new $r(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){v(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);v(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),On.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ie(Q);return e.forEach(function(t){var e=new $r(t,0),i=new $r(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){v(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),On.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;ft.isDocumentKey(i)||(i=i.child(""));var o=new $r(new ft(i),0),s=new ie(Q);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.targetOrBatchId)),!0)},o),On.resolve(this.findMutationBatches(s))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;v(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return On.forEach(e.mutations,function(i){var o=new $r(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new $r(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return On.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&v(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),On.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return v(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return v(n.batchId===t,"If found batch must match"),n},t}(),Zr=function(){function t(t){this.persistence=t,this.queries=new $n(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=ee.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Jr,this.targetCount=0,this.targetIdGenerator=Fn.forQueryCache()}return t.prototype.getTargetCount=function(t){return On.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),On.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return On.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return On.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,On.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),On.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return v(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,On.resolve()},t.prototype.updateQueryData=function(t,e){return v(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),On.resolve()},t.prototype.removeQueryData=function(t,e){return v(this.targetCount>0,"Removing a target from an empty cache"),v(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,On.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(s,a){a.sequenceNumber<=e&&!n[a.targetId]&&(r.queries.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),On.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return On.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return On.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return g("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),On.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),On.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),On.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return On.resolve(n)},t.prototype.containsKey=function(t,e){return On.resolve(this.references.containsKey(e))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ti,ei=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new gt(ft.comparator),this.newDocumentChanges=xe(),this.size=0}return t.prototype.addEntries=function(t,e,n){for(var r=[],i=0,o=e;i<o.length;i++){var s=o[i],a=s.maybeDocument.key;this.docs=this.docs.insert(a,s),this.newDocumentChanges=this.newDocumentChanges.add(a),r.push(this.indexManager.addToCollectionParentIndex(t,a.path.popLast()))}return this.size+=n,On.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,On.resolve(n.size)):On.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return On.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return On.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=Ne();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),On.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=Ne(),i=new gt(ft.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),On.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){v(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=Oe(),r=new ft(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),s=o.key,a=o.value.maybeDocument;if(!e.path.isPrefixOf(s.path))break;a instanceof pt&&e.matches(a)&&(n=n.insert(a.key,a))}return On.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return On.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Ae();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new mt(t,ee.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=xe(),On.resolve(n)},t.prototype.newChangeBuffer=function(){return new ni(this.sizer,this)},t.prototype.getSize=function(t){return On.resolve(this.size)},t}(),ni=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return a.__extends(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentSizes.get(t);v(void 0!==o,"Attempting to change document "+t.toString()+" without having read it first");var s=e.sizer(n);r+=s-o,i.push({maybeDocument:n,size:s})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(Yn),ri=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new mn(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new Zr(this);this.indexManager=new sr,this.remoteDocumentCache=new ei(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new si(t,new Or(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new oi(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Xr(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;p("MemoryPersistence","Starting transaction:",t);var i=new ii(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return On.or((n=this.mutationQueues,r=[],N(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),ii=function(){return function(t){this.currentSequenceNumber=t}}(),oi=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),On.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),On.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),On.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return On.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?On.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return On.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return On.resolve(n.inMemoryPins.containsKey(e))}])},t}(),si=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new $n(function(t){return En(t.path)}),this.garbageCollector=new Rr(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return On.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return On.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?On.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?On.resolve():(r++,i.removeEntry(t,o).next())})}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),On.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),On.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),On.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),On.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw g("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return On.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return On.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return On.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),ai=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&p("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff"}(ti||(ti={}));var ui,ci,hi=1e3,li=6e4,fi=1.5,di=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=ti.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ai(t,e,hi,fi,li)}return t.prototype.isStarted=function(){return this.state===ti.Starting||this.state===ti.Open||this.state===ti.Backoff},t.prototype.isOpen=function(){return this.state===ti.Open},t.prototype.start=function(){this.state!==ti.Error?(v(this.state===ti.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(ti.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){v(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=ti.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.isOpen()?[2,this.close(ti.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(n){switch(n.label){case 0:return v(this.isStarted(),"Only started streams should be closed."),v(t===ti.Error||qt(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==ti.Error?this.backoff.reset():e&&e.code===_.RESOURCE_EXHAUSTED?(m(e.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===_.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;v(this.state===ti.Initial,"Must be in initial state to auth"),this.state=ti.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new S(_.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;v(this.state===ti.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return v(e.state===ti.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=ti.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;v(this.state===ti.Error,"Should only perform backoff when in Error state"),this.state=ti.Backoff,this.backoff.backoffAndRun(function(){return a.__awaiter(t,void 0,void 0,function(){return a.__generator(this,function(t){return v(this.state===ti.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=ti.Initial,this.start(),v(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return v(this.isStarted(),"Can't handle server close on non-started stream"),p("PersistentStream","close with error: "+t),this.stream=null,this.close(ti.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),pi=function(t){function e(e,n,r,i,o){var s=t.call(this,e,pn.ListenStreamConnectionBackoff,pn.ListenStreamIdle,n,r,o)||this;return s.serializer=i,s}return a.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(di),mi=function(t){function e(e,n,r,i,o){var s=t.call(this,e,pn.WriteStreamConnectionBackoff,pn.WriteStreamIdle,n,r,o)||this;return s.serializer=i,s.handshakeComplete_=!1,s}return a.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(v(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return v(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){v(this.isOpen(),"Writing handshake requires an opened stream"),v(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;v(this.isOpen(),"Writing mutations requires an opened stream"),v(this.handshakeComplete_,"Handshake must be complete before writing mutations"),v(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(di),yi=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new mi(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new pi(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Ae();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);v(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===_.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===_.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),gi=function(){function t(t){this.datastore=t,this.readVersions=ke(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e;if(t instanceof pt)e=t.version;else{if(!(t instanceof mt))throw g("Document in a transaction was a "+t.constructor.name);e=ee.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new S(_.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){t instanceof mt||t instanceof pt?e.recordVersion(t):g("Document in a transaction was a "+t.constructor.name)}),t})},t.prototype.write=function(t){if(this.committed)throw new S(_.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?ce.updateTime(e):ce.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(ee.forDeletedDoc()))throw new S(_.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?ce.updateTime(e):ce.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new pe(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,ee.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(ui||(ui={})),function(t){t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState"}(ci||(ci={}));
/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var vi=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=ui.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(ui.Unknown),v(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(pn.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,v(t.state===ui.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(ui.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===ui.Online?(this.setAndBroadcast(ui.Unknown),v(0===this.watchStreamFailures,"watchStreamFailures must be 0"),v(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(ui.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===ui.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(m(e),this.shouldWarnClientIsOffline=!1):p("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),bi="RemoteStore",wi=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return a.__awaiter(o,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(p(bi,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new vi(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(ui.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(ui.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(p(bi,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return p(bi,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(ui.Unknown),[2]}})})},t.prototype.listen=function(t){v(!I(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){v(I(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),C(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(ui.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){v(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Qe(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!C(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return a.__awaiter(this,void 0,void 0,function(){var t=this;return a.__generator(this,function(e){return A(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return void 0===t&&v(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(ui.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n;return a.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(ui.Online),t instanceof Ge&&t.state===Fe.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof ze?this.watchChangeAggregator.handleDocumentChange(t):t instanceof We?this.watchChangeAggregator.handleExistenceFilter(t):(v(t instanceof Ge,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(ee.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;v(!t.isEqual(ee.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return A(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:w()}),e.sendUnwatchRequest(t);var r=new re(n.query,t,Kt.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;v(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(e){return I(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e;return a.__generator(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){v(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){v(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(Kr)},t.prototype.onMutationResult=function(t,e){var n=this;v(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Cn.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return a.__awaiter(this,void 0,void 0,function(){var e=this;return a.__generator(this,function(n){return void 0===t&&v(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return Se(t.code)?(p(bi,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=w(),[2,this.localStore.setLastStreamToken(w()).catch(Kr)]):[2]})})},t.prototype.handleWriteError=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n=this;return a.__generator(this,function(r){return Se(i=t.code)&&i!==_.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new gi(this.datastore)},t.prototype.restartNetwork=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(ui.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(p(bi,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(ui.Unknown),e.label=4;case 4:return[2]}})})},t}(),_i=function(){return function(){this.listeners=[]}}(),Si=function(){function t(t){this.syncEngine=t,this.queries=new $n(function(t){return t.canonicalId()}),this.onlineState=ui.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new _i,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return a.__generator(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var s=0,a=o.listeners;s<a.length;s++){a[s].onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){i[r].applyOnlineStateChange(t)}})},t}(),Ei=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=ui.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(v(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Le.Metadata&&e.push(i)}t=new qe(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(v(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==ui.Offline;return this.options.waitForSyncWhenOnline&&n?(v(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===ui.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){v(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=qe.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Ii=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=xe(),i=xe(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case Le.Added:r=r.add(a.doc.key);break;case Le.Removed:i=i.add(a.doc.key)}}return new t(e,r,i)},t}(),Ti=function(){return function(t){this.key=t}}(),Ai=function(){return function(t){this.key=t}}(),Ni=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=xe(),this.mutatedKeys=xe(),this.documentSet=new Ue(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new je,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),h=e instanceof pt?e:null;h&&(v(t.isEqual(h.key),"Mismatching keys found in document changes: "+t+" != "+h.key),h=n.query.matches(h)?h:null);var l=!!c&&n.mutatedKeys.has(c.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;c&&h?c.data.isEqual(h.data)?l!==f&&(r.track({type:Le.Metadata,doc:h}),d=!0):n.shouldWaitForSyncedDocument(c,h)||(r.track({type:Le.Modified,doc:h}),d=!0,u&&n.query.docComparator(h,u)>0&&(a=!0)):!c&&h?(r.track({type:Le.Added,doc:h}),d=!0):c&&!h&&(r.track({type:Le.Removed,doc:c}),d=!0,u&&(a=!0));d&&(h?(s=s.add(h),o=f?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.hasLimit())for(;s.size>this.query.limit;){var c=s.last();s=s.delete(c.key),o=o.delete(c.key),r.track({type:Le.Removed,doc:c})}return v(!a||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:s,changeSet:r,needsRefill:a,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;v(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case Le.Added:return 1;case Le.Modified:case Le.Metadata:return 2;case Le.Removed:return 0;default:return g("Unknown ChangeType: "+t)}};return n(t)-n(e)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var s=e?this.updateLimboDocuments():[],a=0===this.limboDocuments.size&&this.current?Be.Synced:Be.Local,u=a!==this.syncState;return this.syncState=a,0!==o.length||u?{snapshot:new qe(this.query,t.documentSet,i,o,t.mutatedKeys,a===Be.Local,u,!1),limboChanges:s}:{limboChanges:s}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===ui.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new je,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return v(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=xe(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Ai(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Ti(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=xe();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return qe.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Be.Local)},t}();var Ci=function(){return function(t,e,n){this.query=t,this.targetId=e,this.view=n}}(),Oi=function(){return function(t){this.key=t}}(),Di=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new $n(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new gt(ft.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Jr,this.mutationUserCallbacks={},this.limboTargetIdGenerator=Fn.forSyncEngine(),this.isPrimary=void 0,this.onlineState=ui.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){v(null!==t,"SyncEngine listener cannot be null"),v(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o;return a.__generator(this,function(s){switch(s.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=s.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=s.sent(),this.isPrimary&&this.remoteStore.listen(i),s.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){var n=this,r=t.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(t.targetId).then(function(o){var s=new Ni(r,o),a=s.computeDocChanges(i),u=Ke.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&n.onlineState!==ui.Offline),c=s.applyChanges(a,!0===n.isPrimary,u);v(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),v(!!c.snapshot,"applyChanges for new view should always return a snapshot");var h=new Ci(r,t.targetId,s);return n.queryViewsByQuery.set(r,h),n.queryViewsByTarget[t.targetId]=h,c.snapshot})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){var e=this;return this.localStore.executeQuery(t.query).then(function(n){return e.localStore.remoteDocumentKeys(t.targetId).then(function(r){return a.__awaiter(e,void 0,void 0,function(){var e;return a.__generator(this,function(i){return e=t.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(t.targetId,e.limboChanges),[2,e]})})})})},t.prototype.unlisten=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n=this;return a.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),v(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(Kr)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.sharedClientState.addPendingMutation(t.batchId),n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),v(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!qt(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(t).then(function(n){return N(t.targetChanges,function(t,n){var r=e.limboResolutionsByTarget[t];r&&(v(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),n.addedDocuments.size>0?r.receivedDocument=!0:n.modifiedDocuments.size>0?v(r.receivedDocument,"Received change for limbo target document without add."):n.removedDocuments.size>0&&(v(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),e.emitNewSnapsAndNotifyLocalStore(n,t)}).catch(Kr)},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===ci.RemoteStore||!this.isPrimary&&e===ci.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);v(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,c=this;return a.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new gt(ft.comparator)).insert(r,new mt(r,ee.forDeletedDoc())),o=xe().add(r),s=new Ve(ee.MIN,{},new ie(Q),i,o),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return v(!!(u=this.queryViewsByTarget[t]),"Unknown targetId: "+t),[4,this.localStore.releaseQuery(u.query,!1).then(function(){return c.removeAndCleanupQuery(u)}).catch(Kr)];case 2:a.sent(),this.syncEngineListener.onWatchError(u.query,e),a.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r;return a.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(p("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):g("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){var e=this;this.assertSubscribed("applySuccessfulWrite()");var n=t.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.sharedClientState.updateMutationState(n,"acknowledged"),e.emitNewSnapsAndNotifyLocalStore(t)}).catch(Kr)},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(r){return n.sharedClientState.updateMutationState(t,"rejected",e),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(Kr)},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new gt(Q)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(v(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof Ti)this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i);else if(i instanceof Ai){p("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else g("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){p("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=zt.atPath(e.path);this.limboResolutionsByTarget[n]=new Oi(e),this.remoteStore.listen(new re(r,n,Kt.LimboResolution,mn.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return a.__generator(this,function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(s,a){i.push(Promise.resolve().then(function(){var e=a.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(a.query).then(function(t){return a.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[a.targetId],s=a.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(a.targetId,s.limboChanges),s.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(a.targetId,s.snapshot.fromCache?"not-current":"current"),n.push(s.snapshot);var u=Ii.fromSnapshot(a.targetId,s.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return s.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return s.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){v(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n;return a.__generator(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return a.__awaiter(this,void 0,void 0,function(){var e,n,r,i,o,s,u,c=this;return a.__generator(this,function(a){switch(a.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return a.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=a.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],u=Promise.resolve(),A(this.queryViewsByTarget,function(t,e){c.sharedClientState.isLocalQueryTarget(t)?s.push(t):u=u.then(function(){return c.unlisten(e.query)}),c.remoteStore.unlisten(e.targetId)}),[4,u]);case 4:return a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(s)];case 5:return a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;A(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new gt(ft.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){for(var e=this,n=Promise.resolve(),r=[],i=[],o=function(t){n=n.then(function(){return a.__awaiter(e,void 0,void 0,function(){var e,n,o,s;return a.__generator(this,function(a){switch(a.label){case 0:return(n=this.queryViewsByTarget[t])?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return a.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return e=a.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return(o=a.sent()).snapshot&&i.push(o.snapshot),[3,8];case 4:return v(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(t)];case 5:return v(!!(s=a.sent()),"Query data for target "+t+" not found"),[4,this.localStore.allocateQuery(s)];case 6:return e=a.sent(),[4,this.initializeViewAndComputeSnapshot(e,!1)];case 7:a.sent(),a.label=8;case 8:return r.push(e),[2]}})})})},s=0,u=t;s<u.length;s++){o(u[s])}return n.then(function(){return e.syncEngineListener.onWatchChange(i),r})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return a.__awaiter(this,void 0,void 0,function(){var r,i=this;return a.__generator(this,function(o){switch(o.label){case 0:if(this.isPrimary)return p("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,5];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return a.__awaiter(i,void 0,void 0,function(){var r;return a.__generator(this,function(i){switch(i.label){case 0:return r=Ve.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(t){return a.__awaiter(i,void 0,void 0,function(){var e;return a.__generator(this,function(n){switch(n.label){case 0:return function(t){return t.code===_.DATA_LOSS&&t.message===Xn}(t)?(e=[],A(this.queryViewsByTarget,function(t){return e.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e)]):[3,2];case 1:return n.sent(),[3,3];case 2:throw t;case 3:return[2]}})})})];case 2:return r=this.queryViewsByTarget[t],this.removeAndCleanupQuery(r),[4,this.localStore.releaseQuery(r.query,!0)];case 3:return o.sent(),this.syncEngineListener.onWatchError(r.query,n),[3,5];case 4:g("Unexpected target state: "+e),o.label=5;case 5:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return a.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,d.label=1;case 1:return n<r.length?(l=r[n],v(!this.queryViewsByTarget[l],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(l)]):[3,6];case 2:return v(!!(i=d.sent()),"Query data for active target "+l+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=d.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:d.sent(),this.remoteStore.listen(o),d.label=5;case 5:return n++,[3,1];case 6:s=function(t){var e;return a.__generator(this,function(n){switch(n.label){case 0:return(e=u.queryViewsByTarget[t])?[4,u.localStore.releaseQuery(e.query,!1).then(function(){f.remoteStore.unlisten(t),f.removeAndCleanupQuery(e)}).catch(Kr)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},u=this,c=0,h=e,d.label=7;case 7:return c<h.length?(l=h[c],[5,s(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?xe().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:xe()},t}(),ki=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Mi="SharedClientState",xi="firestore_clients",Pi="firestore_mutations",Ri="firestore_targets",Li="firestore_online_state",Bi="firestore_sequence_number",Ui=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,v(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new S(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(m(Mi,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fi=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,v(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new S(r.error.code,r.error.message)),i?new t(e,r.state,o):(m(Mi,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ji=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Re(),s=0;i&&s<r.activeTargetIds.length;++s)i=Vt(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(m(Mi,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),qi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&void 0!==ui[n.onlineState]&&"string"==typeof n.clientId?new t(n.clientId,ui[n.onlineState]):(m(Mi,"Failed to parse online state: "+e),null)},t}(),Vi=function(){function t(){this.activeTargetIds=Re()}return t.prototype.addQueryTarget=function(t){v(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ki=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new S(_.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Bi+"_"+r,this.activeClients[this.localClientId]=new Vi,this.clientStateKeyRe=new RegExp("^"+xi+"_"+s+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Pi+"_"+s+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Ri+"_"+s+"_(\\d+)$"),this.onlineStateKey=Li+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return a.__awaiter(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a.__generator(this,function(a){switch(a.label){case 0:return v(!this.started,"WebStorageSharedClientState already started"),v(null!==this.syncEngine,"syncEngine property must be set before calling start()"),v(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=ji.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),c=0,h=this.earlyEvents;c<h.length;c++)l=h[c],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return f.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=Re();return N(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Fi.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return p(Mi,"READ",t,e),e},t.prototype.setItem=function(t,e){p(Mi,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){p(Mi,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(p(Mi,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return a.__awaiter(e,void 0,void 0,function(){var e,n,r,i,o,s;return a.__generator(this,function(a){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(v(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(t){var e=mn.INVALID;if(null!=t)try{var n=JSON.parse(t);v("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){m(Mi,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==mn.INVALID&&this.sequenceNumberHandler(s));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Ui(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:ui[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Fi(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return v(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),xi+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return Ri+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Pi+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return v(null!==n,"Cannot parse client state key '"+t+"'"),ji.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);v(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ui.fromWebStorageEntry(new ki(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);v(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Fi.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return qi.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return t.user.uid!==this.currentUser.uid?(p(Mi,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],s=[];return i.forEach(function(t){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(e){return i.has(t)||s.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,s)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}();var zi=function(){function t(){this.localState=new Vi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new Vi,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),Wi=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return xr.withCacheSize(this.cacheSizeBytes)},t}(),Gi=function(){return function(){}}(),Hi=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=H.newId(),this._clientShutdown=!1}return t.prototype.start=function(t){var e=this;this.verifyNotShutdown();var n=new yn,r=new yn,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof Wi?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof S?t.code===_.FAILED_PRECONDITION||t.code===_.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.verifyNotShutdown=function(){if(this._clientShutdown)throw new S(_.FAILED_PRECONDITION,"The client has already been shutdown.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Vr.buildStoragePrefix(this.databaseInfo),i=new on(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return a.__awaiter(n,void 0,void 0,function(){var n,o;return a.__generator(this,function(s){switch(s.label){case 0:if(e.synchronizeTabs&&!Ki.isAvailable(this.platform))throw new S(_.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.synchronizeTabs?(this.sharedClientState=new Ki(this.asyncQueue,this.platform,r,this.clientId,t),[4,Vr.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=s.sent(),[3,4];case 2:return this.sharedClientState=new zi,[4,Vr.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=s.sent(),s.label=4;case 4:return this.persistence=n,[2,n.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=ri.createEagerPersistence(this.clientId),this.sharedClientState=new zi,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return p("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return a.__awaiter(n,void 0,void 0,function(){var n,i,o,s,u,c=this;return a.__generator(this,function(h){switch(h.label){case 0:return this.localStore=new Yr(this.persistence,t),e&&(this.lruScheduler=new Pr(e,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),i=this.platform.newSerializer(this.databaseInfo.databaseId),o=new yi(this.asyncQueue,r,this.credentials,i),s=function(t){return c.syncEngine.applyOnlineStateChange(t,ci.RemoteStore)},u=function(t){return c.syncEngine.applyOnlineStateChange(t,ci.SharedClientState)},this.remoteStore=new wi(this.localStore,o,this.asyncQueue,s,n),this.syncEngine=new Di(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new Si(this.syncEngine),[4,this.sharedClientState.start()];case 1:return h.sent(),[4,this.remoteStore.start()];case 2:return h.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return a.__awaiter(c,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return h.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return a.__awaiter(c,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,this.shutdown()];case 1:return t.sent(),[2]}})})})];case 4:return h.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),p("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.enqueue(function(){return a.__awaiter(t,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this._clientShutdown?[3,4]:(this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()]);case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:t.sent(),this.credentials.removeChangeListener(),this._clientShutdown=!0,t.label=4;case 4:return[2]}})})})},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotShutdown();var i=new Ei(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.verifyNotShutdown(),this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof pt)return t;if(t instanceof mt)return null;throw new S(_.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=xe(),r=new Ni(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this;this.verifyNotShutdown();var n=new yn;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},Object.defineProperty(t.prototype,"clientShutdown",{get:function(){return this._clientShutdown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return a.__awaiter(e,void 0,void 0,function(){return a.__generator(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Qi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Ji=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+G(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(x("FieldPath","string",n,t[n]),0===t[n].length)throw new S(_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw z("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(lt.keyField().canonicalString()),t}(),$i=new RegExp("[~\\*/\\[\\]]");
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Yi=function(){return function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}}(),Xi=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(ki.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){v(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),Zi=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;v(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new S(_.ABORTED,"getToken aborted due to token change.");return n?(v("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Yi(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){v(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){v(null!=this.tokenListener,"removeChangeListener() called twice"),v(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return v(null===t||"string"==typeof t,"Received invalid UID: "+t),new ki(t)},t}(),to=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=ki.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),eo=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new to(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(ki.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function no(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,["next","error","complete"])}var ro,io=function(){function t(t){this._methodName=t}return t.delete=function(){return O("FieldValue.delete",arguments),oo.instance},t.serverTimestamp=function(){return O("FieldValue.serverTimestamp",arguments),so.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return k("FieldValue.arrayUnion",arguments,1),new ao(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return k("FieldValue.arrayRemove",arguments,1),new uo(t)},t.increment=function(t){return x("FieldValue.increment","number",1,t),D("FieldValue.increment",arguments,1),new co(t)},t.prototype.isEqual=function(t){return this===t},t}(),oo=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return a.__extends(e,t),e.instance=new e,e}(io),so=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return a.__extends(e,t),e.instance=new e,e}(io),ao=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return a.__extends(e,t),e}(io),uo=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return a.__extends(e,t),e}(io),co=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return a.__extends(e,t),e}(io),ho=E(io,"Use FieldValue.<field>() instead."),lo=/^__.*__$/,fo=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new fe(t,this.data,this.fieldMask,e)):n.push(new le(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new de(t,this.fieldTransforms)),n},t}(),po=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new fe(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new de(t,this.fieldTransforms)),n},t}();function mo(t){switch(t){case ro.Set:case ro.MergeSet:case ro.Update:return!0;case ro.Argument:return!1;default:throw g("Unexpected case for UserDataSource: "+t)}}!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument"}(ro||(ro={}));var yo=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new S(_.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(mo(this.dataSource)&&lo.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),go=function(){return function(t,e){this.databaseId=t,this.key=e}}(),vo=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new yo(ro.Set,t,lt.EMPTY_PATH);wo("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new fo(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new yo(ro.MergeSet,t,lt.EMPTY_PATH);wo("Data must be an object, but it was:",r,e);var i,o,s=this.parseData(e,r);if(n){for(var a=new ie(lt.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof Ji)l=h._internalPath;else{if("string"!=typeof h)throw g("Expected stringOrFieldPath to be a string or a FieldPath");l=So(t,h)}if(!r.contains(l))throw new S(_.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");a=a.add(l)}i=se.fromSet(a),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=se.fromArray(r.fieldMask),o=r.fieldTransforms;return new fo(s,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new yo(ro.Update,t,lt.EMPTY_PATH);wo("Data must be an object, but it was:",r,e);var i=new ie(lt.comparator),o=Rt.EMPTY;N(e,function(e,s){var a=So(t,e),u=r.childContextForFieldPath(a);if((s=n.runPreConverter(s,u))instanceof oo)i=i.add(a);else{var c=n.parseData(s,u);null!=c&&(i=i.add(a),o=o.set(a,c))}});var s=se.fromSet(i);return new po(o,s,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new yo(ro.Update,t,lt.EMPTY_PATH),o=[_o(t,e)],s=[n];if(r.length%2!=0)throw new S(_.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<r.length;a+=2)o.push(_o(t,r[a])),s.push(r[a+1]);var u=new ie(lt.comparator),c=Rt.EMPTY;for(a=0;a<o.length;++a){var h=o[a],l=i.childContextForFieldPath(h),f=this.runPreConverter(s[a],l);if(f instanceof oo)u=u.add(h);else{var d=this.parseData(f,l);null!=d&&(u=u.add(h),c=c.set(h,d))}}var p=se.fromSet(u);return new po(c,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new yo(ro.Argument,t,lt.EMPTY_PATH),r=this.parseData(e,n);return v(null!=r,"Parsed data should not be null."),v(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Eo(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(bo(t=this.runPreConverter(t,e)))return wo("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof io)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new gt(Q);return C(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):N(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Rt(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],a=this.parseData(s,e.childContextForArray(r));null==a&&(a=Et.INSTANCE),n.push(a),r++}return new Lt(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!mo(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof oo){if(e.dataSource!==ro.MergeSet)throw e.dataSource===ro.Update?(v(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof so)e.fieldTransforms.push(new ae(e.path,me.instance));else if(t instanceof ao){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new ye(n);e.fieldTransforms.push(new ae(e.path,r))}else if(t instanceof uo){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new ge(n);e.fieldTransforms.push(new ae(e.path,i))}else if(t instanceof co){var o=this.parseQueryValue("FieldValue.increment",t._operand),s=new ve(o);e.fieldTransforms.push(new ae(e.path,s))}else g("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Et.INSTANCE;if("number"==typeof t)return Vt(t)?new Nt(t):new Ct(t);if("boolean"==typeof t)return It.of(t);if("string"==typeof t)return new Ot(t);if(t instanceof Date)return new Dt(it.fromDate(t));if(t instanceof it)return new Dt(new it(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof rt)return new Pt(t);if(t instanceof et)return new Mt(t);if(t instanceof go)return new xt(t.databaseId,t.key);throw e.createError("Unsupported field value: "+q(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new yo(ro.Argument,t,lt.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function bo(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof it||t instanceof rt||t instanceof et||t instanceof go||t instanceof io)}function wo(t,e,n){if(!bo(n)||!j(n)){var r=q(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function _o(t,e){if(e instanceof Ji)return e._internalPath;if("string"==typeof e)return So(t,e);throw new S(_.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function So(t,e){try{return function(t){if(t.search($i)>=0)throw new S(_.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ji.bind.apply(Ji,[void 0].concat(t.split("."))))}catch(e){throw new S(_.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=Eo(e);throw new S(_.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Eo(t){return t instanceof Error?t.message:t.toString()}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Io="firestore.googleapis.com",To=!0,Ao=!0,No=!1,Co=xr.COLLECTION_DISABLED,Oo=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new S(_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Io,this.ssl=To}else R("settings","non-empty string","host",t.host),this.host=t.host,L("settings","boolean","ssl",t.ssl),this.ssl=T(t.ssl,To);if(K("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),L("settings","object","credentials",t.credentials),this.credentials=t.credentials,L("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?m("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&m("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=T(t.timestampsInSnapshots,Ao),L("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=xr.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Co&&t.cacheSizeBytes<xr.MINIMUM_CACHE_SIZE_BYTES)throw new S(_.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+xr.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}L("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0===t.experimentalForceLongPolling?No:t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Do=function(){return function(){}}(),ko=function(){function t(e){var n=this;this._queue=new vn,this.INTERNAL={delete:function(){return a.__awaiter(n,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.shutdown()];case 1:return t.sent(),[2]}})})}};var r=new Do;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Zi(i)}else{var o=e;if(!o.projectId)throw new S(_.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new at(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new Xi}r.settings=new Oo({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(D("Firestore.settings",arguments,1),x("Firestore.settings","object",1,t),I(t,"persistence"))throw new S(_.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Oo(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new S(_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=function(t){if(!t)return new Xi;switch(t.type){case"gapi":var e=t.client;return v(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new eo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new S(_.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new S(_.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&m("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=T(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new Wi(this._config.settings.cacheSizeBytes,e))},t.prototype._clearPersistence=function(){var t=this,e=Vr.buildStoragePrefix(this.makeDatabaseInfo()),n=new yn;return this._queue.enqueueAndForget(function(){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientShutdown)throw new S(_.FAILED_PRECONDITION,"Persistence cannot be cleared while this firestore instance is running.");return[4,Vr.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Gi),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new ot(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl,this._config.settings.forceLongPolling)},t.prototype.configureClient=function(t){var e=this;v(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),v(!this._firestoreClient,"configureClient() called multiple times");var n=this.makeDatabaseInfo();return this._dataConverter=new vo(function(t){if(t instanceof Po){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new S(_.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new go(e._config.databaseId,t._key)}return t}),this._firestoreClient=new Hi(b.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!I(e,"projectId"))throw new S(_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new S(_.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new at(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new S(_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return D("Firestore.collection",arguments,1),x("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new jo(ct.fromString(t),this)},t.prototype.doc=function(t){return D("Firestore.doc",arguments,1),x("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Po.forPath(ct.fromString(t),this)},t.prototype.collectionGroup=function(t){if(D("Firestore.collectionGroup",arguments,1),x("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new S(_.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Uo(new zt(ct.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return D("Firestore.runTransaction",arguments,1),x("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Mo(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new xo(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(f()){case i.DEBUG:return"debug";case i.ERROR:return"error";case i.SILENT:return"silent";default:return g("Unknown log level: "+f())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(D("Firestore.setLogLevel",arguments,1),x("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":d(i.DEBUG);break;case"error":d(i.ERROR);break;case"silent":d(i.SILENT);break;default:throw new S(_.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Mo=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;D("Transaction.get",arguments,1);var n=zo("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return g("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof mt)return new Lo(e._firestore,n._key,null,!1,!1);if(r instanceof pt)return new Lo(e._firestore,n._key,r,!1,!1);throw g("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){M("Transaction.set",arguments,2,3);var r=zo("Transaction.set",t,this._firestore),i=(n=qo("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Ji?(k("Transaction.update",arguments,3),r=zo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(D("Transaction.update",arguments,2),r=zo("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){D("Transaction.delete",arguments,1);var e=zo("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),xo=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){M("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=zo("WriteBatch.set",t,this._firestore),i=(n=qo("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,ce.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.verifyNotCommitted(),"string"==typeof e||e instanceof Ji?(k("WriteBatch.update",arguments,3),r=zo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(D("WriteBatch.update",arguments,2),r=zo("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,ce.exists(!0))),this},t.prototype.delete=function(t){D("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=zo("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new pe(e._key,ce.NONE)),this},t.prototype.commit=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new S(_.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Po=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new S(_.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ft(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new jo(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(D("DocumentReference.collection",arguments,1),x("DocumentReference.collection","non-empty string",1,t),!t)throw new S(_.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ct.fromString(t);return new jo(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw z("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){M("DocumentReference.set",arguments,1,2);var n=(e=qo("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,ce.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Ji?(k("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(D("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,ce.exists(!0)))},t.prototype.delete=function(){return D("DocumentReference.delete",arguments,0),this._firestoreClient.write([new pe(this._key,ce.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||no(t[i])||(K("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),L("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return no(t[i])?n=t[i]:(x("DocumentReference.onSnapshot","function",i,t[i]),P("DocumentReference.onSnapshot","function",i+1,t[i+1]),P("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Qi({next:function(t){if(e.next){v(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Lo(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(zt.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return M("DocumentReference.get",arguments,0,1),Ko("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new Lo(e.firestore,e._key,t,!0,t instanceof pt&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new S(_.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new S(_.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),Ro=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Lo=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return M("DocumentSnapshot.data",arguments,0,1),t=Vo("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,_t.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(M("DocumentSnapshot.get",arguments,1,2),e=Vo("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(_o("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,_t.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Po(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Ro(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw z("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof Rt)return this.convertObject(t,e);if(t instanceof Lt)return this.convertArray(t,e);if(t instanceof xt){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||m("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Po(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Bo=function(t){function e(e,n,r,i,o){return t.call(this,e,n,r,i,o)||this}return a.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return v("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Lo),Uo=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){D("Query.where",arguments,3),V("Query.where",3,r);var i;!function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new S(_.INVALID_ARGUMENT,"Invalid value "+q(r)+" provided to function "+t+"() for its "+W(n)+" argument. Acceptable values: "+e.join(", "))}("Query.where",["<","<=","==",">=",">","array-contains"],2,n);var o=_o("Query.where",e),s=Gt.fromString(n);if(o.isKeyField()){if(s===Gt.ARRAY_CONTAINS)throw new S(_.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"==typeof r){if(""===r)throw new S(_.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==r.indexOf("/"))throw new S(_.INVALID_ARGUMENT,"Invalid third parameter to Query.where(). When querying a collection by FieldPath.documentId(), the value provided must be a plain document ID, but '"+r+"' contains a slash.");var a=this._query.path.child(ct.fromString(r));if(!ft.isDocumentKey(a))throw new S(_.INVALID_ARGUMENT,"Invalid third parameter to Query.where(). When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+a+"' is not because it has an odd number of segments ("+a.length+").");i=new xt(this.firestore._databaseId,new ft(a))}else{if(!(r instanceof Po))throw new S(_.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+q(r)+".");var u=r;i=new xt(this.firestore._databaseId,u._key)}}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var c=Wt.create(o,s,i);return this.validateNewFilter(c),new t(this._query.addFilter(c),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(M("Query.orderBy",arguments,1,2),P("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=$t.ASCENDING;else{if("desc"!==n)throw new S(_.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=$t.DESCENDING}if(null!==this._query.startAt)throw new S(_.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new S(_.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=_o("Query.orderBy",e),o=new Xt(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(D("Query.limit",arguments,1),x("Query.limit","number",1,e),e<=0)throw new S(_.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];k("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];k("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];k("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];k("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw z("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(V(t,1,e),e instanceof Lo){if(n.length>0)throw new S(_.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new S(_.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var s=o[i];if(s.field.isKeyField())r.push(new xt(this.firestore._databaseId,e.key));else{var a=e.field(s.field);if(a instanceof kt)throw new S(_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(void 0===a){var u=s.field.canonicalString();throw new S(_.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Yt(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new S(_.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.isKeyField()){if("string"!=typeof s)throw new S(_.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this._query.isCollectionGroupQuery()&&-1!==s.indexOf("/"))throw new S(_.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this._query.path.child(ct.fromString(s));if(!ft.isDocumentKey(a))throw new S(_.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new ft(a);i.push(new xt(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,s);i.push(c)}}return new Yt(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];M("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||no(t[i])||(K("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),L("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),no(t[i])?n=t[i]:(x("Query.onSnapshot","function",i,t[i]),P("Query.onSnapshot","function",i+1,t[i+1]),P("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Qi({next:function(t){e.next&&e.next(new Fo(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),s=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(s)}},t.prototype.get=function(t){var e=this;return M("Query.get",arguments,0,1),Ko("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Fo(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new S(_.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof Ht)if(t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new S(_.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}else if(t.op===Gt.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new S(_.INVALID_ARGUMENT,"Invalid query. Queries only support a single array-contains filter.")},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new S(_.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Fo=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Ro(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;M("QuerySnapshot.forEach",arguments,1,2),x("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Uo(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(K("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),L("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new S(_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Bo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return v(e.type===Le.Added,"Invalid event type for first snapshot"),v(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Le.Metadata}).map(function(e){var r=new Bo(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,s=-1;return e.type!==Le.Added&&(v((i=o.indexOf(e.doc.key))>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Le.Removed&&(o=o.add(e.doc),s=o.indexOf(e.doc.key)),{type:Wo(e.type),doc:r,oldIndex:i,newIndex:s}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw z("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Bo(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();["length","forEach","map"].concat([Symbol.iterator]).forEach(function(t){try{Object.defineProperty(Fo.prototype.docChanges,t,{get:function(){return function(){throw new S(_.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var jo=function(t){function e(e,n){var r=t.call(this,zt.atPath(e),n)||this;if(e.length%2!=1)throw new S(_.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return a.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Po(new ft(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(M("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=H.newId()),x("CollectionReference.doc","non-empty string",1,t),""===t)throw new S(_.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=ct.fromString(t);return Po.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){D("CollectionReference.add",arguments,1),x("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Uo);function qo(t,e){if(void 0===e)return{merge:!1};if(K(t,e,["merge","mergeFields"]),L(t,"boolean","merge",e.merge),B(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof Ji}),void 0!==e.mergeFields&&void 0!==e.merge)throw new S(_.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Vo(t,e){return void 0===e?{}:(K(t,e,["serverTimestamps"]),U(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ko(t,e){P(t,"object",1,e),e&&(K(t,e,["source"]),U(t,0,"source",e.source,["default","server","cache"]))}function zo(t,e,n){if(e instanceof Po){if(e.firestore!==n)throw new S(_.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw z(t,"DocumentReference",1,e)}function Wo(t){switch(t){case Le.Added:return"added";case Le.Modified:case Le.Metadata:return"modified";case Le.Removed:return"removed";default:return g("Unknown change type: "+t)}}var Go=E(ko,"Use firebase.firestore() instead."),Ho=E(Mo,"Use firebase.firestore().runTransaction() instead."),Qo=E(xo,"Use firebase.firestore().batch() instead."),Jo=E(Po,"Use firebase.firestore().doc() instead."),$o=E(Lo),Yo=E(Bo),Xo=E(Uo),Zo=E(Fo),ts=E(jo,"Use firebase.firestore().collection() instead."),es={Firestore:Go,GeoPoint:rt,Timestamp:it,Blob:nt,Transaction:Ho,WriteBatch:Qo,DocumentReference:Jo,DocumentSnapshot:$o,Query:Xo,QueryDocumentSnapshot:Yo,QuerySnapshot:Zo,CollectionReference:ts,FieldPath:Ji,FieldValue:ho,setLogLevel:ko.setLogLevel,CACHE_SIZE_UNLIMITED:Co};function ns(t){t.INTERNAL.registerService("firestore",function(t){return new ko(t)},function(t){v(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(es))}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t){ns(t)}rs(o),e.registerFirestore=rs},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n=(window,this);function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e=Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var s=t[o];s in i||(i[s]={}),i=i[s]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function r(){this.a=null}function i(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var s=n.setTimeout;r.prototype.c=function(t){s(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},r.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.o),reject:t(this.g)}},e.prototype.o=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.u(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.l(t):this.h(t)}},e.prototype.l=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.m()},e.prototype.m=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new r;return e.prototype.u=function(t){var e=this.f();t.Ja(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,s=new e(function(t,e){i=t,o=e});return this.Ja(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ja=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=i,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var r=o(t),s=r.next();!s.done;s=r.next())i(s.value).Ja(e,n)})},e.all=function(t){var n=o(t),r=n.next();return r.done?i([]):new e(function(t,e){function o(e){return function(n){s[e]=n,0==--a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,i(r.value).Ja(o(s.length-1),e),r=n.next()}while(!r.done)})},e});var s=s||{},a=this;function u(t){return"string"==typeof t}function c(t){return"boolean"==typeof t}var h=/^[\w+/_-]+[=]{0,2}$/,l=null;function f(){}function d(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){return null===t}function m(t){return"array"==d(t)}function y(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function g(t){return"function"==d(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var b="closure_uid_"+(1e9*Math.random()>>>0),w=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function S(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:S).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now||function(){return+new Date};function A(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.cd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function N(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function C(t){if(Error.captureStackTrace)Error.captureStackTrace(this,C);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function O(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");C.call(this,n+t[r])}function D(t,e){throw new O("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function k(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function x(){this.b=this.a=null}A(C,Error),C.prototype.name="CustomError",A(O,C),O.prototype.name="AssertionError",k.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var P=new k(function(){return new L},function(t){t.reset()});function R(){var t=vt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function L(){this.next=this.b=this.a=null}x.prototype.add=function(t,e){var n=P.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},L.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},L.prototype.reset=function(){this.next=this.b=this.a=null};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(u(t))return u(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=u(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var F=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=u(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},j=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=u(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function q(t,e){return 0<=B(t,e)}function V(t,e){var n;return(n=0<=(e=B(t,e)))&&Array.prototype.splice.call(t,e,1),n}function K(t,e){!function(t,e){for(var n=u(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0})}function z(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var G,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Q=/&/g,J=/</g,$=/>/g,Y=/"/g,X=/'/g,Z=/\x00/g,tt=/[\x00&<>"']/;function et(t,e){return-1!=t.indexOf(e)}function nt(t,e){return t<e?-1:t>e?1:0}t:{var rt=a.navigator;if(rt){var it=rt.userAgent;if(it){G=it;break t}}G=""}function ot(t){return et(G,t)}function st(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function at(t){for(var e in t)return!1;return!0}function ut(t){var e,n={};for(e in t)n[e]=t[e];return n}var ct,ht,lt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ft(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<lt.length;o++)n=lt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function dt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function pt(t){return tt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Q,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(J,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace($,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Y,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(X,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Z,"&#0;"))),t}function mt(t){a.setTimeout(function(){throw t},0)}function yt(t,e){ht||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);ht=function(){t.then(bt)}}else ht=function(){var t=bt;!g(a.setImmediate)||a.Window&&a.Window.prototype&&!ot("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ct||(ct=function(){var t=a.MessageChannel;if(void 0===t&&window.postMessage&&window.addEventListener&&!ot("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=E(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ot("Trident")&&!ot("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){a.setTimeout(t,0)}}()),ct(t)):a.setImmediate(t)}}(),gt||(ht(),gt=!0),vt.add(t,e)}var gt=!1,vt=new x;function bt(){for(var t;t=R();){try{t.a.call(t.b)}catch(t){mt(t)}M(P,t)}gt=!1}function wt(t,e){if(this.a=_t,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,function(t){xt(n,St,t)},function(t){if(!(t instanceof jt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}xt(n,Et,t)})}catch(t){xt(this,Et,t)}}var _t=0,St=2,Et=3;function It(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}It.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Tt=new k(function(){return new It},function(t){t.reset()});function At(t,e,n){var r=Tt.get();return r.g=t,r.b=e,r.f=n,r}function Nt(t){if(t instanceof wt)return t;var e=new wt(f);return xt(e,St,t),e}function Ct(t){return new wt(function(e,n){n(t)})}function Ot(t,e,n){Pt(t,e,n,null)||yt(I(e,t))}function Dt(t){return new wt(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Ot(t[o],I(i,o,!0),I(i,o,!1));else e(r)})}function kt(t,e){t.b||t.a!=St&&t.a!=Et||Rt(t),t.f?t.f.next=e:t.b=e,t.f=e}function Mt(t,e,n,r){var i=At(null,null,null);return i.a=new wt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof jt?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,kt(t,i),i.a}function xt(t,e,n){t.a==_t&&(t===n&&(e=Et,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Pt(n,t.Lc,t.Mc,t)||(t.i=n,t.a=e,t.c=null,Rt(t),e!=Et||n instanceof jt||function(t,e){t.g=!0,yt(function(){t.g&&Ft.call(null,e)})}(t,n)))}function Pt(t,e,n,r){if(t instanceof wt)return kt(t,At(e||f,n||null,r)),!0;if(N(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(g(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,function(t){s||(s=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Rt(t){t.h||(t.h=!0,yt(t.Xb,t))}function Lt(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Bt(t,e,n,r){if(n==Et&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ut(e,n,r);else try{e.c?e.g.call(e.f):Ut(e,n,r)}catch(t){Ft.call(null,t)}M(Tt,e)}function Ut(t,e,n){e==St?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}wt.prototype.then=function(t,e,n){return Mt(this,g(t)?t:null,g(e)?e:null,n)},wt.prototype.$goog_Thenable=!0,(t=wt.prototype).ia=function(t,e){return(t=At(t,t,e)).c=!0,kt(this,t),this},t.s=function(t,e){return Mt(this,null,t,e)},t.cancel=function(t){this.a==_t&&yt(function(){!function t(e,n){if(e.a==_t)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==e&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==_t&&1==i?t(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):Lt(r),Bt(r,o,Et,n)))}e.c=null}else xt(e,Et,n)}(this,new jt(t))},this)},t.Lc=function(t){this.a=_t,xt(this,St,t)},t.Mc=function(t){this.a=_t,xt(this,Et,t)},t.Xb=function(){for(var t;t=Lt(this);)Bt(this,t,this.a,this.i);this.h=!1};var Ft=mt;function jt(t){C.call(this,t)}function qt(){0!=Vt&&(Kt[this[b]||(this[b]=++w)]=this),this.qa=this.qa,this.ja=this.ja}A(jt,C),jt.prototype.name="cancel";var Vt=0,Kt={};function zt(t){if(!t.qa&&(t.qa=!0,t.va(),0!=Vt)){var e=t[b]||(t[b]=++w);if(0!=Vt&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Kt[e]}}function Wt(t){return Wt[" "](t),t}qt.prototype.qa=!1,qt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Wt[" "]=f;var Gt,Ht,Qt=ot("Opera"),Jt=ot("Trident")||ot("MSIE"),$t=ot("Edge"),Yt=$t||Jt,Xt=ot("Gecko")&&!(et(G.toLowerCase(),"webkit")&&!ot("Edge"))&&!(ot("Trident")||ot("MSIE"))&&!ot("Edge"),Zt=et(G.toLowerCase(),"webkit")&&!ot("Edge");function te(){var t=a.document;return t?t.documentMode:void 0}t:{var ee="",ne=(Ht=G,Xt?/rv:([^\);]+)(\)|;)/.exec(Ht):$t?/Edge\/([\d\.]+)/.exec(Ht):Jt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ht):Zt?/WebKit\/(\S+)/.exec(Ht):Qt?/(?:Version)[ \/]?(\S+)/.exec(Ht):void 0);if(ne&&(ee=ne?ne[1]:""),Jt){var re=te();if(null!=re&&re>parseFloat(ee)){Gt=String(re);break t}}Gt=ee}var ie,oe={};function se(t){return function(t,e){var n=oe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=H(String(Gt)).split("."),r=H(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=nt(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||nt(0==s[2].length,0==a[2].length)||nt(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var ae=a.document;ie=ae&&Jt?te()||("CSS1Compat"==ae.compatMode?parseInt(Gt,10):5):void 0;var ue=Object.freeze||function(t){return t},ce=!Jt||9<=Number(ie),he=Jt&&!se("9"),le=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",f,e),a.removeEventListener("test",f,e)}catch(t){}return t}();function fe(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function de(t,e){if(fe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{Wt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=u(t.pointerType)?t.pointerType:pe[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}fe.prototype.preventDefault=function(){this.Kb=!1},A(de,fe);var pe=ue({2:"touch",3:"pen",4:"mouse"});de.prototype.preventDefault=function(){de.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,he)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},de.prototype.f=function(){return this.a};var me="closure_listenable_"+(1e6*Math.random()|0),ye=0;function ge(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Na=i,this.key=++ye,this.oa=this.Ia=!1}function ve(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.Na=null}function be(t){this.src=t,this.a={},this.b=0}function we(t,e){var n=e.type;n in t.a&&V(t.a[n],e)&&(ve(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function _e(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.Na==r)return i}return-1}be.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=_e(t,e,r,i);return-1<s?(e=t[s],n||(e.Ia=!1)):((e=new ge(e,this.src,o,!!r,i)).Ia=n,t.push(e)),e};var Se="closure_lm_"+(1e6*Math.random()|0),Ee={};function Ie(t,e,n,r,i){if(r&&r.once)Ae(t,e,n,r,i);else if(m(e))for(var o=0;o<e.length;o++)Ie(t,e[o],n,r,i);else n=Re(n),t&&t[me]?Be(t,e,n,v(r)?!!r.capture:!!r,i):Te(t,e,n,!1,r,i)}function Te(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=v(i)?!!i.capture:!!i,a=xe(t);if(a||(t[Se]=a=new be(t)),!(n=a.add(e,n,r,s,o)).proxy){if(r=function(){var t=Me,e=ce?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)le||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Oe(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function Ae(t,e,n,r,i){if(m(e))for(var o=0;o<e.length;o++)Ae(t,e[o],n,r,i);else n=Re(n),t&&t[me]?Ue(t,e,n,v(r)?!!r.capture:!!r,i):Te(t,e,n,!0,r,i)}function Ne(t,e,n,r,i){if(m(e))for(var o=0;o<e.length;o++)Ne(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=Re(n),t&&t[me]?(t=t.m,(e=String(e).toString())in t.a&&(-1<(n=_e(o=t.a[e],n,r,i))&&(ve(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=xe(t))&&(e=t.a[e.toString()],t=-1,e&&(t=_e(e,n,r,i)),(n=-1<t?e[t]:null)&&Ce(n))}function Ce(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[me])we(e.m,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Oe(n),r):e.addListener&&e.removeListener&&e.removeListener(r),0,(n=xe(e))?(we(n,t),0==n.b&&(n.src=null,e[Se]=null)):ve(t)}}}function Oe(t){return t in Ee?Ee[t]:Ee[t]="on"+t}function De(t,e,n,r){var i=!0;if((t=xe(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=ke(o,r),i=i&&!1!==o)}return i}function ke(t,e){var n=t.listener,r=t.Na||t.src;return t.Ia&&Ce(t),n.call(r,e)}function Me(t,e){if(t.oa)return!0;if(!ce){if(!e)t:{e=["window","event"];for(var n=a,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new de(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=De(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=De(r[i],t,!1,e),n=n&&o}return n}return ke(t,new de(e,this))}function xe(t){return(t=t[Se])instanceof be?t:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(t){return g(t)?t:(t[Pe]||(t[Pe]=function(e){return t.handleEvent(e)}),t[Pe])}function Le(){qt.call(this),this.m=new be(this),this.Qb=this,this.Va=null}function Be(t,e,n,r,i){t.m.add(String(e),n,!1,r,i)}function Ue(t,e,n,r,i){t.m.add(String(e),n,!0,r,i)}function Fe(t,e,n,r){if(!(e=t.m.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.oa&&s.capture==n){var a=s.listener,u=s.Na||s.src;s.Ia&&we(t.m,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Kb}function je(t,e,n){if(g(t))n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function qe(t){var e=null;return new wt(function(n,r){-1==(e=je(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw a.clearTimeout(e),t})}function Ve(t){if(t.S&&"function"==typeof t.S)return t.S();if(u(t))return t.split("");if(y(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Ke(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(y(t)||u(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}A(Le,qt),Le.prototype[me]=!0,Le.prototype.addEventListener=function(t,e,n,r){Ie(this,t,e,n,r)},Le.prototype.removeEventListener=function(t,e,n,r){Ne(this,t,e,n,r)},Le.prototype.dispatchEvent=function(t){var e,n=this.Va;if(n)for(e=[];n;n=n.Va)e.push(n);n=this.Qb;var r=t.type||t;if(u(t))t=new fe(t,n);else if(t instanceof fe)t.target=t.target||n;else{var i=t;ft(t=new fe(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=Fe(s,r,!0,t)&&i}if(i=Fe(s=t.b=n,r,!0,t)&&i,i=Fe(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Fe(s=t.b=e[o],r,!1,t)&&i;return i},Le.prototype.va=function(){if(Le.qb.va.call(this),this.m){var t,e=this.m;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,ve(n[r]);delete e.a[t],e.b--}}this.Va=null},(t=ze.prototype).S=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return We(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},t.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.b=this.i=this.f="",this.m=null,this.g=this.c="",this.h=!1,t instanceof Qe?(this.h=void 0!==e?e:t.h,Je(this,t.f),this.i=t.i,this.b=t.b,$e(this,t.m),this.c=t.c,Ye(this,gn(t.a)),this.g=t.g):t&&(n=String(t).match(He))?(this.h=!!e,Je(this,n[1]||"",!0),this.i=nn(n[2]||""),this.b=nn(n[3]||"",!0),$e(this,n[4]),this.c=nn(n[5]||"",!0),Ye(this,n[6]||"",!0),this.g=nn(n[7]||"")):(this.h=!!e,this.a=new ln(null,this.h))}function Je(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ye(t,e,n){e instanceof ln?(t.a=e,function(t,e){e&&!t.f&&(fn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=rn(e,cn)),t.a=new ln(e,t.h))}function Xe(t,e,n){t.a.set(e,n)}function Ze(t,e){return t.a.get(e)}function tn(t){return t instanceof Qe?new Qe(t):new Qe(t,void 0)}function en(t,e){var n=new Qe(null,void 0);return Je(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return u(t)?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?un:an,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",rn(n,hn)),t.join("")},Qe.prototype.resolve=function(t){var e=new Qe(this),n=!!t.f;n?Je(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.m;var r=t.c;if(n)$e(e,t.m);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(et(i,"./")||et(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Ye(e,gn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var sn=/[#\/\?@]/g,an=/[#\?:]/g,un=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(t){t.a||(t.a=new ze,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function dn(t){var e=Ke(t);if(void 0===e)throw Error("Keys are undefined");var n=new ln(null,void 0);t=Ve(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];m(o)?yn(n,i,o):n.add(i,o)}return n}function pn(t,e){fn(t),e=vn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function mn(t,e){return fn(t),e=vn(t,e),Ge(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),W(n)),t.b+=n.length)}function gn(t){var e=new ln;return e.c=t.c,t.a&&(e.a=new ze(t.a),e.b=t.b),e}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){fn(this),this.a.forEach(function(n,r){U(n,function(n){t.call(e,n,r,this)},this)},this)},t.U=function(){fn(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.S=function(t){fn(this);var e=[];if(u(t))mn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},t.set=function(t,e){return fn(this),this.c=null,mn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.S(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=!Jt||9<=Number(ie);function wn(t,e){this.a=t===En&&e||"",this.b=Sn}function _n(t){return t instanceof wn&&t.constructor===wn&&t.b===Sn?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}wn.prototype.na=!0,wn.prototype.ma=function(){return this.a},wn.prototype.toString=function(){return"Const{"+this.a+"}"};var Sn={},En={};function In(){this.a="",this.b=On}function Tn(t){return t instanceof In&&t.constructor===In&&t.b===On?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function An(t,e){var n=_n(t);if(!Cn.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=new In;return e.a=t,e}(t=n.replace(Nn,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof wn?_n(t):encodeURIComponent(String(t))}))}In.prototype.na=!0,In.prototype.ma=function(){return this.a.toString()},In.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nn=/%{(\w+)}/g,Cn=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,On={};function Dn(){this.a="",this.b=Pn}function kn(t){return t instanceof Dn&&t.constructor===Dn&&t.b===Pn?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}Dn.prototype.na=!0,Dn.prototype.ma=function(){return this.a.toString()},Dn.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Mn=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function xn(t){return t instanceof Dn?t:(t="object"==typeof t&&t.na?t.ma():String(t),Mn.test(t)||(t="about:invalid#zClosurez"),Rn(t))}var Pn={};function Rn(t){var e=new Dn;return e.a=t,e}function Ln(){this.a="",this.b=Bn}Rn("about:blank"),Ln.prototype.na=!0,Ln.prototype.ma=function(){return this.a.toString()},Ln.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bn={};function Un(t){var e=new Ln;return e.a=t,e}function Fn(t){var e=document;return u(t)?e.getElementById(t):t}function jn(t,e){st(e,function(e,n){e&&"object"==typeof e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:qn.hasOwnProperty(n)?t.setAttribute(qn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}Un("<!DOCTYPE html>"),Un(""),Un("<br>");var qn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Vn(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!bn&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',pt(s.name),'"'),s.type){o.push(' type="',pt(s.type),'"');var a={};ft(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=i.createElement(o),s&&(u(s)?o.className=s:m(s)?o.className=s.join(" "):jn(o,s)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(u(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!y(o)||v(o)&&0<o.nodeType?r(o):U(Kn(o)?W(o):o,r)}}(i,o,r),o}function Kn(t){if(t&&"number"==typeof t.length){if(v(t))return"function"==typeof t.item||"string"==typeof t.item;if(g(t))return"function"==typeof t.item}return!1}function zn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(m(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(s=n[i])&&(r.push(o),Qn(i,r),r.push(":"),t(e,s,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Qn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Wn,t,e),e.join("")}function Wn(){}var Gn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Hn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Qn(t,e){e.push('"',t.replace(Hn,function(t){var e=Gn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Gn[t]=e),e}),'"')}function Jn(){var t=pr();return Jt&&!!ie&&11==ie||/Edge\/\d+/.test(t)}function $n(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function Yn(t,e){e=e||a.window;var n="about:blank";t&&(n=kn(xn(t)).toString()),e.location.href=n}function Xn(t){return!!((t=(t||pr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Zn(t){t=t||a.window;try{t.close()}catch(t){}}function tr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=pr().toLowerCase(),r&&(e.target=r,et(n,"crios/")&&(e.target="_blank")),lr(pr())==cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Dn?n:xn(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((ot("iPhone")&&!ot("iPod")&&!ot("iPad")||ot("iPad")||ot("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),e instanceof Dn||e instanceof Dn||(e="object"==typeof e&&e.na?e.ma():String(e),Mn.test(e)||(e="about:invalid#zClosurez"),e=Rn(e)),s.href=kn(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=kn(e).toString(),s&&(Yt&&et(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Un('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+pt(t)+'">'),s.document.write(function(t){return t instanceof Ln&&t.constructor===Ln&&t.b===Bn?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),s.document.close())):(s=r.open(kn(e).toString(),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var er=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nr=/^[^@]+@[^@]+$/;function rr(){var t=null;return new wt(function(e){"complete"==a.document.readyState?e():(t=function(){e()},Ae(window,"load",t))}).s(function(e){throw Ne(window,"load",t),e})}function ir(t){return t=t||pr(),!("file:"!==br()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function or(){var t=a.window;try{return!(!t||t==t.top)}catch(t){return!1}}function sr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function ar(){return i.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":i.a.INTERNAL.hasOwnProperty("node")?"Node":sr()?"Worker":"Browser"}function ur(){var t=ar();return"ReactNative"===t||"Node"===t}var cr="Firefox",hr="Chrome";function lr(t){var e=t.toLowerCase();return et(e,"opera/")||et(e,"opr/")||et(e,"opios/")?"Opera":et(e,"iemobile")?"IEMobile":et(e,"msie")||et(e,"trident/")?"IE":et(e,"edge/")?"Edge":et(e,"firefox/")?cr:et(e,"silk/")?"Silk":et(e,"blackberry")?"Blackberry":et(e,"webos")?"Webos":!et(e,"safari/")||et(e,"chrome/")||et(e,"crios/")||et(e,"android")?!et(e,"chrome/")&&!et(e,"crios/")||et(e,"edge/")?et(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":hr:"Safari"}var fr={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};function dr(t,e){e=e||[];var n,r=[],i={};for(n in fr)i[fr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=ar())?r=lr(i=pr()):"Worker"===r&&(r=lr(i=pr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function pr(){return a.navigator&&a.navigator.userAgent||""}function mr(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function yr(){try{var t=a.localStorage,e=Ir();if(t)return t.setItem(e,"1"),t.removeItem(e),!Jn()||!!a.indexedDB}catch(t){return sr()&&!!a.indexedDB}return!1}function gr(){return(vr()||"chrome-extension:"===br()||ir())&&!ur()&&yr()&&!sr()}function vr(){return"http:"===br()||"https:"===br()}function br(){return a.location&&a.location.protocol||null}function wr(t){return!Xn(t=t||pr())&&lr(t)!=cr}function _r(t){return void 0===t?null:zn(t)}function Sr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Er(t){if(null!==t)return JSON.parse(t)}function Ir(t){return t||Math.floor(1e9*Math.random()).toString()}function Tr(t){return"Safari"!=lr(t=t||pr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ar(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Nr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=pr(),e=ar(),this.b=Xn(t)||"ReactNative"===e}function Cr(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Or(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Dr(){return!(!mr("fireauth.oauthhelper",a)&&!mr("fireauth.iframe",a))}Nr.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!vr()&&"chrome-extension:"!==br()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var kr,Mr={};function xr(t){Mr[t]||(Mr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Pr={};Object.defineProperty(Pr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Pr,"abcd",{configurable:!0,enumerable:!0,value:2}),kr=2==Pr.abcd}catch(Ht){kr=!1}function Rr(t,e,n){kr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Lr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Rr(t,n,e[n])}function Br(t){var e={};return Lr(e,t),e}function Ur(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Rr(e,n,Ur(t[n]));return e}function Fr(t){var e={},n=t[qr],r=t[Vr];if(!(t=t[Kr])||t!=jr&&!n)throw Error("Invalid provider user info!");e[Wr]=r||null,e[zr]=n||null,Rr(this,Hr,t),Rr(this,Gr,Ur(e))}var jr="EMAIL_SIGNIN",qr="email",Vr="newEmail",Kr="requestType",zr="email",Wr="fromEmail",Gr="data",Hr="operation";function Qr(t,e){this.code=$r+t,this.message=e||Yr[t]||""}function Jr(t){var e=t&&t.code;return e?new Qr(e.substring($r.length),t.message):null}A(Qr,Error),Qr.prototype.w=function(){return{code:this.code,message:this.message}},Qr.prototype.toJSON=function(){return this.w()};var $r="auth/",Yr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Xr(t){var e=t[ri];if(void 0===e)throw new Qr("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Qr("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Zr];if(n&&"object"==typeof n){e=n[si];var r=n[ii];if(n=n[oi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Qr("argument-error",ii+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Qr("argument-error",oi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Qr("argument-error",si+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Qr("missing-android-pkg-name")}}else if(void 0!==n)throw new Qr("argument-error",Zr+" property must be a non null object when specified.");if(this.f=null,(e=t[ni])&&"object"==typeof e){if("string"==typeof(e=e[ai])&&e.length)this.f=e;else if(void 0!==e)throw new Qr("argument-error",ai+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Qr("argument-error",ni+" property must be a non null object when specified.");if(void 0!==(e=t[ei])&&"boolean"!=typeof e)throw new Qr("argument-error",ei+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[ti])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Qr("argument-error",ti+" property must be a non empty string when specified.");this.i=t||null}var Zr="android",ti="dynamicLinkDomain",ei="handleCodeInApp",ni="iOS",ri="url",ii="installApp",oi="minimumVersion",si="packageName",ai="bundleId";function ui(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var ci=null,hi=null;function li(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=hi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!ci){ci={},hi={};for(var t=0;65>t;t++)ci[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),hi[ci[t]]=t,62<=t&&(hi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(t,function(t){e+=String.fromCharCode(t)}),e}function fi(t){this.c=t.sub,T(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function di(t){return(t=pi(t))&&t.sub&&t.iss&&t.aud&&t.exp?new fi(t):null}function pi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(li(t))}catch(t){}return null}fi.prototype.f=function(){return this.b};var mi,yi={Yc:{ab:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{ab:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{ab:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function gi(t){for(var e in yi)if(yi[e].id===t)return{firebaseEndpoint:(t=yi[e]).ab,secureTokenEndpoint:t.ib};return null}mi=gi("__EID__")?"__EID__":void 0;var vi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),bi=["client_id","response_type","scope","redirect_uri","state"],wi={Tc:{Oa:"locale",Ba:500,Aa:600,Pa:"facebook.com",hb:bi},Vc:{Oa:null,Ba:500,Aa:620,Pa:"github.com",hb:bi},Wc:{Oa:"hl",Ba:515,Aa:680,Pa:"google.com",hb:bi},bd:{Oa:"lang",Ba:485,Aa:705,Pa:"twitter.com",hb:vi}};function _i(t){for(var e in wi)if(wi[e].Pa==t)return wi[e];return null}function Si(t){var e={};e["facebook.com"]=Ni,e["google.com"]=Oi,e["github.com"]=Ci,e["twitter.com"]=Di;var n=t&&t[Ii];try{if(n)return e[n]?new e[n](t):new Ai(t);if(void 0!==t[Ei])return new Ti(t)}catch(t){}return null}var Ei="idToken",Ii="providerId";function Ti(t){var e=t[Ii];if(!e&&t[Ei]){var n=di(t[Ei]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Rr(this,"providerId",e),Rr(this,"isNewUser",n)}function Ai(t){Ti.call(this,t),Rr(this,"profile",Ur((t=Er(t.rawUserInfo||"{}"))||{}))}function Ni(t){if(Ai.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ci(t){if(Ai.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Rr(this,"username",this.profile&&this.profile.login||null)}function Oi(t){if(Ai.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Di(t){if(Ai.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Rr(this,"username",t.screenName||null)}function ki(t){this.a=tn(t)}function Mi(t){var e=tn(t),n=Ze(e,"link"),r=Ze(tn(n),"link");return e=Ze(e,"deep_link_id"),Ze(tn(e),"link")||e||r||n||t}function xi(){}function Pi(t,e){return t.then(function(t){if(t[Ss]){var n=di(t[Ss]);if(!n||e!=n.c)throw new Qr("user-mismatch");return t}throw new Qr("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==$r+"user-not-found"?new Qr("user-mismatch"):t})}function Ri(t,e){if(!e)throw new Qr("internal-error","failed to construct a credential");this.a=e,Rr(this,"providerId",t),Rr(this,"signInMethod",t)}function Li(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Bi(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Ri(t.providerId,t.pendingToken)}catch(t){}return null}function Ui(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Rr(this,"idToken",e.idToken),e.accessToken&&Rr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Rr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Qr("internal-error","failed to construct a credential");Rr(this,"accessToken",e.oauthToken),Rr(this,"secret",e.oauthTokenSecret)}Rr(this,"providerId",t),Rr(this,"signInMethod",n)}function Fi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:dn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function ji(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Ui(t.providerId,e,t.signInMethod)}catch(t){}}return null}function qi(t,e){this.Dc=e||[],Lr(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.cb=(_i(t)||{}).Oa||null,this.$a=null}function Vi(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Qr("argument-error",'SAML provider IDs must be prefixed with "saml."');qi.call(this,t,[])}function Ki(t){qi.call(this,t,bi),this.a=[]}function zi(){Ki.call(this,"facebook.com")}function Wi(t){if(!t)throw new Qr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new zi).credential({accessToken:e})}function Gi(){Ki.call(this,"github.com")}function Hi(t){if(!t)throw new Qr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new Gi).credential({accessToken:e})}function Qi(){Ki.call(this,"google.com"),this.ua("profile")}function Ji(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new Qi).credential({idToken:n,accessToken:e})}function $i(){qi.call(this,"twitter.com",vi)}function Yi(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Qr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Ui("twitter.com",n,"twitter.com")}function Xi(t,e,n){this.a=t,this.c=e,Rr(this,"providerId","password"),Rr(this,"signInMethod",n===to.EMAIL_LINK_SIGN_IN_METHOD?to.EMAIL_LINK_SIGN_IN_METHOD:to.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Zi(t){return t&&t.email&&t.password?new Xi(t.email,t.password,t.signInMethod):null}function to(){Lr(this,{providerId:"password",isOAuthProvider:!1})}function eo(t,e){if(!(e=no(e)))throw new Qr("argument-error","Invalid email link!");return new Xi(t,e,to.EMAIL_LINK_SIGN_IN_METHOD)}function no(t){var e=Ze((t=new ki(t=Mi(t))).a,"oobCode")||null;return"signIn"===(Ze(t.a,"mode")||null)&&e?e:null}function ro(t){if(!(t.Ta&&t.Sa||t.Fa&&t.$))throw new Qr("internal-error");this.a=t,Rr(this,"providerId","phone"),Rr(this,"signInMethod","phone")}function io(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return U(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new ro(e)}return null}function oo(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ta,code:t.a.Sa}}function so(t){try{this.a=t||i.a.auth()}catch(t){throw new Qr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Lr(this,{providerId:"phone",isOAuthProvider:!1})}function ao(t,e){if(!t)throw new Qr("missing-verification-id");if(!e)throw new Qr("missing-verification-code");return new ro({Ta:t,Sa:e})}function uo(t){if(t.temporaryProof&&t.phoneNumber)return new ro({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return Ji(o,n);case"facebook.com":return Wi(n);case"github.com":return Hi(n);case"twitter.com":return Yi(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new Ri(e,s):new Ui(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Ki(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function co(t){if(!t.isOAuthProvider)throw new Qr("invalid-oauth-provider")}function ho(t,e,n,r,i,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new Qr("invalid-auth-event");if(this.g&&this.a)throw new Qr("invalid-auth-event");if(this.g&&!this.f)throw new Qr("invalid-auth-event")}function lo(t){return(t=t||{}).type?new ho(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Jr(t.error),t.postBody):null}function fo(){this.b=null,this.a=[]}A(Ai,Ti),A(Ni,Ai),A(Ci,Ai),A(Oi,Ai),A(Di,Ai),Ri.prototype.la=function(t){return js(t,Li(this))},Ri.prototype.b=function(t,e){var n=Li(this);return n.idToken=e,qs(t,n)},Ri.prototype.f=function(t,e){return Pi(Vs(t,Li(this)),e)},Ri.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Ui.prototype.la=function(t){return js(t,Fi(this))},Ui.prototype.b=function(t,e){var n=Fi(this);return n.idToken=e,qs(t,n)},Ui.prototype.f=function(t,e){return Pi(Vs(t,Fi(this)),e)},Ui.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},qi.prototype.Da=function(t){return this.zb=ut(t),this},A(Vi,qi),A(Ki,qi),Ki.prototype.ua=function(t){return q(this.a,t)||this.a.push(t),this},Ki.prototype.Fb=function(){return W(this.a)},Ki.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Qr("argument-error","credential failed: must provide the ID token and/or the access token.");return new Ui(this.providerId,n,this.providerId)},A(zi,Ki),Rr(zi,"PROVIDER_ID","facebook.com"),Rr(zi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),A(Gi,Ki),Rr(Gi,"PROVIDER_ID","github.com"),Rr(Gi,"GITHUB_SIGN_IN_METHOD","github.com"),A(Qi,Ki),Rr(Qi,"PROVIDER_ID","google.com"),Rr(Qi,"GOOGLE_SIGN_IN_METHOD","google.com"),A($i,qi),Rr($i,"PROVIDER_ID","twitter.com"),Rr($i,"TWITTER_SIGN_IN_METHOD","twitter.com"),Xi.prototype.la=function(t){return this.signInMethod==to.EMAIL_LINK_SIGN_IN_METHOD?ga(t,$s,{email:this.a,oobCode:this.c}):ga(t,da,{email:this.a,password:this.c})},Xi.prototype.b=function(t,e){return this.signInMethod==to.EMAIL_LINK_SIGN_IN_METHOD?ga(t,Ys,{idToken:e,email:this.a,oobCode:this.c}):ga(t,aa,{idToken:e,email:this.a,password:this.c})},Xi.prototype.f=function(t,e){return Pi(this.la(t),e)},Xi.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Lr(to,{PROVIDER_ID:"password"}),Lr(to,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Lr(to,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),ro.prototype.la=function(t){return t.Ua(oo(this))},ro.prototype.b=function(t,e){var n=oo(this);return n.idToken=e,ga(t,ma,n)},ro.prototype.f=function(t,e){var n=oo(this);return n.operation="REAUTH",Pi(t=ga(t,ya,n),e)},ro.prototype.w=function(){var t={providerId:"phone"};return this.a.Ta&&(t.verificationId=this.a.Ta),this.a.Sa&&(t.verificationCode=this.a.Sa),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},so.prototype.Ua=function(t,e){var n=this.a.c;return Nt(e.verify()).then(function(r){if(!u(r))throw new Qr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return ga(t,oa,e)}(n,{phoneNumber:t,recaptchaToken:r}).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Qr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Lr(so,{PROVIDER_ID:"phone"}),Lr(so,{PHONE_SIGN_IN_METHOD:"phone"}),ho.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join("-")},ho.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var po,mo=null;function yo(t){var e="unauthorized-domain",n=void 0,r=tn(t);t=r.b,"chrome-extension"==(r=r.f)?n=dt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=dt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Qr.call(this,e,n)}function go(t,e,n){Qr.call(this,t,n),(t=e||{}).Ab&&Rr(this,"email",t.Ab),t.$&&Rr(this,"phoneNumber",t.$),t.credential&&Rr(this,"credential",t.credential)}function vo(t){if(t.code){var e=t.code||"";0==e.indexOf($r)&&(e=e.substring($r.length));var n={credential:uo(t)};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Qr(e,t.message||void 0);return new go(e,n,t.message)}return null}function bo(){}function wo(t){return t.c||(t.c=t.b())}function _o(){}function So(t){return t.f,t.f}function Eo(){}function Io(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=E(this.dc,this),this.a.onerror=E(this.Gb,this),this.a.onprogress=E(this.ec,this),this.a.ontimeout=E(this.ic,this)}function To(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Ao(t,e,n){this.reset(t,e,n,void 0,void 0)}fo.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=mr("universalLinks.subscribe",a))&&t(null,this.b))},fo.prototype.unsubscribe=function(t){K(this.a,function(e){return e==t})},A(yo,Qr),A(go,Qr),go.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.w();return e&&ft(t,e),t},go.prototype.toJSON=function(){return this.w()},bo.prototype.c=null,A(_o,bo),_o.prototype.a=function(){var t=So(this);return t?new ActiveXObject(t):new XMLHttpRequest},_o.prototype.b=function(){var t={};return So(this)&&(t[0]=!0,t[1]=!0),t},po=new _o,A(Eo,bo),Eo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Io;throw Error("Unsupported browser")},Eo.prototype.b=function(){return{}},(t=Io.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.dc=function(){this.status=200,this.response=this.responseText=this.a.responseText,To(this,4)},t.Gb=function(){this.status=500,this.response=this.responseText="",To(this,4)},t.ic=function(){this.Gb()},t.ec=function(){this.status=200,To(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Ao.prototype.a=null;function No(t){this.f=t,this.b=this.c=this.a=null}function Co(t,e){this.name=t,this.value=e}Ao.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||T(),delete this.a},Co.prototype.toString=function(){return this.name};var Oo=new Co("SEVERE",1e3),Do=new Co("WARNING",900),ko=new Co("CONFIG",700),Mo=new Co("FINE",500);No.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(g(e)&&(e=e()),t=new Ao(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var xo={},Po=null;function Ro(t){var e;if(Po||(Po=new No(""),xo[""]=Po,Po.c=ko),!(e=xo[t])){e=new No(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Ro(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,xo[t]=e}return e}function Lo(t,e){t&&t.log(Mo,e,void 0)}function Bo(t){this.f=t}function Uo(t){Le.call(this),this.u=t,this.readyState=Fo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.o="GET",this.g="",this.a=!1,this.h=Ro("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}A(Bo,bo),Bo.prototype.a=function(){return new Uo(this.f)},Bo.prototype.b=function(t){return function(){return t}}({}),A(Uo,Le);var Fo=0;function jo(t){t.c.read().then(t.cc.bind(t)).catch(t.Ma.bind(t))}function qo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,Vo(t)}function Vo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ko(t){Le.call(this),this.headers=new ze,this.D=t||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=zo,this.v=this.O=!1}(t=Uo.prototype).open=function(t,e){if(this.readyState!=Fo)throw this.abort(),Error("Error reopening a connection");this.o=t,this.g=e,this.readyState=1,Vo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.o,credentials:void 0,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.g,e)).then(this.hc.bind(this),this.Ma.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,qo(this,!1)),this.readyState=Fo},t.hc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,Vo(this)),this.a&&(this.readyState=3,Vo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.fc.bind(this),this.Ma.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,jo(this)):t.text().then(this.gc.bind(this),this.Ma.bind(this)))))},t.cc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?qo(this,!0):Vo(this),3==this.readyState&&jo(this)}},t.gc=function(t){this.a&&(this.response=this.responseText=t,qo(this,!0))},t.fc=function(t){this.a&&(this.response=t,qo(this,!0))},t.Ma=function(t){var e=this.h;e&&e.log(Do,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&qo(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Do,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Do,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},A(Ko,Le);var zo="";Ko.prototype.b=Ro("goog.net.XhrIo");var Wo=/^https?$/i,Go=["POST","PUT"];function Ho(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.N=n,t.G=!1,t.c=!0,t.a=t.D?t.D.a():po.a(),t.A=t.D?wo(t.D):wo(po),t.a.onreadystatechange=E(t.Jb,t);try{Lo(t.b,ns(t,"Opening Xhr")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(e){return Lo(t.b,ns(t,"Error opening Xhr: "+e.message)),void Jo(t,e)}e=r||"";var o=new ze(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(y(t)||u(t))U(t,e,void 0);else for(var n=Ke(t),r=Ve(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Qo,n=t.length,r=u(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:u(t)?t.charAt(e):t[e]}(o.U()),r=a.FormData&&e instanceof a.FormData,!q(Go,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Zo(t),0<t.g&&(t.v=function(t){return Jt&&se(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Lo(t.b,ns(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=E(t.Ga,t)):t.u=je(t.Ga,t.g,t)),Lo(t.b,ns(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Lo(t.b,ns(t,"Send error: "+e.message)),Jo(t,e)}}function Qo(t){return"content-type"==t.toLowerCase()}function Jo(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,$o(t),Xo(t)}function $o(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Yo(t){if(t.c&&void 0!==s)if(t.A[1]&&4==ts(t)&&2==es(t))Lo(t.b,ns(t,"Local request error detected and ignored"));else if(t.i&&4==ts(t))je(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==ts(t)){Lo(t.b,ns(t,"Request complete")),t.c=!1;try{var e,n=es(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(He)[1]||null;if(!o&&a.self&&a.self.location){var u=a.self.location.protocol;o=u.substr(0,u.length-1)}i=!Wo.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<ts(t)?t.a.statusText:""}catch(e){Lo(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+es(t)+"]",$o(t)}}finally{Xo(t)}}}function Xo(t,e){if(t.a){Zo(t);var n=t.a,r=t.A[0]?f:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(Oo,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Zo(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(a.clearTimeout(t.u),t.u=null)}function ts(t){return t.a?t.a.readyState:0}function es(t){try{return 2<ts(t)?t.a.status:-1}catch(t){return-1}}function ns(t,e){return e+" ["+t.N+" "+t.l+" "+es(t)+"]"}function rs(t){var e=ps;this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.m=0}function is(t,e,n){t.a=!0,t.c=n,t.f=!e,us(t)}function os(t){if(t.a){if(!t.l)throw new cs(t);t.l=!1}}function ss(t,e,n,r){t.g.push([e,n,r]),t.a&&us(t)}function as(t){return j(t.g,function(t){return g(t[1])})}function us(t){if(t.h&&t.a&&as(t)){var e=t.h,n=fs[e];n&&(a.clearTimeout(n.a),delete fs[e]),t.h=0}t.b&&(t.b.m--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var u=o.call(i||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(N(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,as(t)||(n=!0)}}t.c=e,r&&(u=E(t.o,t,!0),r=E(t.o,t,!1),e instanceof rs?(ss(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new ls(e),fs[e.a]=e,t.h=e.a)}function cs(){C.call(this)}function hs(){C.call(this)}function ls(t){this.a=a.setTimeout(E(this.c,this),0),this.b=t}(t=Ko.prototype).Ga=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Lo(this.b,ns(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Lo(this.b,ns(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Xo(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Xo(this,!0)),Ko.qb.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?Yo(this):this.wc())},t.wc=function(){Yo(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case zo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Oo,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return Lo(this.b,"Can not get response: "+t.message),null}},rs.prototype.cancel=function(t){if(this.a)this.c instanceof rs&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.m--,0>=e.m&&e.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new hs(this),os(this),is(this,!1,t))}},rs.prototype.o=function(t,e){this.i=!1,is(this,t,e)},rs.prototype.then=function(t,e,n){var r,i,o=new wt(function(t,e){r=t,i=e});return ss(this,r,function(t){t instanceof hs?o.cancel():i(t)}),o.then(t,e,n)},rs.prototype.$goog_Thenable=!0,A(cs,C),cs.prototype.message="Deferred has already fired",cs.prototype.name="AlreadyCalledError",A(hs,C),hs.prototype.message="Deferred was canceled",hs.prototype.name="CanceledError",ls.prototype.c=function(){throw delete fs[this.a],this.b};var fs={};function ds(t){var e={},n=e.document||document,r=Tn(t).toString(),i=document.createElement("SCRIPT"),o={Lb:i,Ga:void 0},s=new rs(o),u=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(u=window.setTimeout(function(){ms(i,!0);var t=new vs(gs,"Timeout reached for loading script "+r);os(s),is(s,!1,t)},c),o.Ga=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(ms(i,e.dd||!1,u),os(s),is(s,!0,null))},i.onerror=function(){ms(i,!0,u);var t=new vs(ys,"Error while loading script "+r);os(s),is(s,!1,t)},ft(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),jn(i,o),function(t,e){t.src=Tn(e),null===l&&(l=(e=(e=a.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&h.test(e)?e:""),(e=l)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),s}function ps(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&ms(t,!0,this.Ga)}}function ms(t,e,n){null!=n&&a.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var ys=0,gs=1;function vs(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),C.call(this,n),this.code=t}function bs(t){this.f=t}function ws(t,e,n){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||Es,this.f=ut(t.secureTokenHeaders||Is),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||Ts,this.a=ut(t.firebaseHeaders||As),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==ar(),!(n=a.XMLHttpRequest||n&&i.a.INTERNAL.node&&i.a.INTERNAL.node.XMLHttpRequest)&&!sr())throw new Qr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,sr()?this.c=new Bo(self):ur()?this.c=new bs(n):this.c=new Eo}A(vs,C),A(bs,bo),bs.prototype.a=function(){return new this.f},bs.prototype.b=function(){return{}};var _s,Ss="idToken",Es=new Nr(3e4,6e4),Is={"Content-Type":"application/x-www-form-urlencoded"},Ts=new Nr(3e4,6e4),As={"Content-Type":"application/json"};function Ns(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Cs(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function Os(t,e,n,r,i,o,s){(function(){var t=pr();return!((t=lr(t)!=hr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Jt&&ie&&!(9<ie))})()||sr()?t=E(t.o,t):(_s||(_s=new wt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{a[ks]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=An(Ds,{onload:ks});!function(t,e){ss(t,null,e,void 0)}(ds(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=E(t.l,t)),t(e,n,r,i,o,s)}ws.prototype.o=function(t,e,n,r,i,o){if(sr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new Qr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Ko(this.c);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}Be(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Lo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),Ue(s,"ready",function(){u&&clearTimeout(u),zt(this)}),Ue(s,"timeout",function(){u&&clearTimeout(u),zt(this),e&&e(null)}),Ho(s,t,n,r,i)};var Ds=new wn(En,"https://apis.google.com/js/client.js?onload=%{onload}"),ks="__fcb"+Math.floor(1e6*Math.random()).toString();function Ms(t){if(!u(t=t.email)||!nr.test(t))throw new Qr("invalid-email")}function xs(t){"email"in t&&Ms(t)}function Ps(t){if(!t[Ss])throw new Qr("internal-error")}function Rs(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Qr("internal-error")}else{if(!t.sessionInfo)throw new Qr("missing-verification-id");if(!t.code)throw new Qr("missing-verification-code")}}ws.prototype.l=function(t,e,n,r,i){var o=this;_s.then(function(){window.gapi.client.setApiKey(o.b);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},ws.prototype.ob=function(){return ga(this,ua,{})},ws.prototype.rb=function(t,e){return ga(this,sa,{idToken:t,email:e})},ws.prototype.sb=function(t,e){return ga(this,aa,{idToken:t,password:e})};var Ls={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Bs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Qr("internal-error")}function Us(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(mn(t=new ln(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Fs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=vo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=vo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=vo(t)):t.errorMessage&&(e=va(t.errorMessage)),e)throw e;if(!t[Ss])throw new Qr("internal-error")}function js(t,e){return e.returnIdpCredential=!0,ga(t,ca,e)}function qs(t,e){return e.returnIdpCredential=!0,ga(t,la,e)}function Vs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ga(t,ha,e)}function Ks(t){if(!t.oobCode)throw new Qr("invalid-action-code")}(t=ws.prototype).tb=function(t,e){var n={idToken:t},r=[];return st(Ls,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),ga(this,sa,n)},t.kb=function(t,e){return ft(t={requestType:"PASSWORD_RESET",email:t},e),ga(this,ea,t)},t.lb=function(t,e){return ft(t={requestType:"EMAIL_SIGNIN",email:t},e),ga(this,Zs,t)},t.jb=function(t,e){return ft(t={requestType:"VERIFY_EMAIL",idToken:t},e),ga(this,ta,t)},t.Ua=function(t){return ga(this,pa,t)},t.Za=function(t,e){return ga(this,ia,{oobCode:t,newPassword:e})},t.Ka=function(t){return ga(this,Ws,{oobCode:t})},t.Wa=function(t){return ga(this,zs,{oobCode:t})};var zs={endpoint:"setAccountInfo",C:Ks,da:"email"},Ws={endpoint:"resetPassword",C:Ks,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Qr("internal-error")}},Gs={endpoint:"signupNewUser",C:function(t){if(Ms(t),!t.password)throw new Qr("weak-password")},J:Ps,R:!0},Hs={endpoint:"createAuthUri"},Qs={endpoint:"deleteAccount",T:["idToken"]},Js={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],C:function(t){if(!m(t.deleteProvider))throw new Qr("internal-error")}},$s={endpoint:"emailLinkSignin",T:["email","oobCode"],C:Ms,J:Ps,R:!0},Ys={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],C:Ms,J:Ps,R:!0},Xs={endpoint:"getAccountInfo"},Zs={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Qr("internal-error");Ms(t)},da:"email"},ta={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],C:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Qr("internal-error")},da:"email"},ea={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Qr("internal-error");Ms(t)},da:"email"},na={wb:!0,endpoint:"getProjectConfig",Ib:"GET"},ra={wb:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Qr("internal-error")}},ia={endpoint:"resetPassword",C:Ks,da:"email"},oa={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},sa={endpoint:"setAccountInfo",T:["idToken"],C:xs,R:!0},aa={endpoint:"setAccountInfo",T:["idToken"],C:function(t){if(xs(t),!t.password)throw new Qr("weak-password")},J:Ps,R:!0},ua={endpoint:"signupNewUser",J:Ps,R:!0},ca={endpoint:"verifyAssertion",C:Bs,Qa:Us,J:Fs,R:!0},ha={endpoint:"verifyAssertion",C:Bs,Qa:Us,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Qr("user-not-found");if(t.errorMessage)throw va(t.errorMessage);if(!t[Ss])throw new Qr("internal-error")},R:!0},la={endpoint:"verifyAssertion",C:function(t){if(Bs(t),!t.idToken)throw new Qr("internal-error")},Qa:Us,J:Fs,R:!0},fa={endpoint:"verifyCustomToken",C:function(t){if(!t.token)throw new Qr("invalid-custom-token")},J:Ps,R:!0},da={endpoint:"verifyPassword",C:function(t){if(Ms(t),!t.password)throw new Qr("wrong-password")},J:Ps,R:!0},pa={endpoint:"verifyPhoneNumber",C:Rs,J:Ps},ma={endpoint:"verifyPhoneNumber",C:function(t){if(!t.idToken)throw new Qr("internal-error");Rs(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",vo(t);Ps(t)}},ya={Wb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",C:Rs,J:Ps};function ga(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.T))return Ct(new Qr("internal-error"));var r,i=e.Ib||"POST";return Nt(n).then(e.C).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var s=tn(t.g+e);Xe(s,"key",t.b),o&&Xe(s,"cb",T().toString());var a="GET"==n;if(a)for(var u in r)r.hasOwnProperty(u)&&Xe(s,u,r[u]);return new wt(function(e,o){Os(t,s.toString(),function(t){t?t.error?o(ba(t,i||{})):e(t):o(new Qr("network-request-failed"))},n,a?void 0:zn(Sr(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Wb,e.wb||!1)}).then(function(t){return r=t,e.Qa?e.Qa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new Qr("internal-error");return r[e.da]})}function va(t){return ba({error:{errors:[{message:t}],code:400,message:t}})}function ba(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Qr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",ft(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Qr(r[i],e);return!e&&t&&(e=_r(t)),new Qr("internal-error",e)}function wa(t){this.b=t,this.a=null,this.fb=function(t){return(Ia||(Ia=new wt(function(t,e){function n(){Ar(),mr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ar(),e(Error("Network Error"))},timeout:Sa.get()})}if(mr("gapi.iframes.Iframe"))t();else if(mr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){mr("gapi.load")?n():e(Error("Network Error"))},Nt(ds(r=An(_a,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw Ia=null,t}))).then(function(){return new wt(function(e,n){mr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:mr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Ea.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var _a=new wn(En,"https://apis.google.com/js/api.js?onload=%{onload}"),Sa=new Nr(3e4,6e4),Ea=new Nr(5e3,15e3),Ia=null;function Ta(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=en(this.i,"/__/auth/iframe"),Xe(this.a,"apiKey",this.g),Xe(this.a,"appName",this.h),this.b=null,this.c=[]}function Aa(t,e,n,r,i){this.o=t,this.l=e,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Na(t){try{return i.a.app(t).auth().ya()}catch(t){return[]}}function Ca(t,e,n,r,i){this.l=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Oa(t){var e=$n();return function(t){return ga(t,na,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=tn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=tn(o).b==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:er.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new yo($n())})}function Da(t){return t.m?t.m:(t.m=rr().then(function(){if(!t.u){var e=t.c,n=t.h,r=Na(t.b),i=new Ta(t.l,t.f,t.b);i.f=e,i.b=n,i.c=W(r||[]),t.u=i.toString()}t.i=new wa(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.fb.then(function(){t.a.register("authEvent",e,mr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=lo(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Nt(n)}return n.status="ERROR",Nt(n)})}(t)}),t.m)}function ka(t){return t.o||(t.v=t.c?dr(t.c,Na(t.b)):null,t.o=new ws(t.f,gi(t.h),t.v)),t.o}function Ma(t,e,n,r,i,o,s,a,u,c){return(t=new Aa(t,e,n,r,i)).i=o,t.g=s,t.h=a,t.b=ut(u||null),t.f=c,t.toString()}function xa(t){if(this.a=t||i.a.INTERNAL.reactNative&&i.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Qr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Pa(t){this.b=t,this.a={},this.c=E(this.f,this)}Ta.prototype.toString=function(){return this.f?Xe(this.a,"v",this.f):pn(this.a.a,"v"),this.b?Xe(this.a,"eid",this.b):pn(this.a.a,"eid"),this.c.length?Xe(this.a,"fw",this.c.join(",")):pn(this.a.a,"fw"),this.a.toString()},Aa.prototype.toString=function(){var t=en(this.o,"/__/auth/handler");if(Xe(t,"apiKey",this.l),Xe(t,"appName",this.c),Xe(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=i.a.app(this.c).auth().ea()}catch(t){n=null}for(var r in e.$a=n,Xe(t,"providerId",this.a.providerId),n=Sr((e=this.a).zb))n[r]=n[r].toString();r=e.Dc,n=ut(n);for(var o=0;o<r.length;o++){var s=r[o];s in n&&delete n[s]}e.cb&&e.$a&&!n[e.cb]&&(n[e.cb]=e.$a),at(n)||Xe(t,"customParameters",_r(n))}if("function"==typeof this.a.Fb&&((e=this.a.Fb()).length&&Xe(t,"scopes",e.join(","))),this.i?Xe(t,"redirectUrl",this.i):pn(t.a,"redirectUrl"),this.g?Xe(t,"eventId",this.g):pn(t.a,"eventId"),this.h?Xe(t,"v",this.h):pn(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Ze(t,a)&&Xe(t,a,this.b[a]);return this.f?Xe(t,"eid",this.f):pn(t.a,"eid"),(a=Na(this.c)).length&&Xe(t,"fw",a.join(",")),t.toString()},(t=Ca.prototype).Ea=function(t,e,n){var r=new Qr("popup-closed-by-user"),i=new Qr("web-storage-unsupported"),o=this,s=!1;return this.ga().then(function(){(function(t){var e={type:"webStorageSupport"};return Da(t).then(function(){return function(t,e){return t.fb.then(function(){return new wt(function(n){t.a.send(e.type,e,n,mr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&Zn(t),e(i),s=!0)})}).s(function(){}).then(function(){if(!s)return function(t){return new wt(function(e){return function n(){qe(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!s)return qe(n).then(function(){e(r)})})},t.Mb=function(){var t=pr();return!wr(t)&&!Tr(t)},t.Hb=function(){return!1},t.Db=function(t,e,n,r,i,o,s){if(!t)return Ct(new Qr("popup-blocked"));if(s&&!wr())return this.ga().s(function(e){Zn(t),i(e)}),r(),Nt();this.a||(this.a=Oa(ka(this)));var a=this;return this.a.then(function(){var e=a.ga().s(function(e){throw Zn(t),i(e),e});return r(),e}).then(function(){(co(n),s)||Yn(Ma(a.l,a.f,a.b,e,n,null,o,a.c,void 0,a.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(a.a=null),t})},t.Ca=function(t,e,n){this.a||(this.a=Oa(ka(this)));var r=this;return this.a.then(function(){co(e),Yn(Ma(r.l,r.f,r.b,t,e,$n(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ga=function(){var t=this;return Da(this).then(function(){return t.i.fb}).s(function(){throw t.a=null,new Qr("network-request-failed")})},t.Pb=function(){return!0},t.wa=function(t){this.g.push(t)},t.La=function(t){K(this.g,function(e){return e==t})},(t=xa.prototype).get=function(t){return Nt(this.a.getItem(t)).then(function(t){return t&&Er(t)})},t.set=function(t,e){return Nt(this.a.setItem(t,_r(e)))},t.P=function(t){return Nt(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var Ra,La=[];function Ba(t){this.a=t}function Ua(t){this.c=t,this.b=!1,this.a=[]}function Fa(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return Ct(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new wt(function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),s=setTimeout(function(){r(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))}).then(function(e){return ja(t,c),e}).s(function(e){throw ja(t,c),e})}function ja(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),K(t.a,function(t){return t==e})}}function qa(){if(!za())throw new Qr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.l=a.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.i=null,this.u=!1,this.h=null;var t=this;sr()&&self?(this.m=function(){var t=sr()?self:null;if(U(La,function(n){n.b==t&&(e=n)}),!e){var e=new Pa(t);La.push(e)}return e}(),this.m.subscribe("keyChanged",function(e,n){return Ja(t).then(function(e){return 0<e.length&&U(t.a,function(t){t(e)}),{keyProcessed:q(e,n.key)}})}),this.m.subscribe("ping",function(){return Nt(["keyChanged"])})):function(){var t=a.navigator;return t&&t.serviceWorker?Nt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Nt(null)}().then(function(e){(t.h=e)&&(t.g=new Ua(new Ba(e)),Fa(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&q(e[0].value,"keyChanged")&&(t.u=!0)}).s(function(){}))})}function Va(t){return new wt(function(e,n){var r=t.l.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new wt(function(e,n){var r=t.l.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return Va(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function Ka(t){return t.o||(t.o=Va(t)),t.o}function za(){try{return!!a.indexedDB}catch(t){return!1}}function Wa(t){return t.objectStore("firebaseLocalStorage")}function Ga(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Ha(t){return new wt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Qa(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Fa(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):Nt()}function Ja(t){return Ka(t).then(function(t){var e=Wa(Ga(t,!1));return e.getAll?Ha(e.getAll()):new wt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function $a(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Ya(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Nt().then(function(){if(za()){var t=Ir(),r="__sak"+t;return Ra||(Ra=new qa),(n=Ra).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){U(e.a,function(e){e(t)})}),t})}function Xa(){this.a={},this.type="inMemory"}function Za(){if(!function(){var t="Node"==ar();if(!(t=tu()||t&&i.a.INTERNAL.node&&i.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ar())throw new Qr("internal-error","The LocalStorage compatibility library was not found.");throw new Qr("web-storage-unsupported")}this.a=tu()||i.a.INTERNAL.node.localStorage,this.type="localStorage"}function tu(){try{var t=a.localStorage,e=Ir();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function eu(){this.type="nullStorage"}function nu(){if(!function(){var t="Node"==ar();if(!(t=ru()||t&&i.a.INTERNAL.node&&i.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ar())throw new Qr("internal-error","The SessionStorage compatibility library was not found.");throw new Qr("web-storage-unsupported")}this.a=ru()||i.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function ru(){try{var t=a.sessionStorage,e=Ir();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function iu(){var t={};t.Browser=au,t.Node=uu,t.ReactNative=cu,t.Worker=hu,this.a=t[ar()]}Pa.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];U(r,function(e){i.push(Nt().then(function(){return e(t.origin,t.data.data)}))}),Dt(i).then(function(r){var i=[];U(r,function(t){i.push({fulfilled:t.Eb,value:t.value,reason:t.reason?t.reason.message:void 0})}),U(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},Pa.prototype.subscribe=function(t,e){at(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},Pa.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(K(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],at(this.a)&&this.b.removeEventListener("message",this.c)},Ba.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Ua.prototype.close=function(){for(;0<this.a.length;)ja(this,this.a[0]);this.b=!0},(t=qa.prototype).set=function(t,e){var n,r=!1,i=this;return Ka(this).then(function(e){return Ha((e=Wa(Ga(n=e,!0))).get(t))}).then(function(o){var s=Wa(Ga(n,!0));return o?(o.value=e,Ha(s.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Ha(s.add(o)))}).then(function(){return i.c[t]=e,Qa(i,t)}).ia(function(){r&&i.b--})},t.get=function(t){return Ka(this).then(function(e){return Ha(Wa(Ga(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.P=function(t){var e=!1,n=this;return Ka(this).then(function(r){return e=!0,n.b++,Ha(Wa(Ga(r,!0)).delete(t))}).then(function(){return delete n.c[t],Qa(n,t)}).ia(function(){e&&n.b--})},t.Y=function(t){0==this.a.length&&function(t){$a(t),function e(){t.f=setTimeout(function(){t.i=Ja(t).then(function(e){0<e.length&&U(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ca=function(t){K(this.a,function(e){return e==t}),0==this.a.length&&$a(this)},(t=Ya.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.P=function(t){return this.b.then(function(e){return e.P(t)})},t.Y=function(t){this.a.push(t)},t.ca=function(t){K(this.a,function(e){return e==t})},(t=Xa.prototype).get=function(t){return Nt(this.a[t])},t.set=function(t,e){return this.a[t]=e,Nt()},t.P=function(t){return delete this.a[t],Nt()},t.Y=function(){},t.ca=function(){},(t=Za.prototype).get=function(t){var e=this;return Nt().then(function(){return Er(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Nt().then(function(){var r=_r(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return Nt().then(function(){e.a.removeItem(t)})},t.Y=function(t){a.window&&Ie(a.window,"storage",t)},t.ca=function(t){a.window&&Ne(a.window,"storage",t)},(t=eu.prototype).get=function(){return Nt(null)},t.set=function(){return Nt()},t.P=function(){return Nt()},t.Y=function(){},t.ca=function(){},(t=nu.prototype).get=function(t){var e=this;return Nt().then(function(){return Er(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Nt().then(function(){var r=_r(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return Nt().then(function(){e.a.removeItem(t)})},t.Y=function(){},t.ca=function(){};var ou,su,au={B:Za,Ra:nu},uu={B:Za,Ra:nu},cu={B:xa,Ra:eu},hu={B:Za,Ra:eu},lu={Xc:"local",NONE:"none",Zc:"session"};function fu(){var t=!(Tr(pr())||!or()),e=wr(),n=yr();this.o=t,this.h=e,this.m=n,this.a={},ou||(ou=new iu),t=ou;try{this.g=!Jn()&&Dr()||!a.indexedDB?new t.a.B:new Ya(sr()?new Xa:new t.a.B)}catch(t){this.g=new Xa,this.h=!0}try{this.i=new t.a.Ra}catch(t){this.i=new Xa}this.l=new Xa,this.f=E(this.Ob,this),this.b={}}function du(){return su||(su=new fu),su}function pu(t,e){switch(e){case"session":return t.i;case"none":return t.l;default:return t.g}}function mu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function yu(t,e,n){return n=mu(e,n),"local"==e.B&&(t.b[n]=null),pu(t,e.B).P(n)}function gu(t){t.c&&(clearInterval(t.c),t.c=null)}function vu(t){this.a=t,this.b=du()}(t=fu.prototype).get=function(t,e){return pu(this,t.B).get(mu(t,e))},t.set=function(t,e,n){var r=mu(t,n),i=this,o=pu(this,t.B);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.B&&(i.b[r]=e)})},t.addListener=function(t,e,n){t=mu(t,e),this.m&&(this.b[t]=a.localStorage.getItem(t)),at(this.a)&&(pu(this,"local").Y(this.f),this.h||(Jn()||!Dr())&&a.indexedDB||!this.m||function(t){gu(t),t.c=setInterval(function(){for(var e in t.a){var n=a.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new de({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Ob(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=mu(t,e),this.a[t]&&(K(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),at(this.a)&&(pu(this,"local").ca(this.f),gu(this))},t.Ob=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Xa(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?pu(this,"local").ca(this.f):gu(this),this.o)if(n=a.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?a.localStorage.setItem(e,r):a.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.Xa(e))},Jt&&ie&&10==ie&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else U(t,E(this.Xa,this))},t.Xa=function(t){this.a[t]&&U(this.a[t],function(t){t()})};var bu,wu={name:"authEvent",B:"local"};function _u(){this.a=du()}function Su(t,e){this.b=Eu,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.m=a.Int32Array?new Int32Array(64):Array(64),void 0!==bu||(bu=a.Int32Array?new Int32Array(Du):Du),this.reset()}A(Su,function(){this.b=-1});for(var Eu=64,Iu=Eu-1,Tu=[],Au=0;Au<Iu;Au++)Tu[Au]=0;var Nu=z(128,Tu);function Cu(t){for(var e=t.f,n=t.m,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&h^~c&l)+(0|bu[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+s|0,u=a,a=i,i=r,r=s+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Ou(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(u(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Cu(t),i=0);else{if(!y(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Cu(t),i=0)}}t.c=i,t.g+=n}Su.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):W(this.h)};var Du=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ku(){Su.call(this,8,Mu)}A(ku,Su);var Mu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function xu(t,e,n,r,i){this.l=t,this.i=e,this.m=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new _u,this.g=new vu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Pu(t){return new Qr("invalid-cordova-configuration",t)}function Ru(t){var e=new ku;Ou(e,t),t=[];var n=8*e.g;56>e.c?Ou(e,Nu,56-e.c):Ou(e,Nu,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Cu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return F(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function Lu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Bu(t){return t.f||(t.f=t.ga().then(function(){return new wt(function(e){t.wa(function n(r){return e(r),t.La(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),Uu(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Mi(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Er(Ze(o=tn(i),"firebaseError")||null))?Jr(o):null)?new ho(r.c,r.b,null,null,o):new ho(r.c,r.b,i,r.f)),i=o||n}Lu(t,i)})}var n=new ho("unknown",null,null,null,new Qr("no-auth-event")),r=!1,i=qe(500).then(function(){return Uu(t).then(function(){r||Lu(t,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(mr("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},mo||(mo=new fo),mo.subscribe(e)}(t)})})),t.f}function Uu(t){var e=null;return function(t){return t.b.get(wu,t.a).then(function(t){return lo(t)})}(t.g).then(function(n){return e=n,yu((n=t.g).b,wu,n.a)}).then(function(){return e})}function Fu(t){this.a=t,this.b=du()}(t=xu.prototype).ga=function(){return this.za?this.za:this.za=(ir(void 0)?rr().then(function(){return new wt(function(t,e){var n=a.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):Ct(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof mr("universalLinks.subscribe",a))throw Pu("cordova-universal-links-plugin-fix is not installed");if(void 0===mr("BuildInfo.packageName",a))throw Pu("cordova-plugin-buildinfo is not installed");if("function"!=typeof mr("cordova.plugins.browsertab.openUrl",a))throw Pu("cordova-plugin-browsertab is not installed");if("function"!=typeof mr("cordova.InAppBrowser.open",a))throw Pu("cordova-plugin-inappbrowser is not installed")},function(){throw new Qr("cordova-not-ready")})},t.Ea=function(t,e){return e(new Qr("operation-not-supported-in-this-environment")),Nt()},t.Db=function(){return Ct(new Qr("operation-not-supported-in-this-environment"))},t.Pb=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,n){if(this.c)return Ct(new Qr("redirect-operation-pending"));var r=this,i=a.document,o=null,s=null,u=null,c=null;return this.c=Nt().then(function(){return co(e),Bu(r)}).then(function(){return function(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),o=new ho(e,r,null,i,new Qr("no-auth-event")),s=mr("BuildInfo.packageName",a);if("string"!=typeof s)throw new Qr("invalid-cordova-configuration");var u=mr("BuildInfo.displayName",a),c={};if(pr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!pr().toLowerCase().match(/android/))return Ct(new Qr("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),i=Ru(i),c.sessionId=i;var h=Ma(t.l,t.i,t.m,e,n,null,r,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(wu,o.w(),e)}).then(function(){var e=mr("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new Qr("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=mr("cordova.plugins.browsertab.openUrl",a)))throw new Qr("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=mr("cordova.InAppBrowser.open",a)))throw new Qr("invalid-cordova-configuration");e=pr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n)}).then(function(){return new wt(function(t,e){s=function(){var e=mr("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(s),u=function(){o||(o=qe(2e3).then(function(){e(new Qr("redirect-cancelled-by-user"))}))},c=function(){Cr()&&u()},i.addEventListener("resume",u,!1),pr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",c,!1)}).s(function(t){return Uu(r).then(function(){throw t})})}).ia(function(){u&&i.removeEventListener("resume",u,!1),c&&i.removeEventListener("visibilitychange",c,!1),o&&o.cancel(),s&&r.La(s),r.c=null})},t.wa=function(t){this.b.push(t),Bu(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new ho("unknown",null,null,null,new Qr("no-auth-event")),t(e))})},t.La=function(t){K(this.b,function(e){return e==t})};var ju={name:"pendingRedirect",B:"session"};function qu(t){return yu(t.b,ju,t.a)}function Vu(t,e,n){this.i={},this.u=0,this.A=t,this.l=e,this.o=n,this.h=[],this.f=!1,this.m=E(this.bb,this),this.b=new Xu,this.v=new nc,this.g=new Fu(this.l+":"+this.o),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=Ku(this.A,this.l,this.o,mi)}function Ku(t,e,n,r){var o=i.a.SDK_VERSION||null;return ir()?new xu(t,e,n,o,r):new Ca(t,e,n,o,r)}function zu(t){t.f||(t.f=!0,t.a.wa(t.m));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function Wu(t){t.a.Mb()&&zu(t).s(function(e){var n=new ho("unknown",null,null,null,new Qr("operation-not-supported-in-this-environment"));Ju(e)&&t.bb(n)}),t.a.Hb()||Zu(t.b)}(t=Vu.prototype).reset=function(){this.f=!1,this.a.La(this.m),this.a=Ku(this.A,this.l,this.o),this.i={}},t.Ya=function(){this.b.Ya()},t.subscribe=function(t){if(q(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(ju,t.a).then(function(t){return"pending"==t})})(this.g).then(function(t){t?qu(e.g).then(function(){zu(e).s(function(t){var n=new ho("unknown",null,null,null,new Qr("operation-not-supported-in-this-environment"));Ju(t)&&e.bb(n)})}):Wu(e)}).s(function(){Wu(e)})}},t.unsubscribe=function(t){K(this.h,function(e){return e==t})},t.bb=function(t){if(!t)throw new Qr("invalid-auth-event");if(6e5<=T()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=T())),e=!0;break}}return Zu(this.b),e};var Gu=new Nr(2e3,1e4),Hu=new Nr(3e4,6e4);function Qu(t,e,n,r,i,o){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.m))},function(){t.reset()},i,o)}function Ju(t){return!(!t||"auth/cordova-not-ready"!=t.code)}Vu.prototype.fa=function(){return this.b.fa()},Vu.prototype.Ca=function(t,e,n){var r,i=this;return function(t){return t.b.set(ju,"pending",t.a)}(this.g).then(function(){return i.a.Ca(t,e,n).s(function(t){if(Ju(t))throw new Qr("operation-not-supported-in-this-environment");return r=t,qu(i.g).then(function(){throw r})}).then(function(){return i.a.Pb()?new wt(function(){}):qu(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},Vu.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},Gu.get())};var $u={};function Yu(t,e,n){var r=e+":"+n;return $u[r]||($u[r]=new Vu(t,e,n)),$u[r]}function Xu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Zu(t){t.g||(t.g=!0,ec(t,!1,null,null))}function tc(t,e){if(t.b=function(){return Nt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function ec(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Ct(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):tc(t,n):tc(t,{user:null}),t.f=[],t.c=[]}function nc(){}function rc(){this.ub=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ub},set:function(t){this.ub=t},enumerable:!1})}function ic(t,e){this.a=e,Rr(this,"verificationId",t)}function oc(t,e,n,r){return new so(t).Ua(e,n).then(function(t){return new ic(t,r)})}function sc(t){var e=pi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Qr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Lr(this,{token:t,expirationTime:Or(1e3*e.exp),authTime:Or(1e3*e.auth_time),issuedAtTime:Or(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function ac(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function uc(t){this.f=t,this.b=this.a=null,this.c=0}function cc(t,e){var n=e[Ss],r=e.refreshToken;e=hc(e.expiresIn),t.b=n,t.c=e,t.a=r}function hc(t){return T()+1e3*parseInt(t,10)}function lc(t,e){return function(t,e){return new wt(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Os(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(ba(t)):t.access_token&&t.refresh_token?n(t):r(new Qr("internal-error")):r(new Qr("network-request-failed"))},"POST",dn(e).toString(),t.f,t.m.get()):r(new Qr("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=hc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function fc(t,e){this.a=t||null,this.b=e||null,Lr(this,{lastSignInTime:Or(e||null),creationTime:Or(t||null)})}function dc(t,e,n,r,i,o){Lr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function pc(t,e){for(var n in fe.call(this,t),e)this[n]=e[n]}function mc(t,e,n){this.G=[],this.l=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=i.a.SDK_VERSION?dr(i.a.SDK_VERSION):null,this.c=new ws(this.l,gi(mi),t),this.h=new uc(this.c),Sc(this,e[Ss]),cc(this.h,e),Rr(this,"refreshToken",this.h.a),Tc(this,n||{}),Le.call(this),this.I=!1,this.u&&gr()&&(this.a=Yu(this.u,this.l,this.o)),this.N=[],this.i=null,this.A=function(t){return new ac(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-T()-3e5;return 0<e?e:0})}(this),this.V=E(this.Ha,this);var r=this;this.ka=null,this.ta=function(t){r.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){gc(r,t.c)},this.W=null}function yc(t,e){t.X&&Ne(t.X,"languageCodeChanged",t.ta),(t.X=e)&&Ie(e,"languageCodeChanged",t.ta)}function gc(t,e){t.O=e,Cs(t.c,i.a.SDK_VERSION?dr(i.a.SDK_VERSION,t.O):null)}function vc(t,e){t.W&&Ne(t.W,"frameworkChanged",t.sa),(t.W=e)&&Ie(e,"frameworkChanged",t.sa)}function bc(t){try{return i.a.app(t.o).auth()}catch(e){throw new Qr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function wc(t){t.D||t.A.b||(t.A.start(),Ne(t,"tokenChanged",t.V),Ie(t,"tokenChanged",t.V))}function _c(t){Ne(t,"tokenChanged",t.V),t.A.stop()}function Sc(t,e){t.ra=e,Rr(t,"_lat",e)}function Ec(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return Dt(e).then(function(){return t})}function Ic(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Tc(t,e){Lr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new fc(e.createdAt,e.lastLoginAt),providerData:[]})}function Ac(){}function Nc(t){return Nt().then(function(){if(t.D)throw new Qr("app-deleted")})}function Cc(t){return F(t.providerData,function(t){return t.providerId})}function Oc(t,e){e&&(Dc(t,e.providerId),t.providerData.push(e))}function Dc(t,e){K(t.providerData,function(t){return t.providerId==e})}function kc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Rr(t,e,n)}function Mc(t,e){t!=e&&(Lr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Rr(t,"metadata",function(t){return new fc(t.a,t.b)}(e.metadata)):Rr(t,"metadata",new fc),U(e.providerData,function(e){Oc(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Rr(t,"refreshToken",t.h.a))}function xc(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return ga(t.c,Xs,{idToken:e}).then(E(t.xc,t))}(t,e).then(function(){return n||kc(t,"isAnonymous",!1),e})})}function Pc(t,e){e[Ss]&&t.ra!=e[Ss]&&(cc(t.h,e),t.dispatchEvent(new pc("tokenChanged")),Sc(t,e[Ss]),kc(t,"refreshToken",t.h.a))}function Rc(t,e){return xc(t).then(function(){if(q(Cc(t),e))return Ec(t).then(function(){throw new Qr("provider-already-linked")})})}function Lc(t,e,n){return Br({user:t,credential:uo(e),additionalUserInfo:e=Si(e),operationType:n})}function Bc(t,e){return Pc(t,e),t.reload().then(function(){return t})}function Uc(t,e,n,r,o){if(!gr())return Ct(new Qr("operation-not-supported-in-this-environment"));if(t.i&&!o)return Ct(t.i);var s=_i(n.providerId),a=Ir(t.uid+":::"),u=null;(!wr()||or())&&t.u&&n.isOAuthProvider&&(u=Ma(t.u,t.l,t.o,e,n,null,a,i.a.SDK_VERSION||null));var c=tr(u,s&&s.Ba,s&&s.Aa);return r=r().then(function(){if(jc(t),!o)return t.F().then(function(){})}).then(function(){return Qu(t.a,c,e,n,a,!!u)}).then(function(){return new wt(function(n,r){t.ha(e,null,new Qr("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.b=t.a.Ea(t,e,c,a)})}).then(function(t){return c&&Zn(c),t?Br(t):null}).s(function(t){throw c&&Zn(c),t}),qc(t,r,o)}function Fc(t,e,n,r,i){if(!gr())return Ct(new Qr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Ct(t.i);var o=null,s=Ir(t.uid+":::");return r=r().then(function(){if(jc(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=s,Ec(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(zc,t.w(),e.a)),e}).then(function(){return t.a.Ca(e,n,s)}).s(function(e){if(o=e,t.ba)return Wc(t.ba);throw o}).then(function(){if(o)throw o}),qc(t,r,i)}function jc(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Qr("internal-error");throw new Qr("auth-domain-config-required")}}function qc(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Ct(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new pc("userInvalidated")),t.i=e),e})}(t,e,n);return t.G.push(r),r.ia(function(){V(t.G,r)}),r}function Vc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[Ss]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-T())/1e3;var r=new mc(e,n,t);return t.providerData&&U(t.providerData,function(t){t&&Oc(r,Br(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function Kc(t){this.a=t,this.b=du()}Xu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Xu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(ec(this,!0,null,t.a),Nt()):e.xa(n,r)?function(t,e,n){n=n.xa(e.c,e.b);var r=e.g,i=e.f,o=e.h,s=!!e.c.match(/Redirect$/);n(r,i,o).then(function(e){ec(t,s,e,null)}).s(function(e){ec(t,s,null,e)})}(this,t,e):Ct(new Qr("invalid-auth-event")):(ec(this,!1,null,null),Nt())}else Ct(new Qr("invalid-auth-event"))},Xu.prototype.Ya=function(){this.g&&!this.i&&ec(this,!1,null,null)},Xu.prototype.fa=function(){var t=this;return new wt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Qr("timeout");t.a&&t.a.cancel(),t.a=qe(Hu.get()).then(function(){t.b||(t.g=!0,ec(t,!0,null,e))})}(t))})},nc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ha(t.c,null,t.a,t.b),Nt()):e.xa(n,r)?function(t,e){var n=t.b,r=t.c;e.xa(r,n)(t.g,t.f,t.h).then(function(t){e.ha(r,t,null,n)}).s(function(t){e.ha(r,null,t,n)})}(t,e):Ct(new Qr("invalid-auth-event"))}else Ct(new Qr("invalid-auth-event"))},ic.prototype.confirm=function(t){return t=ao(this.verificationId,t),this.a(t)},ac.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=qe(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=a.document,e=null,Cr()||!t?Nt():new wt(function(n){e=function(){Cr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},ac.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},uc.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},uc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ct(new Qr("user-token-expired")):t||!this.b||T()>this.c-3e4?this.a?lc(this,{grant_type:"refresh_token",refresh_token:this.a}):Nt(null):Nt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},fc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},A(pc,fe),A(mc,Le),mc.prototype.pa=function(t){this.ka=t,Ns(this.c,t)},mc.prototype.ea=function(){return this.ka},mc.prototype.ya=function(){return W(this.O)},mc.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},Rr(mc.prototype,"providerId","firebase"),(t=mc.prototype).reload=function(){var t=this;return qc(this,Nc(this).then(function(){return xc(t).then(function(){return Ec(t)}).then(Ac)}))},t.bc=function(t){return this.F(t).then(function(t){return new sc(t)})},t.F=function(t){var e=this;return qc(this,Nc(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Qr("internal-error");return t.accessToken!=e.ra&&(Sc(e,t.accessToken),e.dispatchEvent(new pc("tokenChanged"))),kc(e,"refreshToken",t.refreshToken),t.accessToken}))},t.xc=function(t){if(!(t=t.users)||!t.length)throw new Qr("internal-error");Tc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?F(t,function(t){return new dc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Oc(this,e[n]);kc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.yc=function(t){return xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.gb(t)},t.gb=function(t){var e=this,n=null;return qc(this,t.f(this.c,this.uid).then(function(t){return Pc(e,t),n=Lc(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.pc=function(t){return xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.eb(t)},t.eb=function(t){var e=this,n=null;return qc(this,Rc(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=Lc(e,t,"link"),Bc(e,t)}).then(function(){return n}))},t.qc=function(t,e){var n=this;return qc(this,Rc(this,"phone").then(function(){return oc(bc(n),t,e,E(n.eb,n))}))},t.zc=function(t,e){var n=this;return qc(this,Nt().then(function(){return oc(bc(n),t,e,E(n.gb,n))}),!0)},t.rb=function(t){var e=this;return qc(this,this.F().then(function(n){return e.c.rb(n,t)}).then(function(t){return Pc(e,t),e.reload()}))},t.Pc=function(t){var e=this;return qc(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return Pc(e,t),e.reload()}))},t.sb=function(t){var e=this;return qc(this,this.F().then(function(n){return e.c.sb(n,t)}).then(function(t){return Pc(e,t),e.reload()}))},t.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Nc(this);var e=this;return qc(this,this.F().then(function(n){return e.c.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Pc(e,t),kc(e,"displayName",t.displayName||null),kc(e,"photoURL",t.photoUrl||null),U(e.providerData,function(t){"password"===t.providerId&&(Rr(t,"displayName",e.displayName),Rr(t,"photoURL",e.photoURL))}),Ec(e)}).then(Ac))},t.Nc=function(t){var e=this;return qc(this,xc(this).then(function(n){return q(Cc(e),t)?function(t,e,n){return ga(t,Js,{idToken:e,deleteProvider:n})}(e.c,n,[t]).then(function(t){var n={};return U(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),U(Cc(e),function(t){n[t]||Dc(e,t)}),n[so.PROVIDER_ID]||Rr(e,"phoneNumber",null),Ec(e)}):Ec(e).then(function(){throw new Qr("no-such-provider")})}))},t.delete=function(){var t=this;return qc(this,this.F().then(function(e){return ga(t.c,Qs,{idToken:e})}).then(function(){t.dispatchEvent(new pc("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");yc(t,null),vc(t,null),t.G=[],t.D=!0,_c(t),Rr(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},t.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?E(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?E(this.Cb,this):"linkViaRedirect"==t&&(this.aa||null)==e?E(this.Bb,this):"reauthViaRedirect"==t&&(this.aa||null)==e?E(this.Cb,this):null},t.rc=function(t){var e=this;return Uc(this,"linkViaPopup",t,function(){return Rc(e,t.providerId).then(function(){return Ec(e)})},!1)},t.Ac=function(t){return Uc(this,"reauthViaPopup",t,function(){return Nt()},!0)},t.sc=function(t){var e=this;return Fc(this,"linkViaRedirect",t,function(){return Rc(e,t.providerId)},!1)},t.Bc=function(t){return Fc(this,"reauthViaRedirect",t,function(){return Nt()},!0)},t.Bb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return qc(this,this.F().then(function(i){return qs(r.c,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=Lc(r,t,"link"),Bc(r,t)}).then(function(){return i}))},t.Cb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return qc(this,Nt().then(function(){return Pi(Vs(r.c,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=Lc(r,t,"reauthenticate"),Pc(r,t),r.i=null,r.reload()}).then(function(){return i}),!0)},t.jb=function(t){var e=this,n=null;return qc(this,this.F().then(function(e){return n=e,void 0===t||at(t)?{}:ui(new Xr(t))}).then(function(t){return e.c.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&ft(t,this.metadata.w()),U(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var zc={name:"redirectUser",B:"session"};function Wc(t){return yu(t.b,zc,t.a)}function Gc(t){this.a=t,this.b=du(),this.c=null,this.f=function(t){var e=Jc("local"),n=Jc("session"),r=Jc("none");return function(t,e,n){var r=mu(e,n),i=pu(t,e.B);return t.get(e,n).then(function(o){var s=null;try{s=Er(a.localStorage.getItem(r))}catch(t){}if(s&&!o)return a.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Qc,t.a).then(function(t){return t?Jc(t):e})})})}).then(function(e){return t.c=e,Hc(t,e.B)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(Jc("local"),this.a,E(this.g,this))}function Hc(t,e){var n,r=[];for(n in lu)lu[n]!==e&&r.push(yu(t.b,Jc(lu[n]),t.a));return r.push(yu(t.b,Qc,t.a)),function(t){return new wt(function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},a=0;a<t.length;a++)Ot(t[a],I(o,a),s);else e(i)})}(r)}Gc.prototype.g=function(){var t=this,e=Jc("local");Zc(this,function(){return Nt().then(function(){return t.c&&"local"!=t.c.B?t.b.get(e,t.a):null}).then(function(n){if(n)return Hc(t,"local").then(function(){t.c=e})})})};var Qc={name:"persistence",B:"session"};function Jc(t){return{name:"authUser",B:t}}function $c(t,e){return Zc(t,function(){return t.b.set(t.c,e.w(),t.a)})}function Yc(t){return Zc(t,function(){return yu(t.b,t.c,t.a)})}function Xc(t,e){return Zc(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Vc(t||{})})})}function Zc(t,e){return t.f=t.f.then(e,e),t.f}function th(t){if(this.l=!1,Rr(this,"settings",new rc),Rr(this,"app",t),!ah(this).options||!ah(this).options.apiKey)throw new Qr("invalid-api-key");t=i.a.SDK_VERSION?dr(i.a.SDK_VERSION):null,this.c=new ws(ah(this).options&&ah(this).options.apiKey,gi(mi),t),this.N=[],this.o=[],this.I=[],this.Sb=i.a.INTERNAL.createSubscribe(E(this.mc,this)),this.O=void 0,this.Tb=i.a.INTERNAL.createSubscribe(E(this.nc,this)),oh(this,null),this.h=new Gc(ah(this).options.apiKey+":"+ah(this).name),this.A=new Kc(ah(this).options.apiKey+":"+ah(this).name),this.V=lh(this,function(t){var e=ah(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(zc,t.a).then(function(t){return t&&e&&(t.authDomain=e),Vc(t||{})})}(t.A,ah(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ba=t.A),Wc(t.A)});return lh(t,e)}(t).then(function(){return Xc(t.h,e)}).then(function(e){return e?(e.ba=t.A,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then(function(){return $c(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:Yc(t.h)})):null}).then(function(e){oh(t,e||null)});return lh(t,n)}(this)),this.i=lh(this,function(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.l)return t.ka()}).s(function(){}).then(function(){if(!t.l){t.X=!0;var e=t.h;e.b.addListener(Jc("local"),e.a,t.ka)}})}(this)),this.X=!1,this.ka=E(this.Kc,this),this.Ha=E(this.Z,this),this.ra=E(this.$b,this),this.sa=E(this.jc,this),this.ta=E(this.kc,this),function(t){var e=ah(t).options.authDomain,n=ah(t).options.apiKey;e&&gr()&&(t.Rb=t.V.then(function(){if(!t.l){if(t.a=Yu(e,n,ah(t).name),t.a.subscribe(t),uh(t)&&Ic(uh(t)),t.D){Ic(t.D);var r=t.D;r.pa(t.ea()),yc(r,t),gc(r=t.D,t.G),vc(r,t),t.D=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=E(this.delete,this),this.INTERNAL.logFramework=E(this.tc,this),this.u=0,Le.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}(this),this.G=[]}function eh(t){fe.call(this,"languageCodeChanged"),this.g=t}function nh(t){fe.call(this,"frameworkChanged"),this.c=t}function rh(t){return t.Rb||Ct(new Qr("auth-domain-config-required"))}function ih(t,e){var n={};return n.apiKey=ah(t).options.apiKey,n.authDomain=ah(t).options.authDomain,n.appName=ah(t).name,t.V.then(function(){return function(t,e,n,r){var i=new mc(t,e);return n&&(i.ba=n),r&&gc(i,r),i.reload().then(function(){return i})}(n,e,t.A,t.ya())}).then(function(e){return uh(t)&&e.uid==uh(t).uid?(Mc(uh(t),e),t.Z(e)):(oh(t,e),Ic(e),t.Z(e))}).then(function(){hh(t)})}function oh(t,e){uh(t)&&(function(t,e){K(t.N,function(t){return t==e})}(uh(t),t.Ha),Ne(uh(t),"tokenChanged",t.ra),Ne(uh(t),"userDeleted",t.sa),Ne(uh(t),"userInvalidated",t.ta),_c(uh(t))),e&&(e.N.push(t.Ha),Ie(e,"tokenChanged",t.ra),Ie(e,"userDeleted",t.sa),Ie(e,"userInvalidated",t.ta),0<t.u&&wc(e)),Rr(t,"currentUser",e),e&&(e.pa(t.ea()),yc(e,t),gc(e,t.G),vc(e,t))}function sh(t,e){var n=null,r=null;return lh(t,e.then(function(e){return n=uo(e),r=Si(e),ih(t,e)}).then(function(){return Br({user:uh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function ah(t){return t.app}function uh(t){return t.currentUser}function ch(t){return uh(t)&&uh(t)._lat||null}function hh(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](ch(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](ch(t))}}function lh(t,e){return t.N.push(e),e.ia(function(){V(t.N,e)}),e}function fh(){}function dh(){this.a={},this.b=1e12}Gc.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new Qr("invalid-persistence-type"),n=new Qr("unsupported-persistence-type");t:{for(r in lu)if(lu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(ar()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!yr()&&"none"!==t)throw n}}(t),Zc(this,function(){return t!=n.c.B?n.b.get(n.c,n.a).then(function(r){return e=r,Hc(n,t)}).then(function(){if(n.c=Jc(t),e)return n.b.set(n.c,e,n.a)}):Nt()})},A(th,Le),A(eh,fe),A(nh,fe),(t=th.prototype).mb=function(t){return lh(this,t=this.h.mb(t))},t.pa=function(t){this.W===t||this.l||(this.W=t,Ns(this.c,this.W),this.dispatchEvent(new eh(this.ea())))},t.ea=function(){return this.W},t.Qc=function(){var t=a.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.tc=function(t){this.G.push(t),Cs(this.c,i.a.SDK_VERSION?dr(i.a.SDK_VERSION,this.G):null),this.dispatchEvent(new nh(this.G))},t.ya=function(){return W(this.G)},t.toJSON=function(){return{apiKey:ah(this).options.apiKey,authDomain:ah(this).options.authDomain,appName:ah(this).name,currentUser:uh(this)&&uh(this).w()}},t.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?E(this.Zb,this):null},t.Zb=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var i=null,o=null,s=js(r.c,t).then(function(t){return i=uo(t),o=Si(t),t});return lh(this,t=r.V.then(function(){return s}).then(function(t){return ih(r,t)}).then(function(){return Br({user:uh(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}))},t.Ic=function(t){if(!gr())return Ct(new Qr("operation-not-supported-in-this-environment"));var e=this,n=_i(t.providerId),r=Ir(),o=null;(!wr()||or())&&ah(this).options.authDomain&&t.isOAuthProvider&&(o=Ma(ah(this).options.authDomain,ah(this).options.apiKey,ah(this).name,"signInViaPopup",t,null,r,i.a.SDK_VERSION||null));var s=tr(o,n&&n.Ba,n&&n.Aa);return lh(this,n=rh(this).then(function(e){return Qu(e,s,"signInViaPopup",t,r,!!o)}).then(function(){return new wt(function(t,n){e.ha("signInViaPopup",null,new Qr("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.b=e.a.Ea(e,"signInViaPopup",s,r)})}).then(function(t){return s&&Zn(s),t?Br(t):null}).s(function(t){throw s&&Zn(s),t}))},t.Jc=function(t){if(!gr())return Ct(new Qr("operation-not-supported-in-this-environment"));var e=this;return lh(this,rh(this).then(function(){return Zc(t=e.h,function(){return t.b.set(Qc,t.c.B,t.a)});var t}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},t.fa=function(){if(!gr())return Ct(new Qr("operation-not-supported-in-this-environment"));var t=this;return lh(this,rh(this).then(function(){return t.a.fa()}).then(function(t){return t?Br(t):null}))},t.Oc=function(t){if(!t)return Ct(new Qr("null-user"));var e=this,n={};n.apiKey=ah(this).options.apiKey,n.authDomain=ah(this).options.authDomain,n.appName=ah(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[Ss]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-T())/1e3,e=new mc(e,o),n&&(e.ba=n),r&&gc(e,r),Mc(e,t),e}(t,n,e.A,e.ya());return lh(this,this.i.then(function(){if(ah(e).options.apiKey!=t.l)return r.reload()}).then(function(){return uh(e)&&t.uid==uh(e).uid?(Mc(uh(e),t),e.Z(t)):(oh(e,r),Ic(r),e.Z(r))}).then(function(){hh(e)}))},t.pb=function(){var t=this;return lh(this,this.i.then(function(){return uh(t)?(oh(t,null),Yc(t.h).then(function(){hh(t)})):Nt()}))},t.Kc=function(){var t=this;return Xc(this.h,ah(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=uh(t)&&e){n=uh(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Mc(uh(t),e),uh(t).F();(uh(t)||e)&&(oh(t,e),e&&(Ic(e),e.ba=t.A),t.a&&t.a.subscribe(t),hh(t))}})},t.Z=function(t){return $c(this.h,t)},t.$b=function(){hh(this),this.Z(uh(this))},t.jc=function(){this.pb()},t.kc=function(){this.pb()},t.mc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(uh(e))})},t.nc=function(t){var e=this;!function(t,e){t.I.push(e),lh(t,t.i.then(function(){!t.l&&q(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(ch(t)))}))}(this,function(){t.next(uh(e))})},t.vc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){g(t)?t(uh(r)):g(t.next)&&t.next(uh(r))}),this.Sb(t,e,n)},t.uc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){r.O=r.getUid(),g(t)?t(uh(r)):g(t.next)&&t.next(uh(r))}),this.Tb(t,e,n)},t.ac=function(t){var e=this;return lh(this,this.i.then(function(){return uh(e)?uh(e).F(t).then(function(t){return{accessToken:t}}):null}))},t.Ec=function(t){var e=this;return this.i.then(function(){return sh(e,ga(e.c,fa,{token:t}))}).then(function(t){var n=t.user;return kc(n,"isAnonymous",!1),e.Z(n),t})},t.Fc=function(t,e){var n=this;return this.i.then(function(){return sh(n,ga(n.c,da,{email:t,password:e}))})},t.Vb=function(t,e){var n=this;return this.i.then(function(){return sh(n,ga(n.c,Gs,{email:t,password:e}))})},t.Nb=function(t){var e=this;return this.i.then(function(){return sh(e,t.la(e.c))})},t.nb=function(t){return xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Nb(t)},t.ob=function(){var t=this;return this.i.then(function(){var e=uh(t);if(e&&e.isAnonymous){var n=Br({providerId:null,isNewUser:!1});return Br({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return sh(t,t.c.ob()).then(function(e){var n=e.user;return kc(n,"isAnonymous",!0),t.Z(n),e})})},t.getUid=function(){return uh(this)&&uh(this).uid||null},t.Ub=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&uh(this)&&wc(uh(this))},t.Cc=function(t){var e=this;U(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&uh(this)&&_c(uh(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.o.push(t),lh(this,this.i.then(function(){e.l||q(e.o,t)&&t(ch(e))}))},t.removeAuthTokenListener=function(t){K(this.o,function(e){return e==t})},t.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(Jc("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Ya()),Promise.resolve()},t.Yb=function(t){return lh(this,function(t,e){return ga(t,Hs,{identifier:e,continueUri:vr()?$n():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.c,t))},t.oc=function(t){return!!no(t)},t.lb=function(t,e){var n=this;return lh(this,Nt().then(function(){var t=new Xr(e);if(!t.c)throw new Qr("argument-error",ei+" must be true when sending sign in link to email");return ui(t)}).then(function(e){return n.c.lb(t,e)}).then(function(){}))},t.Rc=function(t){return this.Ka(t).then(function(t){return t.data.email})},t.Za=function(t,e){return lh(this,this.c.Za(t,e).then(function(){}))},t.Ka=function(t){return lh(this,this.c.Ka(t).then(function(t){return new Fr(t)}))},t.Wa=function(t){return lh(this,this.c.Wa(t).then(function(){}))},t.kb=function(t,e){var n=this;return lh(this,Nt().then(function(){return void 0===e||at(e)?{}:ui(new Xr(e))}).then(function(e){return n.c.kb(t,e)}).then(function(){}))},t.Hc=function(t,e){return lh(this,oc(this,t,e,E(this.nb,this)))},t.Gc=function(t,e){var n=this;return lh(this,Nt().then(function(){var r=eo(t,e||$n());return n.nb(r)}))},fh.prototype.render=function(){},fh.prototype.reset=function(){},fh.prototype.getResponse=function(){},fh.prototype.execute=function(){};var ph=null;function mh(t,e){return(e=yh(e))&&t.a[e]||null}function yh(t){return(t=void 0===t?1e12:t)?t.toString():null}function gh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Fn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Ie(this.f,"click",this.i)}function vh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function bh(){}dh.prototype.render=function(t,e){return this.a[this.b.toString()]=new gh(t,e),this.b++},dh.prototype.reset=function(t){var e=mh(this,t);t=yh(t),e&&t&&(e.delete(),delete this.a[t])},dh.prototype.getResponse=function(t){return(t=mh(this,t))?t.getResponse():null},dh.prototype.execute=function(t){(t=mh(this,t))&&t.execute()},gh.prototype.getResponse=function(){return vh(this),this.b},gh.prototype.execute=function(){vh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},gh.prototype.delete=function(){vh(this),this.g=!0,clearTimeout(this.a),this.a=null,Ne(this.f,"click",this.i)},bh.prototype.g=function(){return ph||(ph=new dh),Nt(ph)},bh.prototype.c=function(){};var wh=null;function _h(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Sh=new wn(En,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Eh=new Nr(3e4,6e4);_h.prototype.g=function(t){var e=this;return new wt(function(n,r){var i=setTimeout(function(){r(new Qr("network-request-failed"))},Eh.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new Qr("internal-error"));delete a[e.a]},Nt(ds(An(Sh,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(i),r(new Qr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(a.grecaptcha))})},_h.prototype.c=function(){this.b--};var Ih=null;function Th(t,e,n,r,i,o,s){if(Rr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.l=e,this.g=null,s?(wh||(wh=new bh),s=wh):(Ih||(Ih=new _h),s=Ih),this.o=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Ch])throw new Qr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Oh],!a.document)throw new Qr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Fn(e)||!this.i&&Fn(e).hasChildNodes())throw new Qr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new ws(t,o||null,i||null),this.v=r||function(){return null};var u=this;this.m=[];var c=this.a[Ah];this.a[Ah]=function(t){if(Dh(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=mr(c,a);"function"==typeof e&&e(t)}};var h=this.a[Nh];this.a[Nh]=function(){if(Dh(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=mr(h,a);"function"==typeof t&&t()}}}var Ah="callback",Nh="expired-callback",Ch="sitekey",Oh="size";function Dh(t,e){for(var n=0;n<t.m.length;n++)try{t.m[n](e)}catch(t){}}function kh(t,e){return t.h.push(e),e.ia(function(){V(t.h,e)}),e}function Mh(t){if(t.D)throw new Qr("internal-error","RecaptchaVerifier instance has been destroyed.")}function xh(t,e,n){var r=!1;try{this.b=n||i.a.app()}catch(t){throw new Qr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Qr("invalid-api-key");n=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().ya()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}s=i.a.SDK_VERSION?dr(i.a.SDK_VERSION,s):null,Th.call(this,n,t,e,function(){try{var t=o.b.auth().ea()}catch(e){t=null}return t},s,gi(mi),r)}function Ph(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new Qr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Rh.length)throw new Qr("internal-error","Argument validator received an unsupported number of arguments.");n=Rh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new Qr("argument-error",t+" failed: "+r)}(t=Th.prototype).za=function(){var t=this;return this.f?this.f:this.f=kh(this,Nt().then(function(){if(vr()&&!sr())return rr();throw new Qr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,ga(t.u,ra,{})}).then(function(e){t.a[Ch]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){Mh(this);var t=this;return kh(this,this.za().then(function(){if(null===t.c){var e=t.l;if(!t.i){var n=Fn(e);e=Vn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Mh(this);var t=this;return kh(this,this.render().then(function(e){return new wt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){K(t.m,function(t){return t==e})}(t,i),n(e))};t.m.push(i),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Mh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Mh(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Fn(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},A(xh,Th);var Rh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Lh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:u}}function Bh(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:c}}function Uh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:v}}function Fh(t,e){return{name:t||"",K:"a function",optional:!!e,M:g}}function jh(t,e){return{name:t||"",K:"null",optional:!!e,M:p}}function qh(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function Vh(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&u(t.type)&&g(t.verify))}}}function Kh(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function zh(t,e){for(var n in e){var r=e[n].name;t[r]=Hh(r,t[n],e[n].j)}}function Wh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I(function(t){return this[t]},n),set:I(function(t,e,n,r){Ph(t,[n],[r],!0),this[e]=r},r,n,e[n].vb),enumerable:!0})}}function Gh(t,e,n,r){t[e]=Hh(e,n,r)}function Hh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Ph(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}zh(th.prototype,{Wa:{name:"applyActionCode",j:[Lh("code")]},Ka:{name:"checkActionCode",j:[Lh("code")]},Za:{name:"confirmPasswordReset",j:[Lh("code"),Lh("newPassword")]},Vb:{name:"createUserWithEmailAndPassword",j:[Lh("email"),Lh("password")]},Yb:{name:"fetchSignInMethodsForEmail",j:[Lh("email")]},fa:{name:"getRedirectResult",j:[]},oc:{name:"isSignInWithEmailLink",j:[Lh("emailLink")]},uc:{name:"onAuthStateChanged",j:[Kh(Uh(),Fh(),"nextOrObserver"),Fh("opt_error",!0),Fh("opt_completed",!0)]},vc:{name:"onIdTokenChanged",j:[Kh(Uh(),Fh(),"nextOrObserver"),Fh("opt_error",!0),Fh("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[Lh("email"),Kh(Uh("opt_actionCodeSettings",!0),jh(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[Lh("email"),Uh("actionCodeSettings")]},mb:{name:"setPersistence",j:[Lh("persistence")]},nb:{name:"signInAndRetrieveDataWithCredential",j:[qh()]},ob:{name:"signInAnonymously",j:[]},Nb:{name:"signInWithCredential",j:[qh()]},Ec:{name:"signInWithCustomToken",j:[Lh("token")]},Fc:{name:"signInWithEmailAndPassword",j:[Lh("email"),Lh("password")]},Gc:{name:"signInWithEmailLink",j:[Lh("email"),Lh("emailLink",!0)]},Hc:{name:"signInWithPhoneNumber",j:[Lh("phoneNumber"),Vh()]},Ic:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"updateCurrentUser",j:[Kh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof mc)}},jh(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Lh(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[Lh("code")]}}),Wh(th.prototype,{lc:{name:"languageCode",vb:Kh(Lh(),jh(),"languageCode")}}),th.Persistence=lu,th.Persistence.LOCAL="local",th.Persistence.SESSION="session",th.Persistence.NONE="none",zh(mc.prototype,{delete:{name:"delete",j:[]},bc:{name:"getIdTokenResult",j:[Bh("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Bh("opt_forceRefresh",!0)]},pc:{name:"linkAndRetrieveDataWithCredential",j:[qh()]},eb:{name:"linkWithCredential",j:[qh()]},qc:{name:"linkWithPhoneNumber",j:[Lh("phoneNumber"),Vh()]},rc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},sc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},yc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[qh()]},gb:{name:"reauthenticateWithCredential",j:[qh()]},zc:{name:"reauthenticateWithPhoneNumber",j:[Lh("phoneNumber"),Vh()]},Ac:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Bc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[Kh(Uh("opt_actionCodeSettings",!0),jh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Lh(null,!0)]},Nc:{name:"unlink",j:[Lh("provider")]},rb:{name:"updateEmail",j:[Lh("email")]},sb:{name:"updatePassword",j:[Lh("password")]},Pc:{name:"updatePhoneNumber",j:[qh("phone")]},tb:{name:"updateProfile",j:[Uh("profile")]}}),zh(dh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),zh(fh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),zh(wt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Wh(rc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",vb:Bh("appVerificationDisabledForTesting")}}),zh(ic.prototype,{confirm:{name:"confirm",j:[Lh("verificationCode")]}}),Gh(xi,"fromJSON",function(t){t=u(t)?JSON.parse(t):t;for(var e,n=[ji,Zi,io,Bi],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[Kh(Lh(),Uh(),"json")]),Gh(to,"credential",function(t,e){return new Xi(t,e)},[Lh("email"),Lh("password")]),zh(Xi.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),zh(zi.prototype,{ua:{name:"addScope",j:[Lh("scope")]},Da:{name:"setCustomParameters",j:[Uh("customOAuthParameters")]}}),Gh(zi,"credential",Wi,[Kh(Lh(),Uh(),"token")]),Gh(to,"credentialWithLink",eo,[Lh("email"),Lh("emailLink")]),zh(Gi.prototype,{ua:{name:"addScope",j:[Lh("scope")]},Da:{name:"setCustomParameters",j:[Uh("customOAuthParameters")]}}),Gh(Gi,"credential",Hi,[Kh(Lh(),Uh(),"token")]),zh(Qi.prototype,{ua:{name:"addScope",j:[Lh("scope")]},Da:{name:"setCustomParameters",j:[Uh("customOAuthParameters")]}}),Gh(Qi,"credential",Ji,[Kh(Lh(),Kh(Uh(),jh()),"idToken"),Kh(Lh(),jh(),"accessToken",!0)]),zh($i.prototype,{Da:{name:"setCustomParameters",j:[Uh("customOAuthParameters")]}}),Gh($i,"credential",Yi,[Kh(Lh(),Uh(),"token"),Lh("secret",!0)]),zh(Ki.prototype,{ua:{name:"addScope",j:[Lh("scope")]},credential:{name:"credential",j:[Kh(Lh(),Kh(Uh(),jh()),"optionsOrIdToken"),Kh(Lh(),jh(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[Uh("customOAuthParameters")]}}),zh(Ui.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),zh(Ri.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),Gh(so,"credential",ao,[Lh("verificationId"),Lh("verificationCode")]),zh(so.prototype,{Ua:{name:"verifyPhoneNumber",j:[Lh("phoneNumber"),Vh()]}}),zh(ro.prototype,{w:{name:"toJSON",j:[Lh(null,!0)]}}),zh(Qr.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),zh(go.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),zh(yo.prototype,{toJSON:{name:"toJSON",j:[Lh(null,!0)]}}),zh(xh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===i.a||!i.a.INTERNAL||!i.a.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:th,AuthCredential:xi,Error:Qr};Gh(t,"EmailAuthProvider",to,[]),Gh(t,"FacebookAuthProvider",zi,[]),Gh(t,"GithubAuthProvider",Gi,[]),Gh(t,"GoogleAuthProvider",Qi,[]),Gh(t,"TwitterAuthProvider",$i,[]),Gh(t,"OAuthProvider",Ki,[Lh("providerId")]),Gh(t,"SAMLAuthProvider",Vi,[Lh("providerId")]),Gh(t,"PhoneAuthProvider",so,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof th)}}]),Gh(t,"RecaptchaVerifier",xh,[Kh(Lh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Uh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof i.a.app.App)}}]),i.a.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:E((t=new th(t)).getUid,t),getToken:E(t.ac,t),addAuthTokenListener:E(t.Ub,t),removeAuthTokenListener:E(t.Cc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),i.a.INTERNAL.extendNamespace({User:mc})}()}).apply(self)},function(t,e,n){"use strict";n.r(e),n.d(e,"LogLevel",function(){return r}),n.d(e,"Logger",function(){return a}),n.d(e,"setLogLevel",function(){return u});
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var r,i=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));var o=r.INFO,s=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case r.DEBUG:case r.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},a=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=s,i.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.ERROR].concat(t))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function u(t){i.forEach(function(e){e.logLevel=t})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(48),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!=a){var h=s<<4&240|a>>2;if(r.push(h),64!=u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var l=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var d="FirebaseError",p=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=d,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(y,function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"})}(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new p(i,a),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();var y=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(t){return JSON.parse(t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var v=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=g(c(o[0])||""),n=g(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},b=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},w=function(t,e){return b(e,function(e,n){t[e]=n}),t},_=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},S=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var E=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=I),void 0===r.error&&(r.error=I),void 0===r.complete&&(r.complete=I);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function I(){}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e.CONSTANTS=i,e.Deferred=l,e.ErrorFactory=m,e.FirebaseError=p,e.Sha1=S,e.assert=o,e.assertionError=s,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=u,e.base64Decode=c,e.base64Encode=function(t){var e=a(t);return u.encodeByteArray(e,!0)},e.clone=function(t){return w({},t)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new E(t,e);return n.subscribe.bind(n)},e.decode=v,e.deepCopy=
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t){return h(void 0,t)},e.deepExtend=h,e.errorPrefix=T,e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},e.extend=w,e.findKey=_,e.findValue=function(t,e,n){var r=_(t,e,n);return r&&t[r]},e.forEach=b,e.getAnyKey=function(t){for(var e in t)return e},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.getUA=f,e.getValues=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},e.isAdmin=function(t){var e=v(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return self.self===self},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.isMobileCordova=function(){return!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isValidFormat=function(t){var e=v(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e,n,r=v(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof r&&(r.hasOwnProperty("nbf")?e=r.nbf:r.hasOwnProperty("iat")&&(e=r.iat),n=r.hasOwnProperty("exp")?r.exp:e+86400),i&&e&&n&&i>=e&&i<=n},e.issuedAtTime=function(t){var e=v(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=g,e.map=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},e.patchProperty=function(t,e,n){t[e]=n},e.querystring=function(t){var e=[];return b(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;o(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(T(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(T(t,e,r)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(T(t,e,r)+"must be a valid firebase namespace.")}},function(t,e){t.exports.encryptSecretJSON=async function(t,e){const n=await this.sodium.encryptSecret(JSON.stringify(t),e);return Buffer.from(n)},t.exports.decryptSecretJSON=async function(t,e){const n=await this.sodium.decryptSecret(t,e);return JSON.parse(Buffer.from(n))},t.exports.encryptBoxJSON=async function(t,{toPublic:e,fromPrivate:n}){const r=await this.sodium.encryptBox(JSON.stringify(t),e,n);return Buffer.from(r)},t.exports.decryptBoxJSON=async function(t,{fromPublic:e,toPrivate:n}){const r=await this.sodium.decryptBox(t,e,n);return JSON.parse(Buffer.from(r))}},function(t,e){t.exports={bufToHex:t=>{if(Buffer.isBuffer(t))return t.toString("hex");if(t instanceof Uint8Array)return Buffer.from(t).toString("hex");throw new Error("expected array-like")},blobToBuffer:t=>{const e=t.toUint8Array();return Buffer.from(e)},objToBase64:t=>Buffer.from(JSON.stringify(t)).toString("base64")}},function(t,e){function n(t,e){return i(e)&&o(e.data)&&(e.data.length>0?e.data="base64:"+Buffer.from(e.data).toString("base64"):e.data=""),e}function r(t,e){if(i(e)){if(o(e.data))return Buffer.from(e.data);if(s(e.data))return e.data.startsWith("base64:")?Buffer.from(e.data.slice("base64:".length),"base64"):Buffer.from(e.data)}return e}function i(t){return function(t){return"object"==typeof t&&null!==t}(t)&&"Buffer"===t.type&&(o(t.data)||s(t.data))}function o(t){return Array.isArray(t)}function s(t){return"string"==typeof t}t.exports={stringify:function(t,e){return JSON.stringify(t,n,e)},parse:function(t){return JSON.parse(t,r)},replacer:n,reviver:r}},function(t,e,n){"use strict";n.d(e,"ENV_DEV",function(){return s}),n.d(e,"ENV_EXODUS_PROD",function(){return a}),n.d(e,"FIREBASE_CONFIG",function(){return u}),n.d(e,"FIREBASE_API_URL",function(){return c}),n.d(e,"RESTORE_ACTIONS",function(){return h});var r=n(10),i=n(39),o=n.n(i);n(97);const s=!1,a=!0,u={apiKey:"AIzaSyDxjHgyc4UkFrUptMX-B4s7YS-PfITLOmE",authDomain:"exo-prod.firebaseapp.com",databaseURL:"https://exo-prod.firebaseio.com",projectId:"exo-prod",storageBucket:"exo-prod.appspot.com",messagingSenderId:"166438186762",appId:"1:166438186762:web:a7f33e96f9bf3d73"},c="https://fusion.exodus.io/api",h=(o()("3s"),r.fiatUnit,r.moneroInitialHeight,r.moneroInitialHeight,r.moneroSubaddressesEnabled,r.moneroSubaddressesEnabled,r.themeName,r.rbfEnabledBitcoin,r.rbfEnabledEthereum,r.adaLegacyAddressEnabled,r.bitcoinLegacyAddressEnabled,r.bitcoinTaprootAddressEnabled,r.wentThroughFiatOnboarding,["12words","link","sync"])},function(t,e,n){"use strict";var r=n(3);const i=new(n(40).default)({sendMessage:t=>Object(r.targeted)("core","core-network-handshake",t),attachListener:t=>r.rpcListener.on("core-network-handshake",(e,{payload:n})=>t(n))});e.default=i},function(t,e,n){t.exports=n(104)},function(t,e,n){"use strict";function r({object:t,delayUntil:e,synchronousMethods:n=[]}){return new Proxy(t,{get:(t,r)=>n.includes(r)?function(){const n=e.then(()=>t[r](...arguments));return new Proxy({},{get(t,e){if("then"!==e)return async function(){return(await n)[e](...arguments)}}})}:async function(){return await e,t[r](...arguments)}})}n.d(e,"default",function(){return r})},function(t,e,n){"use strict";var r=n(79),i=n(78),o=n.n(i),s=n(3),a=n(77);e.default=o()(Object(r.default)({object:Object(s.createClient)("core","storage-seco-network"),delayUntil:a.default.awaitDone()}))},function(t,e,n){"use strict";var r=n(50);e.default=(()=>{let t=!1;const e=new r.EventEmitter;return e.on("lock",()=>t=!0),e.on("unlock",()=>t=!1),{lock:()=>e.emit("lock"),unlock:()=>e.emit("unlock"),wait:()=>t?Object(r.once)(e,"unlock"):Promise.resolve()}})},function(t,e){var n=1e3,r=60*n,i=60*r,o=24*i,s=7*o,a=365.25*o;function u(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var u=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*a;case"weeks":case"week":case"w":return u*s;case"days":case"day":case"d":return u*o;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=o)return u(t,e,o,"day");if(e>=i)return u(t,e,i,"hour");if(e>=r)return u(t,e,r,"minute");if(e>=n)return u(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=o)return Math.round(t/o)+"d";if(e>=i)return Math.round(t/i)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=(n(70),n(69),n(14)),s=n.n(o),a=n(36),u=n.n(a),c=n(82),h=n.n(c),l=n(81);e.default={id:"fusion",type:"module",factory:function({getFirestoreSync:t,getKeys:e,sodium:n,storage:r,analyticsUserIdAtom:o,config:{firebaseConfig:a,fusionServerUrl:c,platform:f}}){const d=r.namespace("channels"),p=r.namespace("migrations"),m=Object(l.default)();m.lock();const y=t=>(b=t,m.unlock(),r.set("cachedProfile",b).catch(t=>console.error("fusion: failed to cache profile to storage: ",t)));let g,v,b,w;0===i.a.apps.length&&i.a.initializeApp(a),i.a.ENDPOINT=c;const _=[],S=()=>_.forEach(t=>t(b)),E=()=>{m.lock(),v=setInterval(async()=>{try{await g.authenticate(),clearInterval(v),v=void 0,g.subscribe(),w?(await g.mergeProfileProps(w),w=void 0):(b=await g.getProfile(),y(b),S())}catch(t){console.error(t)}},h()("30s"))},I=r.get("cachedProfile").then(t=>{b||(b=t)}),T=async function(){g=t?await t():new s.a(i.a,n,await e(),{platform:f,analyticsUserId:o?await o.get():void 0});try{g.on("profile-update",t=>{y(b=t),S()}),await g.authenticate(),g.subscribe(),b=await g.getProfile(),y(b),S()}catch(t){console.error(t),E()}}(),A=I.then(async()=>{b||await T,b||(b={private:{}})});return{logout:async()=>{await T,v&&clearInterval(v),await g.logout()},getProfile:async({online:t}={})=>!1===t?(await I,b):(!0===t&&await m.wait(),await A,b),mergeProfile:async t=>{if(await T,!v)try{return await g.mergeProfileProps(t,void 0,{maxTries:0})}catch(t){console.error(t),E()}await A,b=u()(b,t),w=u()(w||{},t),S()},subscribe:t=>{A.then(()=>_.push(t))},channel:t=>{const e=T.then(()=>s.a.processChannel({firestoreSync:g,channelConf:{...t,syncStateKey:t.channelName},getLatest:async t=>await d.get(t)||0,setLatest:d.set,getMigration:p.get,setMigration:p.set}));return{push:async t=>(await e).push(t),awaitProcessed:async()=>(await e).awaitProcessed()}},recordLogin:async t=>(await T,g.recordLogin(t)),clearStorage:async()=>r.clear()}},dependencies:["storage","config","sodium","getFirestoreSync?","getKeys?","analyticsUserIdAtom?"]}},function(t,e,n){"use strict";var r=n(83),i=n(7),o=n(80),s=n(38);const a=o.default.namespace("fusion");e.default=r.default.factory({config:{firebaseConfig:i.FIREBASE_CONFIG,fusionServerUrl:i.FIREBASE_API_URL},getFirestoreSync:async()=>Object(s.waitForInitialize)(),storage:a})},function(t,e,n){"use strict";function r(t){return[...t].sort((t,e)=>{if(!o(t.date,e.date))throw new TypeError("TxSet.util.sortByAsc() objects must be Dates or numbers");return t.date-e.date})}function i(t){return[...t].sort((t,e)=>{if(!o(t.date,e.date))throw new TypeError("TxSet.util.sortByAsc() objects must be Dates or numbers");return e.date-t.date})}function o(t,e){return t instanceof Date&&e instanceof Date||"number"==typeof t&&"number"==typeof e}n.r(e),n.d(e,"sortByAsc",function(){return r}),n.d(e,"sortByDesc",function(){return i})},function(t,e,n){"use strict";function r(t){return 2===t.pathArray[0]}function i(t){return 1===t.pathArray[0]}function o(t){return 0===t.pathArray[0]}n.r(e),n.d(e,"isExchangeAddress",function(){return r}),n.d(e,"isChangeAddress",function(){return i}),n.d(e,"isReceiveAddress",function(){return o})},function(t,e){var n=function(t){if(!Array.isArray(t))throw new Error("Input must be an Array");if(0===t.length)throw new Error("Path must contain at least one level");for(var e=0;e<t.length;e++)if("number"!=typeof t[e])throw new Error("Path element is not a number");this.path=t};n.validatePathArray=function(t){try{return n.fromPathArray(t),!0}catch(t){return!1}},n.validateString=function(t,e){try{return n.fromString(t,e),!0}catch(t){return!1}},n.fromPathArray=function(t){return new n(t)},n.fromString=function(t,e){if(/^m\//i.test(t))t=t.slice(2);else if(e)throw new Error("Root element is required");for(var r=t.split("/"),i=new Array(r.length),o=0;o<r.length;o++){var s=/(\d+)([hH\']?)/.exec(r[o]);if(null===s)throw new Error("Invalid input");if(i[o]=parseInt(s[1],10),i[o]>=2147483648)throw new Error("Invalid child index");if("h"===s[2]||"H"===s[2]||"'"===s[2])i[o]+=2147483648;else if(0!=s[2].length)throw new Error("Invalid modifier")}return new n(i)},n.prototype.toPathArray=function(){return this.path},n.prototype.toString=function(t,e){for(var n=new Array(this.path.length),r=0;r<this.path.length;r++){var i=this.path[r];n[r]=2147483648&i?(2147483647&i)+(e?"h":"'"):i}return(t?"":"m/")+n.join("/")},n.prototype.inspect=function(){return"BIPPath <"+this.toString()+">"},t.exports=n},function(t,e,n){"use strict";n.d(e,"create",function(){return a});var r=n(4),i=n(31),o=n(20),s=n(6);function a(t,e,n){if(n<0)throw new Error("power cannot be less than 0");const a=function(t){if(Number.isNaN(t))throw new Error("Value NaN not supported for number unit conversion.");return Object(o.default)(t)?(Object(s.maybeReportDifferentTypesDeprecated)(t,a,"create"),t.to(a)):i.default.create(t,a)};return a.unitName=e,a.power=n,a.multiplier=r.default.wrap(10,10).pow(r.default.wrap(n,10)),a.unitType=t,a.toJSON=function(){return{unitName:a.unitName,power:a.power}},a[Symbol.toStringTag]=(()=>String(a)),a.toString=function(){return a.unitName},a}},function(t,e,n){"use strict";var r=n(43),i=n(5),o=n(53),s=n(34),a=n(51),u=n.n(a),c=n(2),h=n(3);const l=t=>Object(c.mapValues)(t.units,t=>t.power);function f(t,e){const n=t&&e,a={};let c;n&&(Object(h.createServer)(`_transform_function_support_${t}:${e}`,[e],a,f()),c=Object(h.createClient)(e,`_transform_function_support_${e}:${t}`,f()));const d=[{type:"numberunit",test:t=>t instanceof i.default,serialize:t=>({v:t.toString(),u:l(t.unitType)}),deserialize:t=>i.UnitType.create(t.u).parse(t.v)},{type:"utxocollection",test:t=>t instanceof o.UtxoCollection,serialize:t=>({v:t.toJSON(),u:l(t.currency)}),deserialize:t=>o.UtxoCollection.fromJSON(t.v,{currency:i.UnitType.create(t.u)})},{type:"bn.js",test:t=>t&&t.constructor&&!Object.hasOwn(t,"constructor")&&u.a.isBN(t),serialize:t=>t.toJSON(),deserialize:t=>new u.a(t,16)},...n?[{type:"function",test:t=>t instanceof Function,serialize:t=>{const e=Object(r.randomUUID)();return a[e]=t,e},deserialize:t=>c[t]}]:[]],{serialize:p,deserialize:m}=Object(s.default)(d);return{wrap:(t,e)=>p(e),unwrap:(t,e)=>m(e)}}const{wrap:d,unwrap:p}=f();e.default=f},function(t,e,n){"use strict";n.d(e,"default",function(){return s});var r=n(3),i=n(89),o=n(84);function s(){Object(r.createServer)("fusion",["ui"],o.default,Object(i.default)("network","ui"))}},function(t,e,n){"use strict";n.d(e,"default",function(){return i});const r=n(1).default;function i(t,e){return r.apps.length||r.initializeApp(t),r.ENDPOINT=e,r}n(70),n(69)},function(t,e,n){"use strict";n.d(e,"createWorkerChannel",function(){return a});var r=n(41),i=n(3),o=n(42);let s;function a(t){const e=new Map;let n=0;const i=new Worker(s+"/"+t);return i.onmessage=function(t){const n=e.get(t.data.id);if(e.delete(t.data.id),!n)throw new Error("no pending return callback");n(t)},i.onerror=function(t){throw new Error(t.message)},{worker:i,rpcWrap:t=>(async function(...s){const a=n++;return new Promise(function(n,u){e.set(a,function(t){const{result:e,error:i}=Object(r.default)(t.data);if(i){console.error(i.stack);const t=Object(o.fromObject)(i);u(t)}else n(e)});const c=s[s.length-1],h=null==c?void 0:c.postMessageOptions;h?i.postMessage({method:t,args:s,id:a},h):i.postMessage({method:t,args:s,id:a})})})}}s=i.rpcListener.sendSync("app:path","app")},function(t,e,n){"use strict";function r(t){return function(e,n){e=e||0;var r=arguments.length>1,i=o(n);return o.then=i.then.bind(i),o.catch=i.catch.bind(i),o;function o(o){return i&&i.catch(function(){}),new Promise(function(){var i=arguments[t];setTimeout(function(){i(r?n:o)},e)})}}}t.exports=r(0),t.exports.reject=r(1)},function(t,e,n){"use strict";n.d(e,"createFirestoreSync",function(){return m});var r=n(14),i=n.n(r),o=n(93),s=n.n(o),a=n(39),u=n.n(a),c=n(7),h=n(37),l=n(28),f=n(91);function d(t,e){const n=JSON.stringify({count:e});window.localStorage.setItem(t,n)}function p(t){let e;try{e=JSON.parse(window.localStorage.getItem(t)).count}catch(t){e=0}return e}const m=async(t,e)=>{const n=Object(f.default)(c.FIREBASE_CONFIG,c.FIREBASE_API_URL),r=new i.a(n,l.default,t,{platform:"desktop",analyticsUserId:e}),o=async t=>{try{await a(t)}catch(t){console.log("Error saving user metadata",t)}},a=async t=>{const e={abandoned:!1};c.ENV_EXODUS_PROD||(e.dev=!0),await t.updateProfile(()=>e)},m=async()=>{try{await(async()=>{await r.authenticate(),h.default.forEach(t=>{let{processOne:e,processBatch:n}=t;e||n||(e=(async(e,n)=>{d(t.syncStateKey,n)})),i.a.processChannel({firestoreSync:r,channelConf:{...t,processOne:e},setLatest:d,getLatest:p})}),o(r)})()}catch(t){await s()(u()("5m")),await m()}};return await m(),r};c.ENV_DEV&&(globalThis.setLatest=d)},function(t,e,n){"use strict";var r=n(3);e.default=Object(r.createClient)("#","wallet-controller")},function(t,e,n){"use strict";n.d(e,"default",function(){return s});var r=n(2),i=n(3);const o=["monitors.e2eSync.processOrdersBatch","monitors.e2eSync.processPersonalNotesBatch"];function s(){return o.reduce((t,e)=>(Object(r.set)(t,e,Object(i.createClientMethod)("ui","flux-actions",e)),t),{})}},function(t){t.exports={name:"exodus",productName:"Exodus",version:"25.13.7",releaseDate:"25.3.24",description:"Secure, manage, and trade blockchain assets."}},function(t,e,n){"use strict";n.d(e,"default",function(){return c});var r=n(7),i=n(3),o=n(38),s=n(56);const a={order:"orders",orderV1:"ordersV1",personalNote:"personalNotes",walletAccounts:"walletAccounts"};class u{constructor(){this._init=(async()=>{this.sync=await Object(o.waitForInitialize)(),r.ENV_DEV&&(globalThis.sync=this.sync)}),this.ready=this._init()}async push(t){await this.ready;const e=JSON.parse(t);return(await this.sync.channel(a[e.type])).push(e)}async awaitSynced(t){await this.ready;const e=await this.sync.channel(t);await e.awaitSynced()}}function c(){Object(i.createServer)("firestore",["ui"],new u),Object(i.createServer)("pairer-for-sender",["ui"],s.pairerForSender),Object(i.createServer)("pairer-for-recipient",["ui"],s.pairerForRecipient)}},function(t,e,n){"use strict";t.exports=(()=>{const t={};return t.promise=new Promise((e,n)=>{t.resolve=e,t.reject=n}),t})},function(t,e){function n(t){if(!(this instanceof n))return new n(t);this.value=t}function r(t,e,n){var r=[],o=[],s=!0;return function t(a){var u=n?i(a):a,c={},h={node:u,node_:a,path:[].concat(r),parent:o.slice(-1)[0],key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(t){h.isRoot||(h.parent.node[h.key]=t),h.node=t},delete:function(){delete h.parent.node[h.key]},remove:function(){Array.isArray(h.parent.node)?h.parent.node.splice(h.key,1):delete h.parent.node[h.key]},before:function(t){c.before=t},after:function(t){c.after=t},pre:function(t){c.pre=t},post:function(t){c.post=t},stop:function(){s=!1}};if(!s)return h;if("object"==typeof u&&null!==u){h.isLeaf=0==Object.keys(u).length;for(var l=0;l<o.length;l++)if(o[l].node_===a){h.circular=o[l];break}}else h.isLeaf=!0;h.notLeaf=!h.isLeaf,h.notRoot=!h.isRoot;var f=e.call(h,h.node);if(void 0!==f&&h.update&&h.update(f),c.before&&c.before.call(h,h.node),"object"==typeof h.node&&null!==h.node&&!h.circular){o.push(h);var d=Object.keys(h.node);d.forEach(function(e,i){r.push(e),c.pre&&c.pre.call(h,h.node[e],e);var o=t(h.node[e]);n&&Object.hasOwnProperty.call(h.node,e)&&(h.node[e]=o.node),o.isLast=i==d.length-1,o.isFirst=0==i,c.post&&c.post.call(h,o),r.pop()}),o.pop()}return c.after&&c.after.call(h,h.node),h}(t).node}function i(t){var e;return"object"==typeof t&&null!==t?(e=Array.isArray(t)?[]:t instanceof Date?new Date(t):t instanceof Boolean?new Boolean(t):t instanceof Number?new Number(t):t instanceof String?new String(t):Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(n){e[n]=t[n]}),e):t}t.exports=n,n.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var r=t[n];if(!Object.hasOwnProperty.call(e,r)){e=void 0;break}e=e[r]}return e},n.prototype.set=function(t,e){for(var n=this.value,r=0;r<t.length-1;r++){var i=t[r];Object.hasOwnProperty.call(n,i)||(n[i]={}),n=n[i]}return n[t[r]]=e,e},n.prototype.map=function(t){return r(this.value,t,!0)},n.prototype.forEach=function(t){return this.value=r(this.value,t,!1),this.value},n.prototype.reduce=function(t,e){var n=1===arguments.length,r=n?this.value:e;return this.forEach(function(e){this.isRoot&&n||(r=t.call(this,r,e))}),r},n.prototype.deepEqual=function(t){if(1!==arguments.length)throw new Error("deepEqual requires exactly one object to compare against");var e=!0,r=t;return this.forEach(function(i){var o=function(){e=!1}.bind(this);if(!this.isRoot){if("object"!=typeof r)return o();r=r[this.key]}var s=r;this.post(function(){r=s});var a=function(t){return Object.prototype.toString.call(t)};if(this.circular)n(t).get(this.circular.path)!==s&&o();else if(typeof s!=typeof i)o();else if(null===s||null===i||void 0===s||void 0===i)s!==i&&o();else if(s.__proto__!==i.__proto__)o();else if(s===i);else if("function"==typeof s)s instanceof RegExp?s.toString()!=i.toString()&&o():s!==i&&o();else if("object"==typeof s)if("[object Arguments]"===a(i)||"[object Arguments]"===a(s))a(s)!==a(i)&&o();else if(s instanceof Date||i instanceof Date)s instanceof Date&&i instanceof Date&&s.getTime()===i.getTime()||o();else{var u=Object.keys(s),c=Object.keys(i);if(u.length!==c.length)return o();for(var h=0;h<u.length;h++){var l=u[h];Object.hasOwnProperty.call(i,l)||o()}}}),e},n.prototype.paths=function(){var t=[];return this.forEach(function(e){t.push(this.path)}),t},n.prototype.nodes=function(){var t=[];return this.forEach(function(e){t.push(this.node)}),t},n.prototype.clone=function(){var t=[],e=[];return function n(r){for(var o=0;o<t.length;o++)if(t[o]===r)return e[o];if("object"==typeof r&&null!==r){var s=i(r);return t.push(r),e.push(s),Object.keys(r).forEach(function(t){s[t]=n(r[t])}),t.pop(),e.pop(),s}return r}(this.value)},Object.keys(n.prototype).forEach(function(t){n[t]=function(e){var r=[].slice.call(arguments,1),i=n(e);return i[t].apply(i,r)}})},function(t,e,n){"use strict";n.d(e,"wrapIpc",function(){return a});var r=n(41);const i=new WeakMap,o=new WeakMap;function s(t,e,n){const s=o.get(t);if(s&&(s.filter!==e||s.useBuffers!==n))throw new Error("Attempting to register the same handler with different parameters");o.set(t,{filter:e,useBuffers:n});const a=i.get(t);if(a)return a;const u=(i,...o)=>{if(!0!==e(i))return;const s=n?Object(r.default)(o):o;return t(i,...s)};return i.set(t,u),u}function a(t,e){return{on(n,r,i=!0){t.on(n,s(r,e,i))},once(n,r,i=!0){t.once(n,s(r,e,i))},removeListener(e,n){t.removeListener(e,i.get(n))},removeAllListeners(e){t.removeAllListeners(e)},handle(n,r,i=!0){t.handle(n,s(r,e,i))},removeHandler(e){t.removeHandler(e)},send(...e){t.send(...e)},sendSync:(...e)=>t.sendSync(...e),invoke:(...e)=>t.invoke(...e)}}},function(t,e){function n(t){return t instanceof Error?{...t,name:t.name,message:t.message,stack:r(t.stack)}:{name:t.name||"UNKNOWN",message:JSON.stringify(t)}}function r(t){return t.replace(/\/Users\/[^/]+/g,"").replace(/\\Users\\[^\\]+/g,"").replace(/\/home\/[^/]+/g,"")}t.exports={toObject:n,JSONReplacer:function(t,e){return e instanceof Error?n(e):e},cleanStack:r}},function(t,e,n){"use strict";n.d(e,"createServerImplementation",function(){return o});var r=n(102),i=n(23);function o(t,e,n,o,s,a,{wrap:u,unwrap:c}={}){const h=`${i.CHANNEL_PREFIX}:${o}:call`,l=async(t,h)=>{const l=n(t,h);if(!s.includes(l))return void console.error(`Skipping unexpected message from (${l}) to channel: ${o}`);const{func:f,args:d,token:p}=h.payload,[m,y]=await async function(t,e){if("function"==typeof a[t])try{c&&(e=c(t,e));let n=await a[t](...e);return u&&(n=u(t,n)),[null,n]}catch(t){return[t,null]}try{return[null,a[t]]}catch(t){return[t]}}(f,d),g=m?Object(r.toObject)(m):null;e(l,`${i.CHANNEL_PREFIX}:${o}:response:${p}`,[g,y])};return t.on(h,l),{stop:()=>t.removeListener(h,l)}}},function(t,e){t.exports=function(t){const e=(n="")=>{const r=t=>{if(t.includes("!"))throw new Error(`keys cannot contain !; recieved ${t}`);return n+t};return{get:async e=>t.get(r(e)),batchGet:async e=>t.batchGet(e.map(t=>r(t))),set:async(e,n)=>t.set(r(e),n),batchSet:async e=>t.batchSet(Object.fromEntries(Object.entries(e).map(([t,e])=>[r(t),e]))),delete:async e=>t.delete(r(e)),batchDelete:async e=>t.batchDelete(e.map(t=>r(t))),clear:async()=>t.clear(n),namespace:t=>{if(t.includes("!"))throw new Error(`prefixes cannot contain !; recieved ${t}`);return e(`${n}!${t}!`)}}};return e()}},function(t,e,n){"use strict";t.exports={assertSize:function(t){if(!(Number.isSafeInteger(t)&&t>0))throw new TypeError("Invalid size")}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ripemd160=e.RIPEMD160=void 0;const r=n(47),i=n(24),o=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),s=Uint8Array.from({length:16},(t,e)=>e);let a=[s],u=[s.map(t=>(9*t+5)%16)];for(let t=0;t<4;t++)for(let e of[a,u])e.push(e[t].map(t=>o[t]));const c=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),h=a.map((t,e)=>t.map(t=>c[e][t])),l=u.map((t,e)=>t.map(t=>c[e][t])),f=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),d=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),p=(t,e)=>t<<e|t>>>32-e;function m(t,e,n,r){return 0===t?e^n^r:1===t?e&n|~e&r:2===t?(e|~n)^r:3===t?e&r|n&~r:e^(n|~r)}const y=new Uint32Array(16);class g extends r.SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:i}=this;return[t,e,n,r,i]}set(t,e,n,r,i){this.h0=0|t,this.h1=0|e,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(t,e){for(let n=0;n<16;n++,e+=4)y[n]=t.getUint32(e,!0);let n=0|this.h0,r=n,i=0|this.h1,o=i,s=0|this.h2,c=s,g=0|this.h3,v=g,b=0|this.h4,w=b;for(let t=0;t<5;t++){const e=4-t,_=f[t],S=d[t],E=a[t],I=u[t],T=h[t],A=l[t];for(let e=0;e<16;e++){const r=p(n+m(t,i,s,g)+y[E[e]]+_,T[e])+b|0;n=b,b=g,g=0|p(s,10),s=i,i=r}for(let t=0;t<16;t++){const n=p(r+m(e,o,c,v)+y[I[t]]+S,A[t])+w|0;r=w,w=v,v=0|p(c,10),c=o,o=n}}this.set(this.h1+s+v|0,this.h2+g+w|0,this.h3+b+r|0,this.h4+n+o|0,this.h0+i+c|0)}roundClean(){y.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}e.RIPEMD160=g,e.ripemd160=(0,i.wrapConstructor)(()=>new g)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha384=e.sha512_256=e.sha512_224=e.sha512=e.SHA512=void 0;const r=n(47),i=n(65),o=n(24),[s,a]=(()=>i.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),u=new Uint32Array(80),c=new Uint32Array(80);class h extends r.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:u,El:c,Fh:h,Fl:l,Gh:f,Gl:d,Hh:p,Hl:m}=this;return[t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m]}set(t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|u,this.El=0|c,this.Fh=0|h,this.Fl=0|l,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|m}process(t,e){for(let n=0;n<16;n++,e+=4)u[n]=t.getUint32(e),c[n]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|u[t-15],n=0|c[t-15],r=i.default.rotrSH(e,n,1)^i.default.rotrSH(e,n,8)^i.default.shrSH(e,n,7),o=i.default.rotrSL(e,n,1)^i.default.rotrSL(e,n,8)^i.default.shrSL(e,n,7),s=0|u[t-2],a=0|c[t-2],h=i.default.rotrSH(s,a,19)^i.default.rotrBH(s,a,61)^i.default.shrSH(s,a,6),l=i.default.rotrSL(s,a,19)^i.default.rotrBL(s,a,61)^i.default.shrSL(s,a,6),f=i.default.add4L(o,l,c[t-7],c[t-16]),d=i.default.add4H(f,r,h,u[t-7],u[t-16]);u[t]=0|d,c[t]=0|f}let{Ah:n,Al:r,Bh:o,Bl:h,Ch:l,Cl:f,Dh:d,Dl:p,Eh:m,El:y,Fh:g,Fl:v,Gh:b,Gl:w,Hh:_,Hl:S}=this;for(let t=0;t<80;t++){const e=i.default.rotrSH(m,y,14)^i.default.rotrSH(m,y,18)^i.default.rotrBH(m,y,41),E=i.default.rotrSL(m,y,14)^i.default.rotrSL(m,y,18)^i.default.rotrBL(m,y,41),I=m&g^~m&b,T=y&v^~y&w,A=i.default.add5L(S,E,T,a[t],c[t]),N=i.default.add5H(A,_,e,I,s[t],u[t]),C=0|A,O=i.default.rotrSH(n,r,28)^i.default.rotrBH(n,r,34)^i.default.rotrBH(n,r,39),D=i.default.rotrSL(n,r,28)^i.default.rotrBL(n,r,34)^i.default.rotrBL(n,r,39),k=n&o^n&l^o&l,M=r&h^r&f^h&f;_=0|b,S=0|w,b=0|g,w=0|v,g=0|m,v=0|y,({h:m,l:y}=i.default.add(0|d,0|p,0|N,0|C)),d=0|l,p=0|f,l=0|o,f=0|h,o=0|n,h=0|r;const x=i.default.add3L(C,D,M);n=i.default.add3H(x,N,O,k),r=0|x}({h:n,l:r}=i.default.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:h}=i.default.add(0|this.Bh,0|this.Bl,0|o,0|h)),({h:l,l:f}=i.default.add(0|this.Ch,0|this.Cl,0|l,0|f)),({h:d,l:p}=i.default.add(0|this.Dh,0|this.Dl,0|d,0|p)),({h:m,l:y}=i.default.add(0|this.Eh,0|this.El,0|m,0|y)),({h:g,l:v}=i.default.add(0|this.Fh,0|this.Fl,0|g,0|v)),({h:b,l:w}=i.default.add(0|this.Gh,0|this.Gl,0|b,0|w)),({h:_,l:S}=i.default.add(0|this.Hh,0|this.Hl,0|_,0|S)),this.set(n,r,o,h,l,f,d,p,m,y,g,v,b,w,_,S)}roundClean(){u.fill(0),c.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}e.SHA512=h;class l extends h{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class f extends h{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class d extends h{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}e.sha512=(0,o.wrapConstructor)(()=>new h),e.sha512_224=(0,o.wrapConstructor)(()=>new l),e.sha512_256=(0,o.wrapConstructor)(()=>new f),e.sha384=(0,o.wrapConstructor)(()=>new d)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.shake256=e.shake128=e.keccak_512=e.keccak_384=e.keccak_256=e.keccak_224=e.sha3_512=e.sha3_384=e.sha3_256=e.sha3_224=e.Keccak=e.keccakP=void 0;const r=n(66),i=n(65),o=n(24),[s,a,u]=[[],[],[]],c=BigInt(0),h=BigInt(1),l=BigInt(2),f=BigInt(7),d=BigInt(256),p=BigInt(113);for(let t=0,e=h,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],s.push(2*(5*r+n)),a.push((t+1)*(t+2)/2%64);let i=c;for(let t=0;t<7;t++)(e=(e<<h^(e>>f)*p)%d)&l&&(i^=h<<(h<<BigInt(t))-h);u.push(i)}const[m,y]=(0,i.split)(u,!0),g=(t,e,n)=>n>32?(0,i.rotlBH)(t,e,n):(0,i.rotlSH)(t,e,n),v=(t,e,n)=>n>32?(0,i.rotlBL)(t,e,n):(0,i.rotlSL)(t,e,n);function b(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let e=0;e<10;e++)n[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const r=(e+8)%10,i=(e+2)%10,o=n[i],s=n[i+1],a=g(o,s,1)^n[r],u=v(o,s,1)^n[r+1];for(let n=0;n<50;n+=10)t[e+n]^=a,t[e+n+1]^=u}let e=t[2],i=t[3];for(let n=0;n<24;n++){const r=a[n],o=g(e,i,r),u=v(e,i,r),c=s[n];e=t[c],i=t[c+1],t[c]=o,t[c+1]=u}for(let e=0;e<50;e+=10){for(let r=0;r<10;r++)n[r]=t[e+r];for(let r=0;r<10;r++)t[e+r]^=~n[(r+2)%10]&n[(r+4)%10]}t[0]^=m[r],t[1]^=y[r]}n.fill(0)}e.keccakP=b;class w extends o.Hash{constructor(t,e,n,i=!1,s=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,r.number)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,o.u32)(this.state)}keccak(){b(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){(0,r.exists)(this);const{blockLen:e,state:n}=this,i=(t=(0,o.toBytes)(t)).length;for(let r=0;r<i;){const o=Math.min(e-this.pos,i-r);for(let e=0;e<o;e++)n[this.pos++]^=t[r++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:r}=this;t[n]^=e,0!=(128&e)&&n===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){(0,r.exists)(this,!1),(0,r.bytes)(t),this.finish();const e=this.state,{blockLen:n}=this;for(let r=0,i=t.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);t.set(e.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,r.number)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,r.output)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return t||(t=new w(e,n,r,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=r,t.enableXOF=o,t.destroyed=this.destroyed,t}}e.Keccak=w;const _=(t,e,n)=>(0,o.wrapConstructor)(()=>new w(e,t,n));e.sha3_224=_(6,144,28),e.sha3_256=_(6,136,32),e.sha3_384=_(6,104,48),e.sha3_512=_(6,72,64),e.keccak_224=_(1,144,28),e.keccak_256=_(1,136,32),e.keccak_384=_(1,104,48),e.keccak_512=_(1,72,64);const S=(t,e,n)=>(0,o.wrapXOFConstructorWithOpts)((r={})=>new w(e,t,void 0===r.dkLen?n:r.dkLen,!0));e.shake128=S(31,168,16),e.shake256=S(31,136,32)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="crypto"in globalThis?globalThis.crypto:void 0},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(47),i=n(24),o=(t,e,n)=>t&e^~t&n,s=(t,e,n)=>t&e^t&n^e&n,a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),u=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class h extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|u[0],this.B=0|u[1],this.C=0|u[2],this.D=0|u[3],this.E=0|u[4],this.F=0|u[5],this.G=0|u[6],this.H=0|u[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[t,e,n,r,i,o,s,a]}set(t,e,n,r,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)c[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],n=c[t-2],r=(0,i.rotr)(e,7)^(0,i.rotr)(e,18)^e>>>3,o=(0,i.rotr)(n,17)^(0,i.rotr)(n,19)^n>>>10;c[t]=o+c[t-7]+r+c[t-16]|0}let{A:n,B:r,C:u,D:h,E:l,F:f,G:d,H:p}=this;for(let t=0;t<64;t++){const e=p+((0,i.rotr)(l,6)^(0,i.rotr)(l,11)^(0,i.rotr)(l,25))+o(l,f,d)+a[t]+c[t]|0,m=((0,i.rotr)(n,2)^(0,i.rotr)(n,13)^(0,i.rotr)(n,22))+s(n,r,u)|0;p=d,d=f,f=l,l=h+e|0,h=u,u=r,r=n,n=e+m|0}n=n+this.A|0,r=r+this.B|0,u=u+this.C|0,h=h+this.D|0,l=l+this.E|0,f=f+this.F|0,d=d+this.G|0,p=p+this.H|0,this.set(n,r,u,h,l,f,d,p)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends h{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,i.wrapConstructor)(()=>new h),e.sha224=(0,i.wrapConstructor)(()=>new l)},function(t,e,n){"use strict";const{sha256:r}=n(110),{sha3_256:i,sha3_384:o,sha3_512:s}=n(108),{sha384:a,sha512:u,sha512_256:c}=n(107),{ripemd160:h}=n(106);t.exports={hash:function(t){if("sha256"===t)return r;if("sha384"===t)return a;if("sha512"===t)return u;if("sha512-256"===t)return c;if("sha3-256"===t)return i;if("sha3-384"===t)return o;if("sha3-512"===t)return s;if("ripemd160"===t)return h;throw new Error("Unsupported hash type")}}},function(t,e,n){"use strict";const{assertHash:r,P2SH_OP_0:i}=n(68),{hash:o}=n(111),{fromUint8Array:s}=n(67);function a(t,e,n){if(r(t,e,n),"hash160"===t)return a("ripemd160",a("sha256",e),n);if("p2sh-hash160"===t)return a("hash160",[i,a("hash160",e)],n);if(Array.isArray(e)){const r=o(t).create();for(const t of e)r.update(t);return s(r.digest(),n)}const u=o(t)(e);return s(u,n)}t.exports={hash:async function(t,e,n){return a(t,e,n)},hashSync:a}},function(t,e,n){"use strict";t.exports={toUint8Arr:function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return Buffer.from(t);if(Array.isArray(t))return Buffer.concat(t);throw new Error("Unexpected arg type")},toWebCryptoDigestType:function(t){if("sha256"===t)return"SHA-256";if("sha384"===t)return"SHA-384";if("sha512"===t)return"SHA-512";if("ripemd160"===t||"sha512-256"===t)return null;if("sha3-256"===t||"sha3-384"===t||"sha3-512"===t)return null;throw new Error("Unexpected hash type")}}},function(t,e,n){(function(){"use strict";var e,n=n||{},r=this;function i(t){return"string"==typeof t}function o(t){return"number"==typeof t}function s(t,e){t=t.split("."),e=e||r;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function a(){}function u(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function c(t){return"array"==u(t)}function h(t){var e=u(t);return"array"==e||"object"==e&&"number"==typeof t.length}function l(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var f="closure_uid_"+(1e9*Math.random()>>>0),d=0;function p(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function y(t,e,n){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:m).apply(null,arguments)}var g=Date.now||function(){return+new Date};function v(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function b(){0!=w&&(_[this[f]||(this[f]=++d)]=this),this.j=this.j,this.i=this.i}var w=0,_={};b.prototype.j=!1,b.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0!=w)){var t=this[f]||(this[f]=++d);if(0!=w&&this.i&&0<this.i.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete _[t]}},b.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(i(t))return i(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},E=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,o=i(t)?t.split(""):t,s=0;s<r;s++)s in o&&e.call(n,o[s],s,t)};function I(t){return Array.prototype.concat.apply([],arguments)}function T(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var N,C=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function D(t,e){return t<e?-1:t>e?1:0}t:{var k=r.navigator;if(k){var M=k.userAgent;if(M){N=M;break t}}N=""}function x(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function P(t){var e,n={};for(e in t)n[e]=t[e];return n}var R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<R.length;o++)n=R[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function B(t){return B[" "](t),t}B[" "]=a;var U,F,j=O(N,"Opera"),q=O(N,"Trident")||O(N,"MSIE"),V=O(N,"Edge"),K=V||q,z=O(N,"Gecko")&&!(O(N.toLowerCase(),"webkit")&&!O(N,"Edge"))&&!(O(N,"Trident")||O(N,"MSIE"))&&!O(N,"Edge"),W=O(N.toLowerCase(),"webkit")&&!O(N,"Edge");function G(){var t=r.document;return t?t.documentMode:void 0}t:{var H="",Q=(F=N,z?/rv:([^\);]+)(\)|;)/.exec(F):V?/Edge\/([\d\.]+)/.exec(F):q?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(F):W?/WebKit\/(\S+)/.exec(F):j?/(?:Version)[ \/]?(\S+)/.exec(F):void 0);if(Q&&(H=Q?Q[1]:""),q){var J=G();if(null!=J&&J>parseFloat(H)){U=String(J);break t}}U=H}var $,Y={};function X(t){return function(t,e){var n=Y;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=C(String(U)).split("."),r=C(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=D(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||D(0==s[2].length,0==a[2].length)||D(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var Z=r.document;$=Z&&q?G()||("CSS1Compat"==Z.compatMode?parseInt(U,10):5):void 0;var tt=!q||9<=Number($),et=q&&!X("9"),nt=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{r.addEventListener("test",a,e),r.removeEventListener("test",a,e)}catch(t){}return t}();function rt(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function it(t,e){if(rt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(z){t:{try{B(e.nodeName);var o=!0;break t}catch(t){}o=!1}o||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=i(t.pointerType)?t.pointerType:ot[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}rt.prototype.b=function(){this.Ja=!1},v(it,rt);var ot={2:"touch",3:"pen",4:"mouse"};it.prototype.b=function(){it.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,et)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var st="closure_listenable_"+(1e6*Math.random()|0),at=0;function ut(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++at,this.X=this.Z=!1}function ct(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ht(t){this.src=t,this.a={},this.b=0}function lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=S(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ct(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ft(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ft(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ut(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var dt="closure_lm_"+(1e6*Math.random()|0),pt={};function mt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(c(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Et(r);return e&&e[st]?e.Ba(n,r,l(i)?!!i.capture:!!i,o):yt(e,n,r,!0,i,o)}(t,e,n,r,i);if(c(e)){for(var o=0;o<e.length;o++)mt(t,e[o],n,r,i);return null}return n=Et(n),t&&t[st]?t.Aa(e,n,l(r)?!!r.capture:!!r,i):yt(t,e,n,!1,r,i)}function yt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=l(i)?!!i.capture:!!i;if(s&&!tt)return null;var a=_t(t);if(a||(t[dt]=a=new ht(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=wt,e=tt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)nt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return 0,n}function gt(t){if(!o(t)&&t&&!t.X){var e=t.src;if(e&&e[st])lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),0,(n=_t(e))?(lt(n,t),0==n.b&&(n.src=null,e[dt]=null)):ct(t)}}}function vt(t){return t in pt?pt[t]:pt[t]="on"+t}function bt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&gt(t),n.call(r,e)}function wt(t,e){return!!t.X||(tt?bt(t,new it(e,this)):bt(t,e=new it(e||s("window.event"),this)))}function _t(t){return(t=t[dt])instanceof ht?t:null}var St="__closure_events_fn_"+(1e9*Math.random()>>>0);function Et(t){return"function"==u(t)?t:(t[St]||(t[St]=function(e){return t.handleEvent(e)}),t[St])}function It(){b.call(this),this.c=new ht(this),this.J=this,this.B=null}function Tt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&lt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Ja}v(It,b),It.prototype[st]=!0,(e=It.prototype).addEventListener=function(t,e,n,r){mt(this,t,e,n,r)},e.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(c(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=l(i)?!!i.capture:!!i,r=Et(r),e&&e[st]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=ft(s=e.a[n],r,i,o))&&(ct(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=_t(e))&&(n=e.a[n.toString()],e=-1,n&&(e=ft(n,r,i,o)),(r=-1<e?n[e]:null)&&gt(r))}(this,t,e,n,r)},e.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(i(t))t=new rt(t,n);else if(t instanceof rt)t.target=t.target||n;else{var o=t;L(t=new rt(r,n),o)}if(o=!0,e)for(var s=e.length-1;0<=s;s--){var a=t.a=e[s];o=Tt(a,r,!0,t)&&o}if(o=Tt(a=t.a=n,r,!0,t)&&o,o=Tt(a,r,!1,t)&&o,e)for(s=0;s<e.length;s++)o=Tt(a=t.a=e[s],r,!1,t)&&o;return o},e.G=function(){if(It.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,ct(n[r]);delete e.a[t],e.b--}}this.B=null},e.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},e.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var At=r.JSON.stringify;function Nt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Ct(){this.b=this.a=null}Nt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Ot,Dt=new Nt(function(){return new Mt},function(t){t.reset()});function kt(){var t=Lt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Mt(){this.next=this.b=this.a=null}function xt(t){r.setTimeout(function(){throw t},0)}function Pt(t,e){Ot||function(){var t=r.Promise.resolve(void 0);Ot=function(){t.then(Bt)}}(),Rt||(Ot(),Rt=!0),Lt.add(t,e)}Ct.prototype.add=function(t,e){var n=Dt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Mt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var Rt=!1,Lt=new Ct;function Bt(){for(var t;t=kt();){try{t.a.call(t.b)}catch(t){xt(t)}var e=Dt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Rt=!1}function Ut(t,e){It.call(this),this.b=t||1,this.a=e||r,this.f=y(this.gb,this),this.g=g()}function Ft(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function jt(t,e,n){if("function"==u(t))n&&(t=y(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function qt(t,e,n){b.call(this),this.f=null!=n?y(t,n):t,this.c=e,this.b=y(this.ab,this),this.a=[]}function Vt(t){t.U=jt(t.b,t.c),t.f.apply(null,t.a)}function Kt(t){b.call(this),this.b=t,this.a={}}v(Ut,It),(e=Ut.prototype).ba=!1,e.L=null,e.gb=function(){if(this.ba){var t=g()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Ft(this),this.start()))}},e.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=g())},e.G=function(){Ut.N.G.call(this),Ft(this),delete this.a},v(qt,b),(e=qt.prototype).ea=!1,e.U=null,e.Ua=function(t){this.a=arguments,this.U?this.ea=!0:Vt(this)},e.G=function(){qt.N.G.call(this),this.U&&(r.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},e.ab=function(){this.U=null,this.ea&&(this.ea=!1,Vt(this))},v(Kt,b);var zt=[];function Wt(t,e,n,r){c(n)||(n&&(zt[0]=n.toString()),n=zt);for(var i=0;i<n.length;i++){var o=mt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Gt(t){x(t.a,function(t,e){this.a.hasOwnProperty(e)&&gt(t)},t),t.a={}}Kt.prototype.G=function(){Kt.N.G.call(this),Gt(this)},Kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ht=new It;function Qt(t){rt.call(this,"serverreachability",t)}function Jt(t){Ht.dispatchEvent(new Qt(Ht,t))}function $t(t){rt.call(this,"statevent",t)}function Yt(t){Ht.dispatchEvent(new $t(Ht,t))}function Xt(t){rt.call(this,"timingevent",t)}function Zt(t,e){if("function"!=u(t))throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){t()},e)}v(Qt,rt),v($t,rt),v(Xt,rt);var te={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},ee={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function ne(){}function re(t){var e;return(e=t.a)||(e=t.a={}),e}function ie(){}ne.prototype.a=null;var oe,se={OPEN:"a",ib:"b",Na:"c",rb:"d"};function ae(){rt.call(this,"d")}function ue(){rt.call(this,"c")}function ce(){}function he(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Kt(this),this.O=le,t=K?125:void 0,this.P=new Ut(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}v(ae,rt),v(ue,rt),v(ce,ne),oe=new ce;var le=45e3,fe={},de={};function pe(t,e,n){t.F=1,t.f=Fe(Me(e)),t.l=n,t.H=!0,ye(t,null)}function me(t,e,n,r){t.F=1,t.f=Fe(Me(e)),t.l=null,t.H=n,ye(t,r)}function ye(t,e){t.v=g(),be(t),t.D=Me(t.f),Ue(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new qt(y(t.Ka,t,t.a),t.J)),Wt(t.I,t.a,"readystatechange",t.eb),e=t.h?P(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),Jt(1)}function ge(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=ve(t,n);if(i==de){4==e&&(t.c=4,Yt(14),r=!1);break}if(i==fe){t.c=4,Yt(15),r=!1;break}Ie(t,i)}4==e&&0==n.length&&(t.c=1,Yt(16),r=!1),t.b=t.b&&r,r||(Ee(t),Se(t))}function ve(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?de:(n=Number(e.substring(n,r)),isNaN(n)?fe:(r+=1)+n>e.length?de:(e=e.substr(r,n),t.A=r+n,e))}function be(t){t.R=g()+t.O,we(t,t.O)}function we(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Zt(y(t.bb,t),e)}function _e(t){t.i&&(r.clearTimeout(t.i),t.i=null)}function Se(t){t.g.Da()||t.m||t.g.na(t)}function Ee(t){_e(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Ft(t.P),Gt(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ie(t,e){try{t.g.Ga(t,e),Jt(4)}catch(t){}}function Te(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||i(t))E(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(h(t)||i(t)){n=[];for(var r=t.length,o=0;o<r;o++)n.push(o)}else for(o in n=[],r=0,t)n[r++]=o;o=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(i(t))return t.split("");if(h(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var s=0;s<o;s++)e.call(void 0,r[s],n&&n[s],t)}}function Ae(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ae)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ne(t,e){Oe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ce(t))}function Ce(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Oe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Oe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(e=he.prototype).setTimeout=function(t){this.O=t},e.eb=function(t){t=t.target;var e=this.B;e&&3==Pn(t)?e.Ua():this.Ka(t)},e.Ka=function(t){try{if(t==this.a)t:{var e=Pn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!K&&!this.a.aa())){this.m||4!=e||7==n||Jt(8==n||0>=r?3:2),_e(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=Rn(this.a,"X-HTTP-Initial-Response");if(s&&!A(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,Yt(12),Ee(this),Se(this);break t}this.s=!0,Ie(this,a)}this.H?(ge(this,e,o),K&&this.b&&3==e&&(Wt(this.I,this.P,"tick",this.cb),this.P.start())):Ie(this,o),4==e&&Ee(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,be(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Yt(12)):(this.c=0,Yt(13)),Ee(this),Se(this)}}}catch(t){}},e.cb=function(){if(this.a){var t=Pn(this.a),e=this.a.aa();this.A<e.length&&(_e(this),ge(this,t,e),this.b&&4!=t&&be(this))}},e.cancel=function(){this.m=!0,Ee(this)},e.bb=function(){this.i=null;var t=g();0<=t-this.R?(2!=this.F&&(Jt(3),Yt(17)),Ee(this),this.c=2,Se(this)):we(this,this.R-t)},(e=Ae.prototype).C=function(){Ce(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.K=function(){return Ce(this),this.a.concat()},e.get=function(t,e){return Oe(this.b,t)?this.b[t]:e},e.set=function(t,e){Oe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ke(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof ke?(this.h=void 0!==e?e:t.h,xe(this,t.f),this.j=t.j,Pe(this,t.b),Re(this,t.i),this.a=t.a,Le(this,Ze(t.c)),this.g=t.g):t&&(n=String(t).match(De))?(this.h=!!e,xe(this,n[1]||"",!0),this.j=je(n[2]||""),Pe(this,n[3]||"",!0),Re(this,n[4]),this.a=je(n[5]||"",!0),Le(this,n[6]||"",!0),this.g=je(n[7]||"")):(this.h=!!e,this.c=new Qe(null,this.h))}function Me(t){return new ke(t)}function xe(t,e,n){t.f=n?je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Pe(t,e,n){t.b=n?je(e,!0):e}function Re(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Le(t,e,n){e instanceof Qe?(t.c=e,function(t,e){e&&!t.f&&(Je(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&($e(this,e),Xe(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=qe(e,Ge)),t.c=new Qe(e,t.h))}function Be(t,e,n){t.c.set(e,n)}function Ue(t,e,n){c(n)||(n=[String(n)]),Xe(t.c,e,n)}function Fe(t){return Be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^g()).toString(36)),t}function je(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qe(t,e,n){return i(t)?(t=encodeURI(t).replace(e,Ve),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ve(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(qe(e,Ke,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(qe(e,Ke,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(qe(n,"/"==n.charAt(0)?We:ze,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",qe(n,He)),t.join("")},ke.prototype.resolve=function(t){var e=Me(this),n=!!t.f;n?xe(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Pe(e,t.b):n=null!=t.i;var r=t.a;if(n)Re(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(O(i,"./")||O(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Le(e,Ze(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Ke=/[#\/\?@]/g,ze=/[#\?:]/g,We=/[#\?]/g,Ge=/[#\?@]/g,He=/#/g;function Qe(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Je(t){t.a||(t.a=new Ae,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function $e(t,e){Je(t),e=tn(t,e),Oe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ne(t.a,e))}function Ye(t,e){return Je(t),e=tn(t,e),Oe(t.a.b,e)}function Xe(t,e,n){$e(t,e),0<n.length&&(t.c=null,t.a.set(tn(t,e),T(n)),t.b+=n.length)}function Ze(t){var e=new Qe;return e.c=t.c,t.a&&(e.a=new Ae(t.a),e.b=t.b),e}function tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function en(){this.a=g()}(e=Qe.prototype).add=function(t,e){Je(this),this.c=null,t=tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.forEach=function(t,e){Je(this),this.a.forEach(function(n,r){E(n,function(n){t.call(e,n,r,this)},this)},this)},e.K=function(){Je(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.C=function(t){Je(this);var e=[];if(i(t))Ye(this,t)&&(e=I(e,this.a.get(tn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=I(e,t[n])}return e},e.set=function(t,e){return Je(this),this.c=null,Ye(this,t=tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var nn=null;function rn(){nn||(nn=new en)}function on(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function sn(t){var e=t.a.F.a;if(null!=e)Yt(4),e?(Yt(10),Hn(t.a,t,!1)):(Yt(11),Hn(t.a,t,!0));else{t.b=new he(t,void 0,void 0),t.b.h=t.h,e=Xn(e=t.a,e.Y()?t.f:null,t.i),Yt(4),Ue(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Be(e,n,r),me(t.b,e,!1,t.f)}}function an(){this.a=this.b=null}function un(){this.a=new Ae}function cn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[f]||(t[f]=++d)):e.charAt(0)+t}function hn(t,e){this.b=t,this.a=e}function ln(t){this.g=t||fn,r.PerformanceNavigationTiming?t=0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(r.ka&&r.ka.Ea&&r.ka.Ea()&&r.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new un),this.b=null,this.c=[]}en.prototype.set=function(t){this.a=t},en.prototype.reset=function(){this.set(g())},en.prototype.get=function(){return this.a},v(rn,function(){nn||(nn=new en)}),(e=on.prototype).M=null,e.$=function(t){return this.a.$(t)},e.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},e.Da=function(){return!1},e.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Rn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Rn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void $n(e,2)}this.f=r[0]}else(e=this.a).m=this.c,$n(e,2)}else 1==this.M&&(this.g?Yt(6):"11111"==e?(Yt(5),this.g=!0,(!q||10<=Number($))&&(this.c=200,this.b.cancel(),Yt(11),Hn(this.a,this,!0))):(Yt(7),this.g=!1))},e.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,sn(this)):1==this.M&&(this.g?(Yt(11),Hn(this.a,this,!0)):(Yt(10),Hn(this.a,this,!1)));else{0==this.M?Yt(8):1==this.M&&Yt(9);var t=this.a;t.m=this.c,$n(t,2)}},e.Y=function(){return this.a.Y()},e.ma=function(){return this.a.ma()},un.prototype.add=function(t){this.a.set(cn(t),t)},un.prototype.C=function(){return this.a.C()};var fn=10;function dn(t,e){!t.a&&(O(e,"spdy")||O(e,"quic")||O(e,"h2"))&&(t.f=t.g,t.a=new un,t.b&&(gn(t,t.b),t.b=null))}function pn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function mn(t){return t.b?1:t.a?t.a.a.c:0}function yn(t,e){return t.b?t=t.b==e:t.a?(e=cn(e),t=Oe(t.a.a.b,e)):t=!1,t}function gn(t,e){t.a?t.a.add(e):t.b=e}function vn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=cn(e),n=Oe(t.a.a.b,n)),n&&Ne(t.a.a,cn(e)))}function bn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return E(t.a.C(),function(t){e=e.concat(t.j)}),e}return T(t.c)}function wn(){}function _n(){this.a=new wn}function Sn(t,e,n){var r=n||"";try{Te(t,function(t,n){var i=t;l(t)&&(i=At(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}ln.prototype.cancel=function(){var t;this.c=bn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(E(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},wn.prototype.stringify=function(t){return r.JSON.stringify(t,void 0)},wn.prototype.parse=function(t){return r.JSON.parse(t,void 0)};var En=r.JSON.parse;function In(t){It.call(this),this.headers=new Ae,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Tn,this.D=this.F=!1}v(In,It);var Tn="",An=/^https?$/i,Nn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function On(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Dn(t),Mn(t)}function Dn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function kn(t){if(t.b&&void 0!==n&&(!t.s[1]||4!=Pn(t)||2!=t.T()))if(t.l&&4==Pn(t))jt(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==Pn(t)){t.b=!1;try{var e,i=t.T();t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}if(!(e=o)){var s;if(s=0===i){var a=String(t.A).match(De)[1]||null;if(!a&&r.self&&r.self.location){var u=r.self.location.protocol;a=u.substr(0,u.length-1)}s=!An.test(a?a.toLowerCase():"")}e=s}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",Dn(t))}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?a:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(r.clearTimeout(t.m),t.m=null)}function Pn(t){return t.a?t.a.readyState:0}function Rn(t,e){return t.a?t.a.getResponseHeader(e):null}function Ln(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return x(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),i(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var o=""}else o=t.substring(r+1,n);n=(t=[t.substr(0,r),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Be(t,e,n),t}function Bn(t){this.f=[],this.F=new an,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!s("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=s("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=s("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=s("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=s("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new ln(t&&t.concurrentRequestLimit),this.ja=new _n,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Un(t){if(Fn(t),3==t.u){var e=t.P++,n=Me(t.B);Be(n,"SID",t.H),Be(n,"RID",e),Be(n,"TYPE","terminate"),Kn(t,n),(e=new he(t,e,void 0)).F=2,e.f=Fe(Me(n)),n=!1,r.navigator&&r.navigator.sendBeacon&&(n=r.navigator.sendBeacon(e.f.toString(),"")),!n&&r.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=g(),be(e)}Yn(t)}function Fn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(r.clearTimeout(t.l),t.l=null),Qn(t),t.b.cancel(),t.h&&(o(t.h)&&r.clearTimeout(t.h),t.h=null)}function jn(t,e){t.f.push(new hn(t.Ra++,e)),3==t.u&&qn(t)}function qn(t){pn(t.b)||t.h||(t.h=!0,Pt(t.Ia,t),t.A=0)}function Vn(t,e){var n;n=e?e.W:t.P++;var r=Me(t.B);Be(r,"SID",t.H),Be(r,"RID",n),Be(r,"AID",t.O),Kn(t,r),t.g&&t.i&&Ln(r,t.g,t.i),n=new he(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=zn(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),gn(t.b,n),pe(n,r,e)}function Kn(t,e){t.c&&Te({},function(t,n){Be(e,n,t)})}function zn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?y(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Sn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Wn(t){t.a||t.l||(t.S=1,Pt(t.Ha,t),t.v=0)}function Gn(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Zt(y(t.Ha,t),Jn(t,t.v)),t.v++,!0)}function Hn(t,e,n){var r=e.l;r&&dn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Xn(t,null,t.ha),qn(t)}function Qn(t){null!=t.s&&(r.clearTimeout(t.s),t.s=null)}function Jn(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function $n(t,e){Yt(2==e?1:2),t.u=0,t.c&&t.c.ta(e),Yn(t),Fn(t)}function Yn(t){t.u=0,t.m=-1,t.c&&(0==bn(t.b).length&&0==t.f.length||(t.b.c.length=0,T(t.f),t.f.length=0),t.c.sa())}function Xn(t,e,n){var i=function(t){return t instanceof ke?Me(t):new ke(t,void 0)}(n);if(""!=i.b)e&&Pe(i,e+"."+i.b),Re(i,i.i);else{var o,s=r.location;o=e?e+"."+s.hostname:s.hostname,i=function(t,e,n,r){var i=new ke(null,void 0);return t&&xe(i,t),e&&Pe(i,e),n&&Re(i,n),r&&(i.a=r),i}(s.protocol,o,+s.port,n)}return t.V&&x(t.V,function(t,e){Be(i,e,t)}),e=t.j,n=t.I,e&&n&&Be(i,e,n),Be(i,"VER",t.wa),Kn(t,i),i}function Zn(){}function tr(){if(q&&!(10<=Number($)))throw Error("Environmental error: no available transport.")}function er(t,e){It.call(this),this.a=new Bn(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new ir(this)}function nr(t){ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){ue.call(this),this.status=1}function ir(t){this.a=t}(e=In.prototype).ca=function(t,e,n,s){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?re(this.H):re(oe),this.a.onreadystatechange=y(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void On(this,t)}t=n||"";var a=new Ae(this.headers);s&&Te(s,function(t,e){a.set(e,t)}),s=function(t){t:{for(var e=Cn,n=t.length,r=i(t)?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t)){e=o;break t}e=-1}return 0>e?null:i(t)?t.charAt(e):t[e]}(a.K()),n=r.FormData&&t instanceof r.FormData,!(0<=S(Nn,e))||s||n||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=function(t){return q&&X(9)&&o(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=y(this.Ca,this)):this.m=jt(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){On(this,t)}},e.Ca=function(){void 0!==n&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},e.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),In.N.G.call(this)},e.Fa=function(){this.j||(this.w||this.l||this.g?kn(this):this.$a())},e.$a=function(){kn(this)},e.T=function(){try{return 2<Pn(this)?this.a.status:-1}catch(t){return-1}},e.za=function(){try{return 2<Pn(this)?this.a.statusText:""}catch(t){return""}},e.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},e.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),En(e)}},e.ya=function(){return this.h},e.Ya=function(){return i(this.f)?this.f:String(this.f)},(e=Bn.prototype).wa=8,e.u=1,e.Da=function(){return 0==this.u},e.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new he(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?L(r=P(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var o=e=0;o<this.f.length;o++){var s=this.f[o];if(void 0===(s="__data__"in s.a&&i(s=s.a.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=o;break t}if(4096===e||o===this.f.length-1){e=o+1;break t}}e=1e3}else e=1e3;e=zn(this,n,e),Be(o=Me(this.B),"RID",t),Be(o,"CVER",22),this.o&&this.j&&Be(o,"X-HTTP-Session-Id",this.j),Kn(this,o),this.g&&r&&Ln(o,this.g,r),gn(this.b,n),this.W?(Be(o,"$req",e),Be(o,"SID","null"),n.S=!0,pe(n,o,null)):pe(n,o,e),this.u=2}}else 3==this.u&&(t?Vn(this,t):0==this.f.length||pn(this.b)||Vn(this))},e.Ha=function(){this.l=null,this.a=new he(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Me(this.pa);Be(t,"RID","rpc"),Be(t,"SID",this.H),Be(t,"CI",this.ia?"0":"1"),Be(t,"AID",this.O),Kn(this,t),Be(t,"TYPE","xmlhttp"),this.g&&this.i&&Ln(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),me(this.a,t,!0,this.ga)},e.Ga=function(t,e){if(0!=this.u&&(this.a==t||yn(this.b,t)))if(this.m=t.o,!t.s&&yn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(c(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Qn(this),this.a.cancel(),this.a=null}Gn(this),Yt(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=Zt(y(this.Za,this),6e3));if(1>=mn(this.b)&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else $n(this,11)}else if((t.s||this.a==t)&&Qn(this),!A(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&o(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Rn(r,"X-Client-Wire-Protocol"))&&dn(this.b,i),this.j&&(r=Rn(r,"X-HTTP-Session-Id")))&&(this.I=r,Be(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Xn(this,this.Y()?this.ga:null,this.ha),r.s?(vn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(_e(r),be(r)),this.a=r):Wn(this),0<this.f.length&&qn(this)}else"stop"!=r[0]&&"close"!=r[0]||$n(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?$n(this,7):Un(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},e.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Gn(this),Yt(19))},e.na=function(t){var e=null;if(this.a==t){Qn(this),this.a=null;var n=2}else{if(!yn(this.b,t))return;e=t.j,vn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=g()-t.v,Ht.dispatchEvent(new Xt(Ht,t.l?t.l.length:0,e,this.A)),qn(this)):Wn(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(mn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.f=e.j.concat(t.f),0):1==t.u||2==t.u||t.A>=(t.Pa?0:t.Qa)||(t.h=Zt(y(t.Ia,t,e),Jn(t,t.A)),t.A++,0)))}(this,t)||2==n&&Gn(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:$n(this,5);break;case 4:$n(this,10);break;case 3:$n(this,6);break;default:$n(this,2)}}},e.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new In(this.La)).F=this.R,t},e.ma=function(){return!!this.c&&!0},e.Y=function(){return this.R},new rn,(e=Zn.prototype).va=function(){},e.ua=function(){},e.ta=function(){},e.sa=function(){},e.Ta=function(){},tr.prototype.a=function(t,e){return new er(t,e)},v(er,It),(e=er.prototype).addEventListener=function(t,e,n,r){er.N.addEventListener.call(this,t,e,n,r)},e.removeEventListener=function(t,e,n,r){er.N.removeEventListener.call(this,t,e,n,r)},e.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Yt(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new on(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Ln(e,t.g,t.i)),(t=t.w).i=n,e=Xn(t.a,null,t.i),Yt(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,sn(t)):(Ue(e,"MODE","init"),!t.a.o&&t.a.j&&Ue(e,"X-HTTP-Session-Id",t.a.j),t.b=new he(t,void 0,void 0),t.b.h=t.h,me(t.b,e,!1,null),t.M=0)},e.close=function(){Un(this.a)},e.Xa=function(t){if(i(t)){var e={};e.__data__=t,jn(this.a,e)}else this.h?((e={}).__data__=At(t),jn(this.a,e)):jn(this.a,t)},e.G=function(){this.a.c=null,delete this.f,Un(this.a),delete this.a,er.N.G.call(this)},v(nr,ae),v(rr,ue),v(ir,Zn),ir.prototype.va=function(){this.a.dispatchEvent("a")},ir.prototype.ua=function(t){this.a.dispatchEvent(new nr(t))},ir.prototype.ta=function(t){this.a.dispatchEvent(new rr(t))},ir.prototype.sa=function(){this.a.dispatchEvent("b")};var or=function(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},tr);tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.Xa,er.prototype.open=er.prototype.Wa,er.prototype.close=er.prototype.close,te.NO_ERROR=0,te.TIMEOUT=8,te.HTTP_ERROR=6,ee.COMPLETE="complete",ie.EventType=se,se.OPEN="a",se.CLOSE="b",se.ERROR="c",se.MESSAGE="d",It.prototype.listen=It.prototype.Aa,In.prototype.listenOnce=In.prototype.Ba,In.prototype.getLastError=In.prototype.Ya,In.prototype.getLastErrorCode=In.prototype.ya,In.prototype.getStatus=In.prototype.T,In.prototype.getStatusText=In.prototype.za,In.prototype.getResponseJson=In.prototype.Va,In.prototype.getResponseText=In.prototype.aa,In.prototype.send=In.prototype.ca,t.exports={createWebChannelTransport:or,ErrorCode:te,EventType:ee,WebChannel:ie,XhrIo:In}}).call(self)},function(t,e,n){"use strict";n.r(e),n.d(e,"getSodiumKeysFromSeed",function(){return o}),n.d(e,"encryptSecret",function(){return s}),n.d(e,"decryptSecret",function(){return a}),n.d(e,"encryptBox",function(){return u}),n.d(e,"decryptBox",function(){return c}),n.d(e,"genBoxKeyPair",function(){return h}),n.d(e,"encryptSealedBox",function(){return l}),n.d(e,"decryptSealedBox",function(){return f}),n.d(e,"signDetached",function(){return d}),n.d(e,"verifyDetached",function(){return p}),n.d(e,"genSignKeyPair",function(){return m}),n.d(e,"sign",function(){return y});var r=n(92);const{rpcWrap:i}=Object(r.createWorkerChannel)("src/app/workers/sodium-crypto/index.js"),o=i("getSodiumKeysFromSeed"),s=i("encryptSecret"),a=i("decryptSecret"),u=i("encryptBox"),c=i("decryptBox"),h=i("genBoxKeyPair"),l=i("encryptSealedBox"),f=i("decryptSealedBox"),d=i("signDetached"),p=i("verifyDetached"),m=i("genSignKeyPair"),y=i("sign")},function(t,e,n){const{wait:r}=n(29),i=(...t)=>console.debug("[exodus:e2e:firestore-auth]",...t),o={maxTries:1/0};t.exports.MIN_REAUTH_TIMEOUT=5e3,t.exports.MAX_REAUTH_TIMEOUT=6e5,t.exports.doAuthentication=async function(){return new Promise((t,e)=>{const n=this.firebase.auth().onAuthStateChanged(async r=>{if(i("authstatechange",r?r.uid:null),n(),r){if(r.uid===this.uid)return void t(r);await this.firebase.auth().signOut()}try{const n=await this.doAuthenticationChallenge();i("fresh authentication",n.uid),t(n)}catch(t){e(t)}})})},t.exports.fetchToken=async function(t){return this.fetch("authenticate").get(t)},t.exports.doAuthenticationChallenge=async function(){i("requesting challenge",this.uid);const t=await this.fetchToken({publicKey:this.uid});i("challenge response",t.time);const e=async t=>{return(await this.firebase.auth().signInWithCustomToken(t)).user};if(t.token)return e(t.token);if(!t.challenge)throw new Error("invalid auth response",t);const n=await this.sodium.decryptBox(Buffer.from(t.challenge,"hex"),t.serverPublicKey,this.keys.box.privateKey),r={publicKey:this.uid,challenge:Buffer.from(n).toString(),time:t.time,signature:t.signature};return i("decrypted challenge",t.time),e((await this.fetchToken(r)).token)},t.exports.getCurrentAuthToken=async function(){return this.user.getIdToken()};t.exports.authenticatedFetch=(e=>(async function(n,s,a){let u=t.exports.MIN_REAUTH_TIMEOUT,c=0;const{maxTries:h}=a||o;for(;;)try{return await e.call(this,n,s)}catch(e){const{status:n}=e.response||{};if(400===n||++c>=h)throw e;i(`failed, reauthenticating soon. Status: ${n}, Error: ${e.message}`),u=Math.min(2*u,t.exports.MIN_REAUTH_TIMEOUT),await r(u),await this.reauthenticate()}}))(async function(t,e){const n={headers:{Authorization:`Bearer ${await this.getCurrentAuthToken()}`}},{method:r="get"}=e,i="get"===r?e.query:e.body;try{return await this.fetch(t,n)[r](i)}catch(t){try{t.message=await t.response.text()}catch(t){}throw t}}),t.exports.authenticatedPost=async function(t,e,n){return this.authenticatedFetch(t,{method:"post",body:e},n)},t.exports.authenticatedPut=async function(t,e,n){return this.authenticatedFetch(t,{method:"put",body:e},n)}},function(t,e,n){const r=n(49);t.exports=(({sodium:t,randomBytes:e,createHash:n,hash:i,firebaseApiUrl:o})=>{let s,a;const u=async()=>(s||(s=await t.genBoxKeyPair(e(32))),s),c=new r({sodium:t,endpoint:o,createHash:n,hash:i}),h=()=>c.cancelPolling();return{cancelPendingPairing:h,requestPairingConfirmation:async({confirmationPhrase:t,senderPublicKey:e,metadata:n})=>{h(),s=null;const r=await u();if(!0!==(await c.recipientMakeDeviceRequest({confirmationPhrase:t,senderPublicKey:e,recipientPublicKey:r.publicKey,recipientPrivateKey:r.privateKey,metadata:n})).ok)throw new Error("device request failed")},loadPairingData:async t=>{const e=Buffer.from(t,"base64");return c.recipientDecodePhrase(e)},getDecryptedPhrase:async({encryptedPhrase:t,senderPublicKey:e,maxTries:n=60})=>{const r=await u(),i=await c.recipientGetEncryptedSecret({senderPublicKey:e,maxTries:n});return c.recipientDecryptPhrase({recipientPrivateKey:r.privateKey,encryptedPhrase:t,encryptedSecretKey:i,senderPublicKey:e})},reportPairingCancelled:async({senderPublicKey:t,unencryptedMetadata:n})=>(a||(a=e(32)),t||(t=a),c.recipientMakeCancelRequest({senderPublicKey:t,unencryptedMetadata:n})),getTmpKeys:u,recipientEncryptWalletMetadata:c.recipientEncryptWalletMetadata.bind(c),recipientUploadWalletMetadata:c.recipientUploadWalletMetadata.bind(c)}})},function(t,e,n){const r=n(49),i=(...t)=>console.debug("[exodus:e2e:pair-as-sender]",...t);t.exports=(({sodium:t,randomBytes:e,createHash:n,hash:o,firebaseApiUrl:s})=>{let a,u,c;const h=new r({sodium:t,endpoint:s,createHash:n,hash:o}),l=()=>h.cancelPolling();return{createPairingData:async n=>{await(async()=>{a=await t.genBoxKeyPair(e(32)),u=e(32),c=void 0})();const r=await h.senderEncryptAndEncodePhrase({phrase:n,secretKey:u,senderPublicKey:a.publicKey});return i("encrypted phrase",r),r.toString("base64")},getDeviceRequest:(t={})=>(i("getDeviceRequest start"),l(),h.senderGetDeviceRequest({senderPublicKey:a.publicKey,senderPrivateKey:a.privateKey,maxTries:60,...t})),uploadSecret:async({recipientPublicKey:t,unencryptedMetadata:e,metadata:n})=>{c=await h.senderEncryptSecret({secretKey:u,recipientPublicKey:t,senderPrivateKey:a.privateKey,metadata:n}),i("encrypted secret",c);const r=await h.senderUploadSecretKey({encryptedSecretKey:c,senderPublicKey:a.publicKey,unencryptedMetadata:e});return i("uploaded",r),r},cancelPendingPairing:l,getTmpKeys:()=>Promise.resolve(a),senderGetWalletMetadata:h.senderGetWalletMetadata.bind(h),senderDecryptWalletMetadata:h.senderDecryptWalletMetadata.bind(h)}})},function(t){t.exports={name:"@exodus/firestore-sync",version:"6.4.0",description:"exodus firestore-sync client used in Electron and React Native"}},function(t,e){t.exports={CanceledError:class extends Error{constructor(t){super(t),this.type="canceled"}}}},function(t,e,n){const{wait:r}=n(29),{CanceledError:i}=n(120),o=(t,e,n)=>{let o,s=!0;const a=new Promise((t,e)=>{o=(()=>{s&&(s=!1,e(new i("canceled")))})}),u=(async()=>{let i=0;for(;s;){if(++i>e)throw new Error("max retries exceeded");try{const e=await Promise.race([t(),a]);return s=!1,e}catch(t){await Promise.race([r(n),a])}}})();return u.cancel=(()=>o()),u};t.exports={poll:o,pollingFetch:function(t,e=60,n=1e3){return o(async()=>{const e=await this.fetch(t).get();if(e.error)throw new Error(e.error);return e},e,n)}}},function(t,e){t.exports={encode:t=>{const e=[];return t.forEach(t=>{if(!Buffer.isBuffer(t))throw new Error("expected an array of Buffers");const n=Buffer.alloc(4);n.writeUInt32BE(t.length,0),e.push(n),e.push(t)}),Buffer.concat(e)},decode:t=>{if(!Buffer.isBuffer(t))throw new Error("expected a Buffer");const e=[],{length:n}=t;let r=0;for(;r<n;){const n=t.readUInt32BE(r),i=r+=4,o=i+n,s=t.slice(i,o);e.push(s),r+=s.length}return e}}},function(t,e,n){const r=n(122),i={PairingData:0},o=t=>{if(!Buffer.isBuffer(t))throw new Error("expected Buffer");const e=((t,e)=>Object.keys(t).find(n=>t[n]===e))(i,t[0]);if(!e)throw new Error("invalid data");return{type:e,data:r.decode(t.slice(1))}},s=({type:t,data:e})=>{if(!Object.hasOwnProperty.call(i,t))throw new Error("unknown data type");return Buffer.concat([Buffer.from([i[t]]),r.encode(e)])};t.exports={decode:o,encode:s,decodePairingData:t=>{const{data:e}=o(t),[n,r]=e;return{ciphertext:n,pub:r}},encodePairingData:({ciphertext:t,pub:e})=>s({type:"PairingData",data:[t,e]})}},function(t,e){t.exports=(t=>{let e;const n=()=>{e=null};return(...r)=>e||((e=t(...r)).then(n,n),e)})},function(t,e,n){const r=()=>{},{wait:i}=n(29);t.exports=(async({firestoreSync:t,channelConf:e,getLatest:n,setLatest:o,getMigration:s=r,setMigration:a=r,retryDelay:u=1e4})=>{const{channelName:c,syncStateKey:h,replayLast:l,startFromLatest:f,onSynced:d,migration:p,processOne:m,processBatch:y,batchSize:g,unencrypted:v}=e,b=`migrations:fusion:${c}:${p}`;let w,_,S;if(l)w={getSince:t=>Math.max(t.latest-1,0)};else if(f){const t=await n(h);w={getSince:e=>t<e.latest?e.latest-1:e.latest}}else w={since:((_=p&&!await s(b))?0:await n(h))||0};for(;;)try{S=await t.channel(c,{...w,unencrypted:v});break}catch(t){console.warn(`failed to initialize channel ${c}, will retry`,t.stack),await i(u)}S._debug(`${c} sync monitor subscribed, offset: ${S.since}, latest: ${S.latest}`);const E=()=>{(t=>t.latest===t.since)(S)&&(d&&d(),_&&(async()=>{_=!1,await a(b,!0),e.onMigrated&&e.onMigrated()})())};return S.onData(async(t,e)=>{if(y){try{await y(t,e)}catch(e){console.warn(`processBatch_${c}`,e,t)}await o(h,e)}else{let n=e-t.length+1;for(const e of t){try{await m(e,n)}catch(t){console.warn(`processOne${c}`,t,e)}await o(h,n),n++}}E()}),S.subscribe({pageSize:g}),E(),S})},function(t,e,n){"use strict";t.exports=function(t,e){const n=Object.assign({concurrency:1},e).concurrency;if("number"!=typeof n||isNaN(n)||n<=0)throw new TypeError(`Invalid concurrency value: ${n}`);let r=0;const i=[];function o(){i.length>0?i.shift().resolve():r-=1}return function(){let e;return r>=n?e=new Promise(t=>i.push({resolve:t})):(e=Promise.resolve(),r+=1),e.then(()=>t.apply(this,arguments)).then(t=>(o(),t),t=>{throw o(),t})}}},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(o(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,u=0;u<s;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(t,e){var s;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,o,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";n.r(e),n.d(e,"targeted",function(){return u}),n.d(e,"rpcRenderer",function(){return y}),n.d(e,"rpcListener",function(){return g}),n.d(e,"createServer",function(){return v}),n.d(e,"createClient",function(){return b}),n.d(e,"createClientMethod",function(){return w});var r=n(45),i=n(57),o=n(103),s=n(101);const a=Object(s.wrapIpc)(r.ipcRenderer,function(t){return 0===t.senderId||void 0===t.senderId||(console.error("Blocked direct IPC communication from a non-browser process"),!1)});function u(t,e,n){"#"===t?r.ipcRenderer.send(e,{channel:e,payload:n}):r.ipcRenderer.send("ipc:target:send",{target:t,channel:e,payload:n})}const{on:c,once:h,removeListener:l,removeAllListeners:f,send:d,sendSync:p,invoke:m}=a,y={on:c,once:h,removeListener:l,removeAllListeners:f,send:d,sendSync:p,invoke:m},g=y;function v(...t){return Object(o.createServerImplementation)(a,u,(t,e)=>e.origin,...t)}function b(...t){return Object(i.createClientImplementation)(a,u,...t)}function w(...t){return Object(i.createClientMethodImplementation)(a,u,...t)}},function(t,e,n){"use strict";var r=n(3);new(n(40).default)({sendMessage:t=>Object(r.targeted)("ui","network-ui-handshake",t),attachListener:t=>r.rpcListener.on("network-ui-handshake",(e,{payload:n})=>t(n))})},function(t,e,n){"use strict";n.r(e);n(130);var r=n(33),i=n.n(r),o=n(98),s=n(90);i.a.fetch=fetch.bind(window),Object(o.default)(),Object(s.default)()},function(t,e,n){if(globalThis.Buffer){const Buffer=globalThis.Buffer;if(Buffer.poolSize=0,Buffer.allocUnsafe=function(t){return Buffer.alloc(t)},Buffer.allocUnsafeSlow=Buffer.allocUnsafe,Buffer.TYPED_ARRAY_SUPPORT){const{isBuffer:t}=Buffer;Buffer.isBuffer=(e=>e instanceof Uint8Array&&t(e))}Object.freeze(Buffer)}const r=Object.getPrototypeOf(Int8Array);for(const t of[...[Object,Array,Number,String,Function,Set,Map,WeakSet,WeakMap],...[Reflect,TypeError,BigInt,URL,Date,JSON,Math],...[Int8Array,Int16Array,Int32Array,DataView],...[Uint8Array,Uint16Array,Uint32Array,r]])Object.freeze(t);crypto&&crypto.subtle&&(Object.freeze(crypto),Object.freeze(crypto.subtle))},function(t,e){const n=(...t)=>{const e=t.reduce((t,e)=>t.concat((t=>t instanceof Error&&t.stack)(e)?e.stack:e,"\n"),"").trim();console._errorOriginal(e)};console._errorOriginal||(console._errorOriginal=console.error.bind(console),console.error=n)},function(t,e,n){n(133),n(132)},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?i-1:0,f=n?-1:1,d=t[e+l];for(l+=f,o=d&(1<<-h)-1,d>>=-h,h+=a;h>0;o=256*o+t[e+l],l+=f,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+l],l+=f,h-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*m}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),s=r[0],a=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),h=0,l=a>0?s-4:s;for(n=0;n<l;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e;2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[h++]=255&e);1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(h(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o=Uint8Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e,n){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const r=n(136),i=n(135),o=Symbol.for("nodejs.util.inspect.custom");e.Buffer=Buffer,e.SlowBuffer=function(t){+t!=t&&(t=0);return Buffer.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,Buffer.prototype),e}function Buffer(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!Buffer.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|p(t,e);let r=a(n);const i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(H(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(H(t,ArrayBuffer)||t&&H(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(H(t,SharedArrayBuffer)||t&&H(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return Buffer.from(r,e,n);const i=function(t){if(Buffer.isBuffer(t)){const e=0|d(t.length),n=a(e);return 0===n.length?n:(t.copy(n,0,0,e),n)}if(void 0!==t.length)return"number"!=typeof t.length||Q(t.length)?a(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if(null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return Buffer.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return c(t),a(t<0?0:0|d(t))}function l(t){const e=t.length<0?0:0|d(t.length),n=a(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,Buffer.prototype),r}function d(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function p(t,e){if(Buffer.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||H(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(i)return r?-1:z(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Q(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=Buffer.from(e,r)),Buffer.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){let o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let r=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===u)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){let n=!0;for(let r=0;r<u;r++)if(c(t,o+r)!==c(e,r)){n=!1;break}if(n)return o}return-1}function v(t,e,n,r){n=Number(n)||0;const i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=e.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(Q(r))return s;t[n+s]=r}return s}function b(t,e,n,r){return G(z(e,t.length-n),t,n,r)}function w(t,e,n,r){return G(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function _(t,e,n,r){return G(W(e),t,n,r)}function S(t,e,n,r){return G(function(t,e){let n,r,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function I(t,e,n){n=Math.min(t.length,n);const r=[];let i=e;for(;i<n;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=n){let n,r,a,u;switch(s){case 1:e<128&&(o=e);break;case 2:128==(192&(n=t[i+1]))&&(u=(31&e)<<6|63&n)>127&&(o=u);break;case 3:n=t[i+1],r=t[i+2],128==(192&n)&&128==(192&r)&&(u=(15&e)<<12|(63&n)<<6|63&r)>2047&&(u<55296||u>57343)&&(o=u);break;case 4:n=t[i+1],r=t[i+2],a=t[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(u=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a)>65535&&u<1114112&&(o=u)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(t){const e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}e.kMaxLength=s,Buffer.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},Buffer.allocUnsafe=function(t){return h(t)},Buffer.allocUnsafeSlow=function(t){return h(t)},Buffer.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==Buffer.prototype},Buffer.compare=function(t,e){if(H(t,Uint8Array)&&(t=Buffer.from(t,t.offset,t.byteLength)),H(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=Buffer.allocUnsafe(e);let i=0;for(n=0;n<t.length;++n){let e=t[n];if(H(e,Uint8Array))i+e.length>r.length?(Buffer.isBuffer(e)||(e=Buffer.from(e)),e.copy(r,i)):Uint8Array.prototype.set.call(r,e,i);else{if(!Buffer.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,i)}i+=e.length}return r},Buffer.byteLength=p,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)m(this,e,e+1);return this},Buffer.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},Buffer.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):function(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,n);case"utf8":case"utf-8":return I(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(Buffer.prototype[o]=Buffer.prototype.inspect),Buffer.prototype.compare=function(t,e,n,r,i){if(H(t,Uint8Array)&&(t=Buffer.from(t,t.offset,t.byteLength)),!Buffer.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n);for(let t=0;t<a;++t)if(u[t]!==c[t]){o=u[t],s=c[t];break}return o<s?-1:s<o?1:0},Buffer.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},Buffer.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},Buffer.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},Buffer.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":case"latin1":case"binary":return w(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function A(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function C(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=e;r<n;++r)i+=J[t[r]];return i}function O(t,e,n){const r=t.slice(e,n);let i="";for(let t=0;t<r.length-1;t+=2)i+=String.fromCharCode(r[t]+256*r[t+1]);return i}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,n,r,i,o){if(!Buffer.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r,i){j(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function x(t,e,n,r,i){j(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n+7]=o,o>>=8,t[n+6]=o,o>>=8,t[n+5]=o,o>>=8,t[n+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function P(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return e=+e,n>>>=0,o||P(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return e=+e,n>>>=0,o||P(t,0,n,8),i.write(t,e,n,r,52,8),n+8}Buffer.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,Buffer.prototype),r},Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return r},Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t+--e],i=1;for(;e>0&&(i*=256);)r+=this[t+--e]*i;return r},Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readBigUInt64LE=$(function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||V(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))}),Buffer.prototype.readBigUInt64BE=$(function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||V(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),Buffer.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},Buffer.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=e,i=1,o=this[t+--r];for(;r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},Buffer.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},Buffer.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readBigInt64LE=$(function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||V(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)}),Buffer.prototype.readBigInt64BE=$(function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||V(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)}),Buffer.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),i.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),i.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),i.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),i.read(this,t,!1,52,8)},Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){k(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){k(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,1,255,0),this[e]=255&t,e+1},Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Buffer.prototype.writeBigUInt64LE=$(function(t,e=0){return M(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeBigUInt64BE=$(function(t,e=0){return x(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),Buffer.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);k(this,t,e,n,r-1,-r)}let i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},Buffer.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);k(this,t,e,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},Buffer.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},Buffer.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},Buffer.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},Buffer.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Buffer.prototype.writeBigInt64LE=$(function(t,e=0){return M(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeBigInt64BE=$(function(t,e=0){return x(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Buffer.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},Buffer.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},Buffer.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},Buffer.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},Buffer.prototype.copy=function(t,e,n,r){if(!Buffer.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},Buffer.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Buffer.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{const o=Buffer.isBuffer(t)?t:Buffer.from(t,r),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=o[i%s]}return this};const B={};function U(t,e,n){B[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function F(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function j(t,e,n,r,i,o){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** `+`${8*(o+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new B.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,n){q(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||V(e,t.length-(n+1))}(r,i,o)}function q(t,e){if("number"!=typeof t)throw new B.ERR_INVALID_ARG_TYPE(e,"number",t)}function V(t,e,n){if(Math.floor(t)!==t)throw q(t,n),new B.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new B.ERR_BUFFER_OUT_OF_BOUNDS;throw new B.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}U("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),U("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError),U("ERR_OUT_OF_RANGE",function(t,e,n){let r=`The value of "${t}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=F(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),r+=` It must be ${e}. Received ${i}`},RangeError);const K=/[^+/0-9A-Za-z-_]/g;function z(t,e){let n;e=e||1/0;const r=t.length;let i=null;const o=[];for(let s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function W(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,r){let i;for(i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function H(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Q(t){return t!=t}const J=function(){const t=new Array(256);for(let e=0;e<16;++e){const n=16*e;for(let r=0;r<16;++r)t[n+r]="0123456789abcdef"[e]+"0123456789abcdef"[r]}return t}();function $(t){return t}},function(t,e,n){globalThis.Buffer=n(137).Buffer,n(134),n(131)}]);